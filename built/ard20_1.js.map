{"version":3,"file":"ard20_1.js","sources":["dice/d20-roll.js","dice/damage-roll.js","dice/dice.js","documents/item.js","helpers/Character Advancement/ChangeButton.svelte","helpers/Character Advancement/TDvariants.svelte","helpers/Character Advancement/Attributes.svelte","helpers/Character Advancement/Skills.svelte","helpers/Character Advancement/Tabs.svelte","helpers/Character Advancement/cha-adv-shell.svelte","helpers/effects.js","helpers/Character Advancement/cha-adv.js","sheets/actor-sheet.js","helpers/feat_req.js","sheets/item-sheet.js","helpers/templates.js","helpers/config.js","helpers/socket.js","settings/advancement-rate/advancement-rate-shell.svelte","settings/advancement-rate/advancement-rate.js","settings/FeatSetting/featSetting-shell.svelte","settings/FeatSetting/featSetting.js","settings/ProfSetting/profSetting-shell.svelte","settings/ProfSetting/profSetting.js","helpers/settings.js","helpers/chat.js","ard20.js","documents/actor.js","../svelte/init.js"],"sourcesContent":["/**\r\n * A type of Roll specific to a d20-based check, save, or attack roll in the 5e system.\r\n * @param {string} formula                       The string formula to parse\r\n * @param {object} data                          The data object against which to parse attributes within the formula\r\n * @param {object} [options={}]                  Extra optional arguments which describe or modify the D20Roll\r\n * @param {number} [options.advantageMode]             What advantage modifier to apply to the roll (none, advantage, disadvantage)\r\n * @param {number} [options.critical]                  The value of d20 result which represents a critical success\r\n * @param {number} [options.fumble]                    The value of d20 result which represents a critical failure\r\n * @param {(number)} [options.targetValue]             Assign a target value against which the result of this roll should be compared\r\n * @param {boolean} [options.elvenAccuracy=false]      Allow Elven Accuracy to modify this roll?\r\n * @param {boolean} [options.halflingLucky=false]      Allow Halfling Luck to modify this roll?\r\n * @param {boolean} [options.reliableTalent=false]     Allow Reliable Talent to modify this roll?\r\n */\r\nexport default class D20Roll extends Roll {\r\n    constructor(formula, data, options = {}) {\r\n        super(formula, data, options);\r\n        if (!(this.terms[0] instanceof Die && this.terms[0].faces === 20)) {\r\n            throw new Error(`Invalid D20Roll formula provided ${this._formula}`);\r\n        }\r\n        this.configureModifiers();\r\n    }\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * A convenience reference for whether this D20Roll has advantage\r\n     * @type {boolean}\r\n     */\r\n    get hasAdvantage() {\r\n        //@ts-expect-error\r\n        return this.options.advantageMode === D20Roll.ADV_MODE.ADVANTAGE;\r\n    }\r\n    /**\r\n     * A convenience reference for whether this D20Roll has disadvantage\r\n     * @type {boolean}\r\n     */\r\n    get hasDisadvantage() {\r\n        //@ts-expect-error\r\n        return this.options.advantageMode === D20Roll.ADV_MODE.DISADVANTAGE;\r\n    }\r\n    /* -------------------------------------------- */\r\n    /*  D20 Roll Methods                            */\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Apply optional modifiers which customize the behavior of the d20term\r\n     * @private\r\n     */\r\n    configureModifiers() {\r\n        const d20 = this.terms[0];\r\n        //@ts-expect-error\r\n        d20.modifiers = [];\r\n        // Handle Advantage or Disadvantage\r\n        if (this.hasAdvantage) {\r\n            //@ts-expect-error\r\n            d20.number = 2;\r\n            //@ts-expect-error\r\n            d20.modifiers.push(\"kh\");\r\n            //@ts-expect-error\r\n            d20.options.advantage = true;\r\n        }\r\n        else if (this.hasDisadvantage) {\r\n            //@ts-expect-error\r\n            d20.number = 2;\r\n            //@ts-expect-error\r\n            d20.modifiers.push(\"kl\");\r\n            //@ts-expect-error\r\n            d20.options.disadvantage = true;\r\n            //@ts-expect-error\r\n        }\r\n        else\r\n            d20.number = 1;\r\n        // Assign critical and fumble thresholds\r\n        //@ts-expect-error\r\n        if (this.options.critical)\r\n            d20.options.critical = this.options.critical;\r\n        //@ts-expect-error\r\n        if (this.options.fumble)\r\n            d20.options.fumble = this.options.fumble;\r\n        //@ts-expect-error\r\n        if (this.options.targetValue)\r\n            d20.options.target = this.options.targetValue;\r\n        // Re-compile the underlying formula\r\n        //@ts-expect-error\r\n        this._formula = this.constructor.getFormula(this.terms);\r\n    }\r\n    /* -------------------------------------------- */\r\n    /** @inheritdoc */\r\n    async toMessage(messageData = {}, options = {}) {\r\n        // Evaluate the roll now so we have the results available to determine whether reliable talent came into play\r\n        if (!this._evaluated)\r\n            await this.evaluate({ async: true });\r\n        // Add appropriate advantage mode message flavor and ard20 roll flags\r\n        //@ts-expect-error\r\n        messageData.flavor = messageData.flavor || this.options.flavor;\r\n        //@ts-expect-error\r\n        if (this.hasAdvantage)\r\n            messageData.flavor += ` (${game.i18n.localize(\"ARd20.Advantage\")})`;\r\n        //@ts-expect-error\r\n        else if (this.hasDisadvantage)\r\n            messageData.flavor += ` (${game.i18n.localize(\"ARd20.Disadvantage\")})`;\r\n        // Record the preferred rollMode\r\n        //@ts-expect-error\r\n        options.rollMode = options.rollMode ?? this.options.rollMode;\r\n        return super.toMessage(messageData, options);\r\n    }\r\n    /* -------------------------------------------- */\r\n    /*  Configuration Dialog                        */\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Create a Dialog prompt used to configure evaluation of an existing D20Roll instance.\r\n     * @param {object} data                     Dialog configuration data\r\n     * @param {string} [data.title]               The title of the shown dialog window\r\n     * @param {number} [data.defaultRollMode]     The roll mode that the roll mode select element should default to\r\n     * @param {number} [data.defaultAction]       The button marked as default\r\n     * @param {boolean} [data.chooseModifier]     Choose which ability modifier should be applied to the roll?\r\n     * @param {string} [data.defaultAbility]      For tool rolls, the default ability modifier applied to the roll\r\n     * @param {string} [data.template]            A custom path to an HTML template to use instead of the default\r\n     * @param {object} options                  Additional Dialog customization options\r\n     * @returns {Promise<D20Roll|null>}         A resulting D20Roll object constructed with the dialog, or null if the dialog was closed\r\n     */\r\n    //@ts-expect-error\r\n    async configureDialog({ title: string, defaultRollMode: number, canMult: boolean, defaultAction = D20Roll.ADV_MODE.NORMAL, mRoll, chooseModifier = false, defaultAttribute, template } = {}, options = {}) {\r\n        // Render the Dialog inner HTML\r\n        //@ts-expect-error\r\n        const content = await renderTemplate(template ?? this.constructor.EVALUATION_TEMPLATE, {\r\n            formula: `${this.formula} + @bonus`,\r\n            //@ts-expect-error\r\n            defaultRollMode,\r\n            rollModes: CONFIG.Dice.rollModes,\r\n            chooseModifier,\r\n            defaultAttribute,\r\n            attributes: CONFIG.ARd20.Attributes,\r\n            //@ts-expect-error\r\n            canMult,\r\n            mRoll,\r\n        });\r\n        let defaultButton = \"normal\";\r\n        switch (defaultAction) {\r\n            case D20Roll.ADV_MODE.ADVANTAGE:\r\n                defaultButton = \"advantage\";\r\n                break;\r\n            case D20Roll.ADV_MODE.DISADVANTAGE:\r\n                defaultButton = \"disadvantage\";\r\n                break;\r\n        }\r\n        // Create the Dialog window and await submission of the form\r\n        return new Promise((resolve) => {\r\n            new Dialog({\r\n                //@ts-expect-error\r\n                title,\r\n                content,\r\n                buttons: {\r\n                    advantage: {\r\n                        label: game.i18n.localize(\"ARd20.Advantage\"),\r\n                        callback: (html) => resolve(this._onDialogSubmit(html, D20Roll.ADV_MODE.ADVANTAGE)),\r\n                    },\r\n                    normal: {\r\n                        label: game.i18n.localize(\"ARd20.Normal\"),\r\n                        callback: (html) => resolve(this._onDialogSubmit(html, D20Roll.ADV_MODE.NORMAL)),\r\n                    },\r\n                    disadvantage: {\r\n                        label: game.i18n.localize(\"ARd20.Disadvantage\"),\r\n                        callback: (html) => resolve(this._onDialogSubmit(html, D20Roll.ADV_MODE.DISADVANTAGE)),\r\n                    },\r\n                },\r\n                default: defaultButton,\r\n                close: () => resolve(null),\r\n            }, options).render(true);\r\n        });\r\n    }\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Handle submission of the Roll evaluation configuration Dialog\r\n     * @param {jQuery} html             The submitted dialog content\r\n     * @param {number} advantageMode    The chosen advantage mode\r\n     * @private\r\n     */\r\n    //@ts-expect-error\r\n    _onDialogSubmit(html, advantageMode) {\r\n        const form = html[0].querySelector(\"form\");\r\n        console.log(this);\r\n        console.log(form, \"ФОРМА\");\r\n        if (form.bonus.value) {\r\n            const bonus = new Roll(form.bonus.value, this.data);\r\n            if (!(bonus.terms[0] instanceof OperatorTerm))\r\n                this.terms.push(new OperatorTerm({ operator: \"+\" }));\r\n            this.terms = this.terms.concat(bonus.terms);\r\n        }\r\n        // Customize the modifier\r\n        if (form.ability?.value) {\r\n            //@ts-expect-error\r\n            const abl = this.data.attributes[form.ability.value];\r\n            console.log(abl);\r\n            //@ts-expect-error\r\n            this.terms.findSplice((t) => t.term === \"@mod\", new NumericTerm({ number: abl.mod }));\r\n            //@ts-expect-error\r\n            this.options.flavor += ` (${game.i18n.localize(CONFIG.ARd20.Attributes[form.ability.value])})`;\r\n        }\r\n        /* if (form.prof_type?.value) {\r\n           const pr = this.data[form.prof_type.value][form.prof_value.value];\r\n           console.log(pr);\r\n           this.terms.findSplice((t) => t.term === \"@prof_die\", new Die({ number: 1, faces: pr.prof_die }));\r\n           this.terms.findSplice((t) => t.term === \"@prof_bonus\", new NumericTerm({ number: pr.prof_bonus }));\r\n         }*/\r\n        // Apply advantage or disadvantage\r\n        //@ts-expect-error\r\n        this.options.advantageMode = advantageMode;\r\n        //@ts-expect-error\r\n        this.options.rollMode = form.rollMode.value;\r\n        //@ts-expect-error\r\n        this.options.mRoll = form.mRoll?.checked;\r\n        this.configureModifiers();\r\n        return this;\r\n    }\r\n}\r\n/* -------------------------------------------- */\r\n/**\r\n * Advantage mode of a 5e d20 roll\r\n * @enum {number}\r\n */\r\nD20Roll.ADV_MODE = {\r\n    NORMAL: 0,\r\n    ADVANTAGE: 1,\r\n    DISADVANTAGE: -1,\r\n};\r\n/**\r\n * The HTML template path used to configure evaluation of this Roll\r\n * @type {string}\r\n */\r\nD20Roll.EVALUATION_TEMPLATE = \"systems/ard20/templates/chat/roll-dialog.html\";\r\n","/**\r\n * A type of Roll specific to a damage (or healing) roll in the 5e system.\r\n * @param {string} formula                       The string formula to parse\r\n * @param {object} data                          The data object against which to parse attributes within the formula\r\n * @param {object} [options={}]                  Extra optional arguments which describe or modify the DamageRoll\r\n * @param {number} [options.criticalBonusDice=0]      A number of bonus damage dice that are added for critical hits\r\n * @param {number} [options.criticalMultiplier=2]     A critical hit multiplier which is applied to critical hits\r\n * @param {boolean} [options.multiplyNumeric=false]   Multiply numeric terms by the critical multiplier\r\n * @param {boolean} [options.powerfulCritical=false]  Apply the \"powerful criticals\" house rule to critical hits\r\n *\r\n */\r\n//@ts-expect-error\r\nexport default class DamageRoll extends Roll {\r\n    //@ts-expect-error\r\n    constructor(formula, data, options) {\r\n        super(formula, data, options);\r\n        // For backwards compatibility, skip rolls which do not have the \"critical\" option defined\r\n        //@ts-expect-error\r\n        if (this.options.critical !== undefined)\r\n            this.configureDamage();\r\n    }\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * A convenience reference for whether this DamageRoll is a critical hit\r\n     * @type {boolean}\r\n     */\r\n    get isCritical() {\r\n        //@ts-expect-error\r\n        return this.options.critical;\r\n    }\r\n    /* -------------------------------------------- */\r\n    /*  Damage Roll Methods                         */\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Apply optional modifiers which customize the behavior of the d20term\r\n     * @private\r\n     */\r\n    configureDamage() {\r\n        let critBonus = 0;\r\n        for (let [i, term] of this.terms.entries()) {\r\n            if (!(term instanceof OperatorTerm)) {\r\n                //@ts-expect-error\r\n                term.options.damageType = i !== 0 && this.terms[i - 1] instanceof OperatorTerm ? this.options.damageType[i - 1] : this.options.damageType[i];\r\n            }\r\n            // Multiply dice terms\r\n            if (term instanceof DiceTerm) {\r\n                //@ts-expect-error\r\n                term.options.baseNumber = term.options.baseNumber ?? term.number; // Reset back\r\n                //@ts-expect-error\r\n                term.number = term.options.baseNumber;\r\n                if (this.isCritical) {\r\n                    critBonus += term.number * term.faces;\r\n                    let [oper, num] = [new OperatorTerm({ operator: \"+\" }), new NumericTerm({ number: critBonus, options: { flavor: \"Crit\" } })];\r\n                    this.terms.splice(1, 0, oper);\r\n                    this.terms.splice(2, 0, num);\r\n                    //@ts-expect-error\r\n                    let cb = this.options.criticalBonusDice && i === 0 ? this.options.criticalBonusDice : 0;\r\n                    term.alter(1, cb);\r\n                    //@ts-expect-error\r\n                    term.options.critical = true;\r\n                }\r\n            }\r\n            // Multiply numeric terms\r\n            //@ts-expect-error\r\n            else if (this.options.multiplyNumeric && term instanceof NumericTerm) {\r\n                //@ts-expect-error\r\n                term.options.baseNumber = term.options.baseNumber ?? term.number; // Reset back\r\n                //@ts-expect-error\r\n                term.number = term.options.baseNumber;\r\n                if (this.isCritical) {\r\n                    //@ts-expect-error\r\n                    term.number *= this.options.criticalMultiplier ?? 2;\r\n                    //@ts-expect-error\r\n                    term.options.critical = true;\r\n                }\r\n            }\r\n        }\r\n        //@ts-expect-error\r\n        this._formula = this.constructor.getFormula(this.terms);\r\n    }\r\n    /* -------------------------------------------- */\r\n    /** @inheritdoc */\r\n    toMessage(messageData = {}, options = {}) {\r\n        //@ts-expect-error\r\n        messageData.flavor = messageData.flavor || this.options.flavor;\r\n        if (this.isCritical) {\r\n            const label = game.i18n.localize(\"ARd20.CriticalHit\");\r\n            //@ts-expect-error\r\n            messageData.flavor = messageData.flavor ? `${messageData.flavor} (${label})` : label;\r\n        }\r\n        //@ts-expect-error\r\n        options.rollMode = options.rollMode ?? this.options.rollMode;\r\n        return super.toMessage(messageData, options);\r\n    }\r\n    /* -------------------------------------------- */\r\n    /*  Configuration Dialog                        */\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Create a Dialog prompt used to configure evaluation of an existing D20Roll instance.\r\n     * @param {object} data                     Dialog configuration data\r\n     * @param {string} [data.title]               The title of the shown dialog window\r\n     * @param {number} [data.defaultRollMode]     The roll mode that the roll mode select element should default to\r\n     * @param {string} [data.defaultCritical]     Should critical be selected as default\r\n     * @param {string} [data.template]            A custom path to an HTML template to use instead of the default\r\n     * @param {boolean} [data.allowCritical=true] Allow critical hit to be chosen as a possible damage mode\r\n     * @param {object} options                  Additional Dialog customization options\r\n     * @returns {Promise<D20Roll|null>}         A resulting D20Roll object constructed with the dialog, or null if the dialog was closed\r\n     */\r\n    //@ts-expect-error\r\n    async configureDialog({ title, defaultRollMode, canMult, damType, mRoll, defaultCritical = false, template, allowCritical = true } = {}, options = {}) {\r\n        // Render the Dialog inner HTML\r\n        //@ts-expect-error\r\n        const content = await renderTemplate(template ?? this.constructor.EVALUATION_TEMPLATE, {\r\n            formula: `${this.formula} + @bonus`,\r\n            defaultRollMode,\r\n            rollModes: CONFIG.Dice.rollModes,\r\n            canMult,\r\n            damType,\r\n            mRoll\r\n        });\r\n        // Create the Dialog window and await submission of the form\r\n        return new Promise((resolve) => {\r\n            new Dialog({\r\n                title,\r\n                content,\r\n                buttons: {\r\n                    critical: {\r\n                        //@ts-expect-error\r\n                        condition: allowCritical,\r\n                        label: game.i18n.localize(\"ARd20.CriticalHit\"),\r\n                        callback: (html) => resolve(this._onDialogSubmit(html, true)),\r\n                    },\r\n                    normal: {\r\n                        label: game.i18n.localize(allowCritical ? \"ARd20.Normal\" : \"ARd20.Roll\"),\r\n                        callback: (html) => resolve(this._onDialogSubmit(html, false)),\r\n                    },\r\n                },\r\n                default: defaultCritical ? \"critical\" : \"normal\",\r\n                close: () => resolve(null),\r\n            }, options).render(true);\r\n        });\r\n    }\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Handle submission of the Roll evaluation configuration Dialog\r\n     * @param {jQuery} html             The submitted dialog content\r\n     * @param {boolean} isCritical      Is the damage a critical hit?\r\n     * @private\r\n     */\r\n    //@ts-expect-error\r\n    _onDialogSubmit(html, isCritical) {\r\n        const form = html[0].querySelector(\"form\");\r\n        // Append a situational bonus term\r\n        if (form.bonus.value) {\r\n            const bonus = new Roll(form.bonus.value, this.data);\r\n            if (!(bonus.terms[0] instanceof OperatorTerm))\r\n                this.terms.push(new OperatorTerm({ operator: \"+\" }));\r\n            this.terms = this.terms.concat(bonus.terms);\r\n        }\r\n        // Apply advantage or disadvantage\r\n        //@ts-expect-error\r\n        this.options.critical = isCritical;\r\n        //@ts-expect-error\r\n        this.options.rollMode = form.rollMode.value;\r\n        //@ts-expect-error\r\n        this.options.damageType.forEach((part, ind) => (this.options.damageType[ind] = form[`damageType.${ind}`] ? part[form[`damageType.${ind}`].value] : part[0]));\r\n        //@ts-expect-error\r\n        this.options.mRoll = form.mRoll?.checked;\r\n        this.configureDamage();\r\n        return this;\r\n    }\r\n    /* -------------------------------------------- */\r\n    /** @inheritdoc */\r\n    //@ts-expect-error\r\n    static fromData(data) {\r\n        const roll = super.fromData(data);\r\n        //@ts-expect-error\r\n        roll._formula = this.getFormula(roll.terms);\r\n        return roll;\r\n    }\r\n}\r\n/**\r\n * The HTML template path used to configure evaluation of this Roll\r\n * @type {string}\r\n */\r\nDamageRoll.EVALUATION_TEMPLATE = \"systems/ard20/templates/chat/roll-dialog.html\";\r\n","export { default as D20Roll } from \"./d20-roll.js\";\r\nexport { default as DamageRoll } from \"./damage-roll.js\";\r\n/**\r\n * A standardized helper function for simplifying the constant parts of a multipart roll formula\r\n *\r\n * @param {string} formula                 The original Roll formula\r\n * @param {Object} data                    Actor or item data against which to parse the roll\r\n * @param {Object} options                 Formatting options\r\n * @param {boolean} options.constantFirst   Puts the constants before the dice terms in the resulting formula\r\n *\r\n * @return {string}                        The resulting simplified formula\r\n */\r\nexport function simplifyRollFormula(formula, data, { constantFirst = false }) {\r\n    const roll = new Roll(formula, data); // Parses the formula and replaces any @properties\r\n    const terms = roll.terms;\r\n    // Some terms are \"too complicated\" for this algorithm to simplify\r\n    // In this case, the original formula is returned.\r\n    if (terms.some(_isUnsupportedTerm))\r\n        return roll.formula;\r\n    const rollableTerms = []; // Terms that are non-constant, and their associated operators\r\n    const constantTerms = []; // Terms that are constant, and their associated operators\r\n    let operators = []; // Temporary storage for operators before they are moved to one of the above\r\n    for (let term of terms) {\r\n        // For each term\r\n        if (term instanceof OperatorTerm)\r\n            operators.push(term);\r\n        // If the term is an addition/subtraction operator, push the term into the operators array\r\n        else {\r\n            // Otherwise the term is not an operator\r\n            if (term instanceof DiceTerm) {\r\n                // If the term is something rollable\r\n                rollableTerms.push(...operators); // Place all the operators into the rollableTerms array\r\n                rollableTerms.push(term); // Then place this rollable term into it as well\r\n            } //\r\n            else {\r\n                // Otherwise, this must be a constant\r\n                constantTerms.push(...operators); // Place the operators into the constantTerms array\r\n                constantTerms.push(term); // Then also add this constant term to that array.\r\n            } //\r\n            operators = []; // Finally, the operators have now all been assigend to one of the arrays, so empty this before the next iteration.\r\n        }\r\n    }\r\n    const constantFormula = Roll.getFormula(constantTerms); // Cleans up the constant terms and produces a new formula string\r\n    const rollableFormula = Roll.getFormula(rollableTerms); // Cleans up the non-constant terms and produces a new formula string\r\n    // Mathematically evaluate the constant formula to produce a single constant term\r\n    let constantPart = undefined;\r\n    if (constantFormula) {\r\n        try {\r\n            constantPart = Roll.safeEval(constantFormula);\r\n        }\r\n        catch (err) {\r\n            console.warn(`Unable to evaluate constant term ${constantFormula} in simplifyRollFormula`);\r\n        }\r\n    }\r\n    // Order the rollable and constant terms, either constant first or second depending on the optional argument\r\n    const parts = constantFirst ? [constantPart, rollableFormula] : [rollableFormula, constantPart];\r\n    // Join the parts with a + sign, pass them to `Roll` once again to clean up the formula\r\n    return new Roll(parts.filterJoin(\" + \")).formula;\r\n}\r\n/* -------------------------------------------- */\r\n/**\r\n * Only some terms are supported by simplifyRollFormula, this method returns true when the term is not supported.\r\n * @param {*} term - A single Dice term to check support on\r\n * @return {Boolean} True when unsupported, false if supported\r\n */\r\nfunction _isUnsupportedTerm(term) {\r\n    const diceTerm = term instanceof DiceTerm;\r\n    const operator = term instanceof OperatorTerm && [\"+\", \"-\"].includes(term.operator);\r\n    const number = term instanceof NumericTerm;\r\n    return !(diceTerm || operator || number);\r\n}\r\n/* -------------------------------------------- */\r\n/* D20 Roll                                     */\r\n/* -------------------------------------------- */\r\n/**\r\n * A standardized helper function for managing core 5e d20 rolls.\r\n * Holding SHIFT, ALT, or CTRL when the attack is rolled will \"fast-forward\".\r\n * This chooses the default options of a normal attack with no bonus, Advantage, or Disadvantage respectively\r\n *\r\n * @param {string[]} parts          The dice roll component parts, excluding the initial d20\r\n * @param {object} data             Actor or item data against which to parse the roll\r\n *\r\n * @param {boolean} [advantage]       Apply advantage to the roll (unless otherwise specified)\r\n * @param {boolean} [disadvantage]    Apply disadvantage to the roll (unless otherwise specified)\r\n * @param {number} [critical]         The value of d20 result which represents a critical success\r\n * @param {number} [fumble]           The value of d20 result which represents a critical failure\r\n * @param {number} [targetValue]      Assign a target value against which the result of this roll should be compared\r\n\r\n * @param {boolean} [chooseModifier=false] Choose the ability modifier that should be used when the roll is made\r\n * @param {boolean} [fastForward=false] Allow fast-forward advantage selection\r\n * @param {Event} [event]             The triggering event which initiated the roll\r\n * @param {string} [rollMode]         A specific roll mode to apply as the default for the resulting roll\r\n * @param {string} [template]         The HTML template used to render the roll dialog\r\n * @param {string} [title]            The dialog window title\r\n * @param {Object} [dialogOptions]    Modal dialog options\r\n *\r\n * @param {boolean} [chatMessage=true] Automatically create a Chat Message for the result of this roll\r\n * @param {object} [messageData={}] Additional data which is applied to the created Chat Message, if any\r\n * @param {string} [rollMode]       A specific roll mode to apply as the default for the resulting roll\r\n * @param {object} [speaker]        The ChatMessage speaker to pass when creating the chat\r\n * @param {string} [flavor]         Flavor text to use in the posted chat message\r\n *\r\n * @return {Promise<D20Roll|null>}  The evaluated D20Roll, or null if the workflow was cancelled\r\n */\r\n//@ts-expect-error\r\nexport async function d20Roll({ \r\n//@ts-expect-error\r\nparts = [], \r\n//@ts-expect-error\r\ndata = {}, \r\n//@ts-expect-error\r\nadvantage, \r\n//@ts-expect-error\r\ndisadvantage, \r\n//@ts-expect-error\r\nfumble = 1, \r\n//@ts-expect-error\r\ncritical = 20, \r\n//@ts-expect-error\r\ntargetValue, \r\n//@ts-expect-error\r\nchooseModifier = false, \r\n//@ts-expect-error\r\nfastForward = false, \r\n//@ts-expect-error\r\nevent, \r\n//@ts-expect-error\r\ntemplate, \r\n//@ts-expect-error\r\ntitle, \r\n//@ts-expect-error\r\ndialogOptions, \r\n//@ts-expect-error\r\nchatMessage = true, \r\n//@ts-expect-error\r\nmessageData = {}, \r\n//@ts-expect-error\r\nrollMode, \r\n//@ts-expect-error\r\nspeaker, \r\n//@ts-expect-error\r\noptions, \r\n//@ts-expect-error\r\nflavor, \r\n//@ts-expect-error\r\ncanMult, \r\n//@ts-expect-error\r\nmRoll,\r\n//@ts-expect-error\r\n } = {}) {\r\n    // Handle input arguments\r\n    const formula = [\"1d20\"].concat(parts).join(\" + \");\r\n    const { advantageMode, isFF } = _determineAdvantageMode({ advantage, disadvantage, fastForward, event });\r\n    const defaultRollMode = rollMode || game.settings.get(\"core\", \"rollMode\");\r\n    if (chooseModifier && !isFF) {\r\n        data[\"mod\"] = \"@mod\";\r\n    }\r\n    // Construct the D20Roll instance\r\n    //@ts-expect-error\r\n    const roll = new CONFIG.Dice.D20Roll(formula, data, {\r\n        flavor: flavor || title,\r\n        advantageMode,\r\n        defaultRollMode,\r\n        critical,\r\n        fumble,\r\n        targetValue,\r\n        mRoll,\r\n    });\r\n    // Prompt a Dialog to further configure the D20Roll\r\n    if (!isFF) {\r\n        const configured = await roll.configureDialog({\r\n            title,\r\n            chooseModifier,\r\n            defaultRollMode: defaultRollMode,\r\n            defaultAction: advantageMode,\r\n            defaultAbility: data?.item?.ability,\r\n            template,\r\n            canMult,\r\n            mRoll,\r\n        }, dialogOptions);\r\n        if (configured === null)\r\n            return null;\r\n    }\r\n    // Evaluate the configured roll\r\n    await roll.evaluate({ async: true });\r\n    // Create a Chat Message\r\n    if (speaker) {\r\n        console.warn(`You are passing the speaker argument to the d20Roll function directly which should instead be passed as an internal key of messageData`);\r\n        messageData.speaker = speaker;\r\n    }\r\n    if (roll && chatMessage)\r\n        await roll.toMessage(messageData, options);\r\n    return roll;\r\n}\r\n/* -------------------------------------------- */\r\n/**\r\n * Determines whether this d20 roll should be fast-forwarded, and whether advantage or disadvantage should be applied\r\n * @returns {{isFF: boolean, advantageMode: number}}  Whether the roll is fast-forward, and its advantage mode\r\n */\r\n//@ts-expect-error\r\nfunction _determineAdvantageMode({ event, advantage = false, disadvantage = false, fastForward = false } = {}) {\r\n    const isFF = fastForward || (event && (event.shiftKey || event.altKey || event.ctrlKey || event.metaKey));\r\n    //@ts-expect-error\r\n    let advantageMode = CONFIG.Dice.D20Roll.ADV_MODE.NORMAL;\r\n    //@ts-expect-error\r\n    if (advantage || event?.altKey)\r\n        advantageMode = CONFIG.Dice.D20Roll.ADV_MODE.ADVANTAGE;\r\n    //@ts-expect-error\r\n    else if (disadvantage || event?.ctrlKey || event?.metaKey)\r\n        advantageMode = CONFIG.Dice.D20Roll.ADV_MODE.DISADVANTAGE;\r\n    return { isFF, advantageMode };\r\n}\r\n/* -------------------------------------------- */\r\n/* Damage Roll                                  */\r\n/* -------------------------------------------- */\r\n/**\r\n * A standardized helper function for managing core 5e damage rolls.\r\n * Holding SHIFT, ALT, or CTRL when the attack is rolled will \"fast-forward\".\r\n * This chooses the default options of a normal attack with no bonus, Critical, or no bonus respectively\r\n *\r\n * @param {string[]} parts          The dice roll component parts, excluding the initial d20\r\n * @param {object} [data]           Actor or item data against which to parse the roll\r\n *\r\n * @param {boolean} [critical=false] Flag this roll as a critical hit for the purposes of fast-forward or default dialog action\r\n * @param {number} [criticalBonusDice=0] A number of bonus damage dice that are added for critical hits\r\n * @param {number} [criticalMultiplier=2] A critical hit multiplier which is applied to critical hits\r\n * @param {boolean} [multiplyNumeric=false] Multiply numeric terms by the critical multiplier\r\n * @param {boolean} [powerfulCritical=false] Apply the \"powerful criticals\" house rule to critical hits\r\n\r\n * @param {boolean} [fastForward=false] Allow fast-forward advantage selection\r\n * @param {Event}[event]            The triggering event which initiated the roll\r\n * @param {boolean} [allowCritical=true] Allow the opportunity for a critical hit to be rolled\r\n * @param {string} [template]       The HTML template used to render the roll dialog\r\n * @param {string} [title]          The dice roll UI window title\r\n * @param {object} [dialogOptions]  Configuration dialog options\r\n *\r\n * @param {boolean} [chatMessage=true] Automatically create a Chat Message for the result of this roll\r\n * @param {object} [messageData={}] Additional data which is applied to the created Chat Message, if any\r\n * @param {string} [rollMode]       A specific roll mode to apply as the default for the resulting roll\r\n * @param {object} [speaker]        The ChatMessage speaker to pass when creating the chat\r\n * @param {string} [flavor]         Flavor text to use in the posted chat message\r\n *\r\n * @return {Promise<DamageRoll|null>} The evaluated DamageRoll, or null if the workflow was canceled\r\n */\r\n//@ts-expect-error\r\nexport async function damageRoll({ \r\n//@ts-expect-error\r\nparts = [], \r\n//@ts-expect-error\r\ndata, // Roll creation\r\n//@ts-expect-error\r\ncritical = false, \r\n//@ts-expect-error\r\ndamType, \r\n//@ts-expect-error\r\ndamageType, \r\n//@ts-expect-error\r\ncriticalBonusDice, \r\n//@ts-expect-error\r\ncriticalMultiplier, \r\n//@ts-expect-error\r\nmultiplyNumeric, // Damage customization\r\n//@ts-expect-error\r\nfastForward = false, \r\n//@ts-expect-error\r\nevent, \r\n//@ts-expect-error\r\nallowCritical = true, \r\n//@ts-expect-error\r\ntemplate, \r\n//@ts-expect-error\r\ntitle, \r\n//@ts-expect-error\r\ndialogOptions, // Dialog configuration\r\n//@ts-expect-error\r\nchatMessage = false, \r\n//@ts-expect-error\r\nmessageData = {}, \r\n//@ts-expect-error\r\nrollMode, \r\n//@ts-expect-error\r\nspeaker, \r\n//@ts-expect-error\r\ncanMult, \r\n//@ts-expect-error\r\nflavor, \r\n//@ts-expect-error\r\nmRoll\r\n//@ts-expect-error\r\n } = {}) {\r\n    console.log(canMult);\r\n    // Handle input arguments\r\n    const defaultRollMode = rollMode || game.settings.get(\"core\", \"rollMode\");\r\n    // Construct the DamageRoll instance\r\n    const formula = parts.join(\" + \");\r\n    const { isCritical, isFF } = _determineCriticalMode({ critical, fastForward, event });\r\n    //@ts-expect-error\r\n    const roll = new CONFIG.Dice.DamageRoll(formula, data, {\r\n        flavor: flavor || title,\r\n        critical: isCritical,\r\n        criticalBonusDice,\r\n        criticalMultiplier,\r\n        multiplyNumeric,\r\n        damType,\r\n        mRoll,\r\n        damageType\r\n    });\r\n    // Prompt a Dialog to further configure the DamageRoll\r\n    if (!isFF) {\r\n        const configured = await roll.configureDialog({\r\n            title,\r\n            defaultRollMode: defaultRollMode,\r\n            defaultCritical: isCritical,\r\n            template,\r\n            allowCritical,\r\n            mRoll,\r\n            canMult,\r\n            damType\r\n        }, dialogOptions);\r\n        if (configured === null)\r\n            return null;\r\n    }\r\n    // Evaluate the configured roll\r\n    await roll.evaluate({ async: true });\r\n    // Create a Chat Message\r\n    if (speaker) {\r\n        console.warn(`You are passing the speaker argument to the damageRoll function directly which should instead be passed as an internal key of messageData`);\r\n        messageData.speaker = speaker;\r\n    }\r\n    if (roll && chatMessage)\r\n        await roll.toMessage(messageData);\r\n    return roll;\r\n}\r\n/* -------------------------------------------- */\r\n/**\r\n * Determines whether this d20 roll should be fast-forwarded, and whether advantage or disadvantage should be applied\r\n * @returns {{isFF: boolean, isCritical: boolean}}  Whether the roll is fast-forward, and whether it is a critical hit\r\n */\r\n//@ts-expect-error\r\nfunction _determineCriticalMode({ event, critical = false, fastForward = false } = {}) {\r\n    const isFF = fastForward || (event && (event.shiftKey || event.altKey || event.ctrlKey || event.metaKey));\r\n    if (event?.altKey)\r\n        critical = true;\r\n    return { isFF, isCritical: critical };\r\n}\r\n","import { getValues, obj_entries } from \"../ard20.js\";\r\nimport { d20Roll, damageRoll, simplifyRollFormula } from \"../dice/dice.js\";\r\n/**\r\n * Extend the basic Item with some very simple modifications.\r\n * @extends {Item}\r\n */\r\nexport class ARd20Item extends Item {\r\n    /**\r\n     * Augment the basic Item data model with additional dynamic data.\r\n     */\r\n    prepareData() {\r\n        // As with the actor class, items are documents that can have their data\r\n        // preparation methods overridden (such as prepareBaseData()).\r\n        super.prepareData();\r\n    }\r\n    prepareDerivedData() {\r\n        super.prepareDerivedData();\r\n        const itemData = this.system;\r\n        this._prepareSpellData(itemData);\r\n        this._prepareWeaponData(itemData);\r\n        this._prepareFeatureData(itemData);\r\n        this._prepareRaceData(itemData);\r\n        this._prepareArmorData(itemData);\r\n        if (itemData.hasAttack)\r\n            this._prepareAttack(itemData);\r\n        if (itemData.hasDamage)\r\n            this._prepareDamage(itemData);\r\n        if (!this.isOwned)\r\n            this.prepareFinalAttributes();\r\n    }\r\n    /**\r\n     *Prepare data for Spells\r\n     */\r\n    _prepareSpellData(itemData) {\r\n        if (itemData.type !== \"spell\")\r\n            return;\r\n        const data = itemData;\r\n    }\r\n    /**\r\n     *Prepare data for weapons\r\n     */\r\n    _prepareWeaponData(itemData) {\r\n        if (itemData.type !== \"weapon\")\r\n            return;\r\n        const data = itemData;\r\n        const flags = itemData.flags;\r\n        data.hasAttack = data.hasAttack || true;\r\n        data.hasDamage = data.hasDamage || true;\r\n        //TODO: this._setDeflect(data);\r\n        this._setTypeAndSubtype(data, flags);\r\n        for (let [key, type] of obj_entries(data.damage)) {\r\n            if (key !== \"current\") {\r\n                for (let [key, prof] of obj_entries(type)) {\r\n                    prof.formula = \"\";\r\n                    prof.parts.forEach((part) => {\r\n                        if (Array.isArray(part[1])) {\r\n                            prof.formula += `${part[0]}`;\r\n                            part[1].forEach((sub, ind) => {\r\n                                if (ind === 0) {\r\n                                    prof.formula += ` {${sub[0]} ${sub[1]}`;\r\n                                    prof.formula += ind === part[1].length - 1 ? \"}\" : \"\";\r\n                                }\r\n                                else {\r\n                                    prof.formula += ` or ${sub[0]} ${sub[1]}`;\r\n                                    prof.formula += ind === part[1].length - 1 ? \"}\" : \"\";\r\n                                }\r\n                            });\r\n                        }\r\n                        else\r\n                            prof.formula += `${part[0]} {${part[1]} ${part[2]}}; `;\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     *Set deflect die equal to damage die, if not\r\n     */\r\n    /* TODO:\r\n    _setDeflect(data: object & WeaponDataPropertiesData) {\r\n      for (let [k, v] of obj_entries(CONFIG.ARd20.Rank)) {\r\n        v = game.i18n.localize(CONFIG.ARd20.prof[k]) ?? k;\r\n        v = v.toLowerCase();\r\n        data.deflect[v] = data.property[v].def ? data.deflect[v] || data.damage.common[v] : 0;\r\n      }\r\n    }\r\n    */\r\n    //@ts-expect-error\r\n    _setTypeAndSubtype(data, flags) {\r\n        data.sub_type_array = game.settings\r\n            .get(\"ard20\", \"proficiencies\")\r\n            .weapon.filter((prof) => prof.type === data.type.value);\r\n        if (flags.core?.sourceId) {\r\n            const id = /Item.(.+)/.exec(flags.core.sourceId)[1];\r\n            const item = game.items.get(id);\r\n            if (item?.data.type === \"weapon\") {\r\n                data.sub_type = data.sub_type === undefined ? item.system.sub_type : data.sub_type;\r\n            }\r\n        }\r\n        data.sub_type =\r\n            data.sub_type_array.filter((prof) => prof.name === data.sub_type).length === 0\r\n                ? data.sub_type_array[0].name\r\n                : data.sub_type || data.sub_type_array[0].name;\r\n        data.proficiency.name =\r\n            game.i18n.localize(getValues(CONFIG.ARd20.Rank, data.proficiency.level)) ??\r\n                getValues(CONFIG.ARd20.Rank, data.proficiency.level);\r\n        data.type.name =\r\n            game.i18n.localize(getValues(CONFIG.ARd20.Rank, data.type.value)) ??\r\n                getValues(CONFIG.ARd20.Rank, data.type.value);\r\n    }\r\n    /**\r\n     *Prepare data for features\r\n     */\r\n    _prepareFeatureData(itemData) {\r\n        if (itemData.type !== \"feature\")\r\n            return;\r\n        const data = itemData;\r\n        // Handle Source of the feature\r\n        data.source.label = \"\";\r\n        data.source.value.forEach((value, key) => {\r\n            let label = game.i18n.localize(getValues(CONFIG.ARd20.Source, value));\r\n            data.source.label += key === 0 ? label : `, ${label}`;\r\n        });\r\n        //labels.source = game.i18n.localize(CONFIG.ARd20.source[data.source.value]);\r\n        //define levels\r\n        data.level.has = data.level.has !== undefined ? data.level.has : false;\r\n        data.level.max = data.level.has ? data.level.max || 4 : 1;\r\n        data.level.initial = Math.min(data.level.max, data.level.initial);\r\n        data.level.current = this.isOwned ? Math.max(data.level.initial, 1) : 0;\r\n        //define exp cost\r\n        if (data.level.max > 1) {\r\n            let n = (10 - data.level.max) / data.level.max;\r\n            let k = 1.7 + (Math.round(Number((Math.abs(n) * 100).toPrecision(15))) / 100) * Math.sign(n);\r\n            if (data.xp.basicCost.length < data.level.max) {\r\n                for (let i = 1; i < data.level.max; i++) {\r\n                    data.xp.basicCost.push(Math.round((data.xp.basicCost[i - 1] * k) / 5) * 5);\r\n                    data.xp.AdvancedCost.push(data.xp.basicCost[i]);\r\n                }\r\n            }\r\n            else {\r\n                for (let i = 1; i < data.level.max; i++) {\r\n                    data.xp.basicCost[i] = Math.round((data.xp.basicCost[i - 1] * k) / 5) * 5;\r\n                    data.xp.AdvancedCost[i] = data.xp.AdvancedCost[i] ?? data.xp.basicCost[i];\r\n                }\r\n            }\r\n        }\r\n        for (let [key, req] of Object.entries(data.req.values)) {\r\n            req.pass = Array.from({ length: data.level.max }, (i) => (i = false));\r\n            switch (req.type) {\r\n                case \"ability\":\r\n                    for (let [key, v] of obj_entries(CONFIG.ARd20.Attributes)) {\r\n                        if (req.name === game.i18n.localize(CONFIG.ARd20.Attributes[key]))\r\n                            req.value = key;\r\n                    }\r\n                    break;\r\n                case \"skill\":\r\n                    for (let [key, v] of obj_entries(CONFIG.ARd20.Skills)) {\r\n                        if (req.name === game.i18n.localize(CONFIG.ARd20.Skills[key]))\r\n                            req.value = key;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        for (let i = data.req.logic.length; data.level.max > data.req.logic.length; i++) {\r\n            if (i === 0) {\r\n                data.req.logic.push(\"1\");\r\n            }\r\n            else {\r\n                data.req.logic.push(data.req.logic[i - 1]);\r\n            }\r\n        }\r\n        for (let i = data.req.logic.length; data.level.max < data.req.logic.length; i--) {\r\n            data.req.logic.splice(data.req.logic.length - 1, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Prepare data for 'race' type of item\r\n     */\r\n    _prepareRaceData(itemData) {\r\n        if (itemData.type !== \"race\")\r\n            return;\r\n    }\r\n    /**\r\n     * Prepare data for \"armor\" type item\r\n     */\r\n    _prepareArmorData(itemData) {\r\n        if (itemData.type !== \"armor\")\r\n            return;\r\n        const data = itemData;\r\n        for (let [key, dr] of obj_entries(CONFIG.ARd20.DamageSubTypes)) {\r\n            if (!(key === \"force\" || key === \"radiant\" || key === \"psychic\")) {\r\n                data.res.phys[key] = data.res.phys[key] ?? 0;\r\n            }\r\n            data.res.mag[key] = data.res.mag[key] ?? 0;\r\n        }\r\n        data.mobility.value = data.mobility.value ?? CONFIG.ARd20.HeavyPoints[data.type][data.slot];\r\n        data.mobility.value += data.mobility.bonus;\r\n    }\r\n    /**\r\n    Prepare Data that uses actor's data\r\n    */\r\n    prepareFinalAttributes() {\r\n        const itemData = this.system;\r\n        //@ts-expect-error\r\n        const abil = (itemData.abil = {});\r\n        for (let [k, v] of obj_entries(CONFIG.ARd20.Attributes)) {\r\n            abil[k] = this.isOwned ? getProperty(this.actor.data, `data.attributes.${k}.mod`) : null;\r\n        }\r\n        let prof_bonus = 0;\r\n        if (itemData.type === \"weapon\") {\r\n            const data = itemData;\r\n            data.proficiency.level = this.isOwned\r\n                ? this.actor?.system.proficiencies.weapon.filter((pr) => pr.name === data.sub_type)[0].value\r\n                : 0;\r\n            data.proficiency.levelName =\r\n                game.i18n.localize(CONFIG.ARd20.Rank[data.proficiency.level]) ?? CONFIG.ARd20.Rank[data.proficiency.level];\r\n            prof_bonus = data.proficiency.level * 4;\r\n        }\r\n        if (itemData.hasAttack)\r\n            this._prepareAttack(itemData, prof_bonus, abil);\r\n        if (itemData.hasDamage)\r\n            this._prepareDamage(itemData, abil);\r\n    }\r\n    _prepareAttack(itemData, prof_bonus, abil) {\r\n        const data = itemData;\r\n        if (!data.hasAttack)\r\n            return;\r\n        //@ts-expect-error\r\n        let mod = itemData.type === \"weapon\" && abil !== undefined ? abil.dex : data.atkMod;\r\n        //@ts-expect-error\r\n        data.attack = {\r\n            formula: \"1d20+\" + prof_bonus + \"+\" + mod,\r\n            parts: [mod, prof_bonus],\r\n        };\r\n    }\r\n    _prepareDamage(itemData, abil) {\r\n        const data = itemData;\r\n        if (!data.hasDamage)\r\n            return;\r\n        let mod = itemData.type === \"weapon\" && abil !== undefined ? abil.str : 0;\r\n        const prop = \"damage.parts\";\r\n        let baseDamage = getProperty(data, prop);\r\n        //@ts-expect-error\r\n        data.damage.current = {\r\n            formula: \"\",\r\n            parts: baseDamage,\r\n        };\r\n        baseDamage.forEach((part) => {\r\n            //@ts-expect-error\r\n            data.damage.current.formula += part[0] + `[${part[1]}, ${part[2]}] `;\r\n        });\r\n    }\r\n    /**\r\n     * Prepare a data object which is passed to any Roll formulas which are created related to this Item\r\n     * @private\r\n     */\r\n    //@ts-expect-error\r\n    getRollData() {\r\n        // If present, return the actor's roll data.\r\n        if (!this.actor)\r\n            return null;\r\n        const rollData = this.actor.getRollData();\r\n        const hasDamage = this.system.hasDamage;\r\n        const hasAttack = this.system.hasAttack;\r\n        //@ts-expect-error\r\n        rollData.item = foundry.utils.deepClone(this.system);\r\n        //@ts-expect-error\r\n        rollData.damageDie = hasDamage ? this.system.damage.current.parts[0] : null;\r\n        //@ts-expect-error\r\n        rollData.mod = hasAttack\r\n            ? //@ts-expect-error\r\n                this.system.attack.parts[0]\r\n            : hasDamage\r\n                ? //@ts-expect-error\r\n                    this.system.damage.current.parts[1]\r\n                : null;\r\n        //@ts-expect-error\r\n        rollData.prof = hasAttack ? this.system.attack.parts[1] : null;\r\n        return rollData;\r\n    }\r\n    /**\r\n     * Handle clickable rolls.\r\n     * @param {Event} event   The originating click event\r\n     * @private\r\n     */\r\n    //@ts-expect-error\r\n    async roll({ configureDialog = true, rollMode, hasDamage = false, hasAttack = false, createMessage = true }) {\r\n        let item = this;\r\n        const id = item.id;\r\n        const iData = this.system; //Item data\r\n        const actor = this.actor;\r\n        const aData = actor?.system;\r\n        hasDamage = iData.hasDamage || hasDamage;\r\n        hasAttack = iData.hasAttack || hasAttack;\r\n        // Initialize chat data.\r\n        const speaker = ChatMessage.getSpeaker({ actor: actor });\r\n        const iName = this.name;\r\n        // Otherwise, create a roll and send a chat message from it.\r\n        const targets = Array.from(game.user.targets);\r\n        //@ts-expect-error\r\n        const mRoll = this.system.mRoll || false;\r\n        //@ts-expect-error\r\n        return item.displayCard({ rollMode, createMessage, hasAttack, hasDamage, targets, mRoll });\r\n    }\r\n    /* -------------------------------------------- */\r\n    /*  Chat Message Helpers                        */\r\n    /* -------------------------------------------- */\r\n    static chatListeners(html) {\r\n        html.on(\"click\", \".card-buttons button\", this._onChatCardAction.bind(this));\r\n        html.on(\"click\", \".item-name\", this._onChatCardToggleContent.bind(this));\r\n        html.on(\"click\", \".attack-roll .roll-controls .accept\", this._rollDamage.bind(this));\r\n        html.on(\"hover\", \".attack-roll .flexrow .value\", function (event) {\r\n            event.preventDefault();\r\n            const element = this.closest(\"li.flexrow\");\r\n            element.querySelector(\".attack-roll .hover-roll\")?.classList.toggle(\"shown\", event.type == \"mouseenter\");\r\n        });\r\n    }\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Handle execution of a chat card action via a click event on one of the card buttons\r\n     * @param {Event} event       The originating click event\r\n     * @returns {Promise}         A promise which resolves once the handler workflow is complete\r\n     * @private\r\n     */\r\n    //@ts-expect-error\r\n    static async _onChatCardAction(event) {\r\n        event.preventDefault();\r\n        // Extract card data\r\n        const button = event.currentTarget;\r\n        const card = button.closest(\".chat-card\");\r\n        const messageId = card.closest(\".message\").dataset.messageId;\r\n        const message = game.messages.get(messageId);\r\n        const action = button.dataset.action;\r\n        const targetUuid = button.closest(\".flexrow\").dataset.targetId;\r\n        // Validate permission to proceed with the roll\r\n        const isTargetted = action === \"save\";\r\n        if (!(isTargetted || game.user.isGM || message.isAuthor))\r\n            return;\r\n        // Recover the actor for the chat card\r\n        const actor = await this._getChatCardActor(card);\r\n        if (!actor)\r\n            return;\r\n        // Get the Item from stored flag data or by the item ID on the Actor\r\n        const storedData = message.getFlag(\"ard20\", \"itemData\");\r\n        //@ts-expect-error\r\n        const item = storedData ? new this(storedData, { parent: actor }) : actor.items.get(card.dataset.itemId);\r\n        if (!item) {\r\n            return ui.notifications.error(game.i18n.format(\"ARd20.ActionWarningNoItem\", { item: card.dataset.itemId, name: actor.name }));\r\n        }\r\n        const spellLevel = parseInt(card.dataset.spellLevel) || null;\r\n        // Handle different actions\r\n        switch (action) {\r\n            case \"damage\":\r\n            case \"versatile\":\r\n                let dam = await item.rollDamage({\r\n                    critical: event.altKey,\r\n                    event: event,\r\n                    spellLevel: spellLevel,\r\n                    versatile: action === \"versatile\",\r\n                });\r\n                //const dom = new DOMParser().parseFromString(message.data.content,\"text/html\")\r\n                const html = $(message.data.content);\r\n                dam = await dam.render();\r\n                //dom.querySelector('button').replaceWith(dam)\r\n                if (targetUuid) {\r\n                    html.find(`[data-targetId=\"${targetUuid}\"]`).find(\"button\").replaceWith(dam);\r\n                }\r\n                else {\r\n                    html.find(\".damage-roll\").find(\"button\").replaceWith(dam);\r\n                }\r\n                //console.log(dom)\r\n                await message.update({ content: html[0].outerHTML });\r\n                break;\r\n            case \"formula\":\r\n                await item.rollFormula({ event, spellLevel });\r\n                break;\r\n            case \"save\":\r\n                const targets = this._getChatCardTargets(card);\r\n                for (let token of targets) {\r\n                    //@ts-expect-error\r\n                    const speaker = ChatMessage.getSpeaker({ scene: canvas.scene, token: token });\r\n                    //@ts-expect-error\r\n                    await token.actor.rollAbilitySave(button.dataset.ability, { event, speaker });\r\n                }\r\n                break;\r\n            case \"toolCheck\":\r\n                await item.rollToolCheck({ event });\r\n                break;\r\n            case \"placeTemplate\":\r\n                ///@ts-expect-error\r\n                const template = game.ard20.canvas.AbilityTemplate.fromItem(item);\r\n                if (template)\r\n                    template.drawPreview();\r\n                break;\r\n        }\r\n        // Re-enable the button\r\n        button.disabled = false;\r\n    }\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Handle toggling the visibility of chat card content when the name is clicked\r\n     * @param {Event} event   The originating click event\r\n     * @private\r\n     */\r\n    static _onChatCardToggleContent(event) {\r\n        event.preventDefault();\r\n        const header = event.currentTarget;\r\n        const card = header.closest(\".chat-card\");\r\n        const content = card.querySelector(\".card-content\");\r\n        content.style.display = content.style.display === \"none\" ? \"block\" : \"none\";\r\n    }\r\n    async _applyDamage(dam, tData, tHealth, tActor) {\r\n        let value = dam.total;\r\n        console.log(\"урон до резистов: \", value);\r\n        dam.terms.forEach((term) => {\r\n            if (!(term instanceof OperatorTerm)) {\r\n                let damageType = term.options.damageType;\r\n                let res = tData.defences.damage[damageType[0]][damageType[1]];\r\n                if (res.type === \"imm\")\r\n                    console.log(\"Иммунитет\");\r\n                console.log(\"урон уменьшился с \", value);\r\n                value -= res.type === \"imm\" ? term.total : Math.min(res.value, term.total);\r\n                console.log(\"до\", value);\r\n            }\r\n        });\r\n        console.log(value, \"итоговый урон\");\r\n        tHealth -= value;\r\n        console.log(\"хп стало\", tHealth);\r\n        let obj = {};\r\n        obj[\"data.health.value\"] = tHealth;\r\n        if (game.user.isGM) {\r\n            await tActor.update(obj);\r\n        }\r\n        else {\r\n            game.socket.emit(\"system.ard20\", {\r\n                operation: \"updateActorData\",\r\n                actor: tActor,\r\n                update: obj,\r\n                value: value,\r\n            });\r\n        }\r\n    }\r\n    static async _rollDamage(event) {\r\n        event.preventDefault();\r\n        const element = event.currentTarget;\r\n        const card = element.closest(\".chat-card\");\r\n        const message = game.messages.get(card.closest(\".message\").dataset.messageId);\r\n        const targetUuid = element.closest(\"li.flexrow\").dataset.targetId;\r\n        const token = await fromUuid(targetUuid);\r\n        //@ts-expect-error\r\n        const tActor = token?.actor;\r\n        const tData = tActor.system;\r\n        let tHealth = tData.health.value;\r\n        console.log(tHealth, \"здоровье цели\");\r\n        // Recover the actor for the chat card\r\n        const actor = await this._getChatCardActor(card);\r\n        if (!actor)\r\n            return;\r\n        // Get the Item from stored flag data or by the item ID on the Actor\r\n        const storedData = message.getFlag(\"ard20\", \"itemData\");\r\n        //@ts-expect-error\r\n        const item = storedData ? new this(storedData, { parent: actor }) : actor.items.get(card.dataset.itemId);\r\n        if (!item) {\r\n            return ui.notifications.error(game.i18n.format(\"ARd20.ActionWarningNoItem\", { item: card.dataset.itemId, name: actor.name }));\r\n        }\r\n        const dam = await item.rollDamage({\r\n            event: event,\r\n            canMult: false,\r\n        });\r\n        const html = $(message.data.content);\r\n        let damHTML = await dam.render();\r\n        console.log(html.find(`[data-target-id=\"${targetUuid}\"]`).find(\".damage-roll\")[0]);\r\n        html.find(`[data-target-id=\"${targetUuid}\"]`).find(\".damage-roll\").append(damHTML);\r\n        html.find(`[data-target-id=\"${targetUuid}\"]`).find(\".accept\").remove();\r\n        console.log(html[0]);\r\n        await message.update({ content: html[0].outerHTML });\r\n        await item._applyDamage(dam, tData, tHealth, tActor);\r\n    }\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Get the Actor which is the author of a chat card\r\n     * @param {HTMLElement} card    The chat card being used\r\n     * @return {Actor|null}         The Actor entity or null\r\n     * @private\r\n     */\r\n    static async _getChatCardActor(card) {\r\n        // Case 1 - a synthetic actor from a Token\r\n        if (card.dataset.tokenId) {\r\n            const token = await fromUuid(card.dataset.tokenId);\r\n            if (!token)\r\n                return null;\r\n            //@ts-expect-error\r\n            return token.actor;\r\n        }\r\n        // Case 2 - use Actor ID directory\r\n        const actorId = card.dataset.actorId;\r\n        return game.actors.get(actorId) || null;\r\n    }\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Get the Actor which is the author of a chat card\r\n     * @param {HTMLElement} card    The chat card being used\r\n     * @return {Actor[]}            An Array of Actor entities, if any\r\n     * @private\r\n     */\r\n    static _getChatCardTargets(card) {\r\n        let targets = canvas.tokens.controlled.filter((t) => !!t.actor);\r\n        //@ts-expect-error\r\n        if (!targets.length && game.user.character)\r\n            targets = targets.concat(game.user.character.getActiveTokens());\r\n        if (!targets.length)\r\n            ui.notifications.warn(game.i18n.localize(\"ARd20.ActionWarningNoToken\"));\r\n        return targets;\r\n    }\r\n    /*showRollDetail(event){\r\n      event.preventDefault();\r\n      const elem = event.currentTarget;\r\n      const\r\n    }*/\r\n    async displayCard({ \r\n    //@ts-expect-error\r\n    rollMode, createMessage = true, hasAttack = Boolean(), hasDamage = Boolean(), targets = [], mRoll = Boolean(), } = {}) {\r\n        // Render the chat card template\r\n        let atk = {};\r\n        let dc = {};\r\n        let atkHTML = {};\r\n        let dmgHTML = {};\r\n        let result = {};\r\n        let hit = {};\r\n        let dmg = {};\r\n        let dieResultCss = {};\r\n        //@ts-expect-error\r\n        const def = this.system.attack?.def ?? \"reflex\";\r\n        const token = this.actor.token;\r\n        if (targets.length !== 0) {\r\n            //@ts-expect-error\r\n            let atkRoll = hasAttack ? await this.rollAttack(mRoll, { canMult: true }) : null;\r\n            let dmgRoll = hasDamage && !hasAttack ? await this.rollDamage({ canMult: true }) : null;\r\n            for (let [key, target] of Object.entries(targets)) {\r\n                if (atkRoll) {\r\n                    mRoll = atkRoll.options.mRoll;\r\n                    //@ts-expect-error\r\n                    dc[key] = target.actor.system.defences.stats[def].value;\r\n                    //@ts-expect-error\r\n                    atk[key] = hasAttack ? (Object.keys(atk).length === 0 || !mRoll ? atkRoll : await atkRoll.reroll()) : null;\r\n                    //@ts-expect-error\r\n                    console.log(atk[key]);\r\n                    //@ts-expect-error\r\n                    atkHTML[key] = hasAttack ? await atk[key].render() : null;\r\n                    //@ts-expect-error\r\n                    let d20 = atk[key] ? atk[key].terms[0] : null;\r\n                    //@ts-expect-error\r\n                    atk[key] = atk[key].total;\r\n                    //@ts-expect-error\r\n                    dieResultCss[key] =\r\n                        d20.total >= d20.options.critical ? \"d20crit\" : d20.total <= d20.options.fumble ? \"d20fumble\" : \"d20normal\";\r\n                    //@ts-expect-error\r\n                    result[key] = atk[key] > dc[key] ? \"hit\" : \"miss\";\r\n                    //@ts-expect-error\r\n                    hit[key] = result[key] === \"hit\" ? true : false;\r\n                }\r\n                else {\r\n                    mRoll = dmgRoll.options.mRoll;\r\n                    //@ts-expect-error\r\n                    dmg[key] = hasDamage ? (Object.keys(dmg).length === 0 || !mRoll ? dmgRoll : await dmgRoll.reroll()) : null;\r\n                    //@ts-expect-error\r\n                    dmgHTML[key] = hasDamage ? await dmg[key].render() : null;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            //@ts-expect-error\r\n            atk[0] = hasAttack ? await this.rollAttack(mRoll) : null;\r\n            //@ts-expect-error\r\n            mRoll = atk[0] ? atk[0].options.mRoll : false;\r\n            //@ts-expect-error\r\n            atkHTML[0] = hasAttack ? await atk[0].render() : null;\r\n        }\r\n        //@ts-expect-error\r\n        let templateState = targets.size !== 0 ? (mRoll ? \"multiAttack\" : \"oneAttack\") : \"noTarget\";\r\n        const templateData = {\r\n            //@ts-expect-error\r\n            actor: this.actor.data,\r\n            tokenId: token?.uuid || null,\r\n            item: this.data,\r\n            data: this.getChatData(),\r\n            //@ts-expect-error\r\n            labels: this.labels,\r\n            hasAttack,\r\n            hasDamage,\r\n            atk,\r\n            atkHTML,\r\n            targets,\r\n            //@ts-expect-error\r\n            owner: this.actor.isOwner || game.user.isGM,\r\n            dc,\r\n            result,\r\n            hit,\r\n            dmgHTML,\r\n            dieResultCss,\r\n        };\r\n        const html = await renderTemplate(`systems/ard20/templates/chat/item-card-multiAttack.html`, templateData);\r\n        // Create the ChatMessage data object\r\n        const chatData = {\r\n            user: game.user.data._id,\r\n            type: CONST.CHAT_MESSAGE_TYPES.OTHER,\r\n            content: html,\r\n            //@ts-expect-error\r\n            flavor: this.system.chatFlavor || this.name,\r\n            //@ts-expect-error\r\n            speaker: ChatMessage.getSpeaker({ actor: this.actor, token }),\r\n            flags: { \"core.canPopout\": true },\r\n        };\r\n        // If the Item was destroyed in the process of displaying its card - embed the item data in the chat message\r\n        /*\r\n        if (this.data.type === \"consumable\" && !this.actor.items.has(this.id)) {\r\n          chatData.flags[\"ard20.itemData\"] = this.data;\r\n        }*/\r\n        // Apply the roll mode to adjust message visibility\r\n        ChatMessage.applyRollMode(chatData, rollMode || game.settings.get(\"core\", \"rollMode\"));\r\n        // Create the Chat Message or return its data\r\n        return createMessage ? ChatMessage.create(chatData) : chatData;\r\n    }\r\n    /**\r\n     * Prepare an object of chat data used to display a card for the Item in the chat log.\r\n     * @param {object} htmlOptions    Options used by the TextEditor.enrichHTML function.\r\n     * @returns {object}              An object of chat data to render.\r\n     */\r\n    getChatData(htmlOptions = {}) {\r\n        const data = foundry.utils.deepClone(this.system);\r\n        // Rich text description\r\n        //data.description.value = TextEditor.enrichHTML(data.description.value, htmlOptions);\r\n        // Item type specific properties\r\n        const props = [];\r\n        // Equipment properties\r\n        /*if (data.hasOwnProperty(\"equipped\") && ![\"loot\", \"tool\"].includes(this.data.type)) {\r\n          /*if (data.attunement === CONFIG.ARd20.attunementTypes.REQUIRED) {\r\n            props.push(game.i18n.localize(CONFIG.ARd20.attunements[CONFIG.ARd20.attunementTypes.REQUIRED]));\r\n          }*/\r\n        /*props.push(game.i18n.localize(data.equipped ? \"ARd20.Equipped\" : \"ARd20.Unequipped\"));\r\n        }\r\n    \r\n        // Ability activation properties\r\n        if (data.hasOwnProperty(\"activation\")) {\r\n          props.push(labels.activation + (data.activation?.condition ? ` (${data.activation.condition})` : \"\"), labels.target, labels.range, labels.duration);\r\n        }\r\n    \r\n        // Filter properties and return\r\n        data.properties = props.filter((p) => !!p);\r\n        */\r\n        return data;\r\n    }\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Prepare chat card data for weapon type items.\r\n     * @param {object} data     Copy of item data being use to display the chat message.\r\n     * @param {object} labels   Specially prepared item labels.\r\n     * @param {string[]} props  Existing list of properties to be displayed. *Will be mutated.*\r\n     * @private\r\n     */\r\n    /* -------------------------------------------- */\r\n    /**\r\n     * Place an attack roll using an item (weapon, feat, spell, or equipment)\r\n     * Rely upon the d20Roll logic for the core implementation\r\n     *\r\n     * @param {object} options        Roll options which are configured and provided to the d20Roll function\r\n     * @returns {Promise<Roll|null>}   A Promise which resolves to the created Roll instance\r\n     */\r\n    async rollAttack(mRoll = Boolean(), canMult = Boolean(), options = {}) {\r\n        console.log(canMult);\r\n        const itemData = this.system;\r\n        //@ts-expect-error\r\n        const flags = this.actor.data.flags.ard20 || {};\r\n        let title = `${this.name} - ${game.i18n.localize(\"ARd20.AttackRoll\")}`;\r\n        const { parts, rollData } = this.getAttackToHit();\r\n        const targets = game.user.targets;\r\n        //@ts-expect-error\r\n        if (options.parts?.length > 0) {\r\n            //@ts-expect-error\r\n            parts.push(...options.parts);\r\n        }\r\n        let rollConfig = {\r\n            parts: parts,\r\n            actor: this.actor,\r\n            data: rollData,\r\n            title: title,\r\n            flavor: title,\r\n            dialogOptions: {\r\n                width: 400,\r\n            },\r\n            chatMessage: true,\r\n            options: {\r\n                create: false,\r\n            },\r\n            targetValue: targets,\r\n            canMult: canMult,\r\n            mRoll: mRoll,\r\n        };\r\n        //@ts-expect-error\r\n        rollConfig = mergeObject(rollConfig, options);\r\n        //@ts-expect-error\r\n        const roll = await d20Roll(rollConfig);\r\n        if (roll === false)\r\n            return null;\r\n        return roll;\r\n    }\r\n    rollDamage({ critical = false, event = null, spellLevel = null, versatile = false, options = {}, mRoll = Boolean(), canMult = Boolean(), } = {}) {\r\n        console.log(canMult);\r\n        const iData = this.system;\r\n        const aData = this.actor.system;\r\n        //@ts-expect-error\r\n        const parts = iData.damage.current.parts.map((d) => d[0]);\r\n        //@ts-expect-error\r\n        const damType = iData.damage.current.parts.map((d) => d[1].map((c, ind) => {\r\n            //@ts-expect-error\r\n            let a = game.i18n.localize(CONFIG.ARd20.DamageTypes[c[0]]);\r\n            //@ts-expect-error\r\n            let b = game.i18n.localize(CONFIG.ARd20.DamageSubTypes[c[1]]);\r\n            let obj = { key: ind, label: `${a} ${b}` };\r\n            return obj;\r\n        }));\r\n        //@ts-expect-error\r\n        options.damageType = iData.damage.current.parts.map((d) => d[1]);\r\n        const hasAttack = false;\r\n        const hasDamage = true;\r\n        //@ts-expect-error\r\n        const rollData = this.getRollData(hasAttack, hasDamage);\r\n        const rollConfig = {\r\n            actor: this.actor,\r\n            //@ts-expect-error\r\n            critical: critical ?? event?.altkey ?? false,\r\n            data: rollData,\r\n            event: event,\r\n            parts: parts,\r\n            canMult: canMult,\r\n            damType: damType,\r\n            mRoll: mRoll,\r\n        };\r\n        //@ts-expect-error\r\n        return damageRoll(mergeObject(rollConfig, options));\r\n    }\r\n    /**\r\n     * Update a label to the Item detailing its total to hit bonus.\r\n     * Sources:\r\n     * - item entity's innate attack bonus\r\n     * - item's actor's proficiency bonus if applicable\r\n     * - item's actor's global bonuses to the given item type\r\n     * - item's ammunition if applicable\r\n     *\r\n     * @returns {{rollData: object, parts: string[]}|null}  Data used in the item's Attack roll.\r\n     */\r\n    getAttackToHit() {\r\n        const itemData = this.system;\r\n        const hasAttack = true;\r\n        const hasDamage = false;\r\n        //if (!this.hasAttack || !itemData) return;\r\n        //@ts-expect-error\r\n        const rollData = this.getRollData(hasAttack, hasDamage);\r\n        console.log(\"ROLL DATA\", rollData);\r\n        // Define Roll bonuses\r\n        const parts = [];\r\n        // Include the item's innate attack bonus as the initial value and label\r\n        //@ts-expect-error\r\n        if (itemData.attackBonus) {\r\n            //@ts-expect-error\r\n            parts.push(itemData.attackBonus);\r\n            //@ts-expect-error\r\n            this.labels.toHit = itemData.attackBonus;\r\n        }\r\n        // Take no further action for un-owned items\r\n        if (!this.isOwned)\r\n            return { rollData, parts };\r\n        // Ability score modifier\r\n        parts.push(\"@prof\", \"@mod\");\r\n        /* Add proficiency bonus if an explicit proficiency flag is present or for non-item features\r\n        if ( ![\"weapon\", \"consumable\"].includes(this.data.type)) {\r\n          parts.push(\"@prof\");\r\n          if ( this.system.prof?.hasProficiency ) {\r\n            rollData.prof = this.system.prof.term;\r\n          }\r\n        }\r\n        */\r\n        /* Actor-level global bonus to attack rolls\r\n        const actorBonus = this.actor.system.bonuses?.[itemData.actionType] || {};\r\n        if (actorBonus.attack) parts.push(actorBonus.attack);\r\n        */\r\n        /* One-time bonus provided by consumed ammunition\r\n        if (itemData.consume?.type === \"ammo\" && this.actor.items) {\r\n          const ammoItemData = this.actor.items.get(itemData.consume.target)?.data;\r\n    \r\n          if (ammoItemData) {\r\n            const ammoItemQuantity = ammoitemData.quantity;\r\n            const ammoCanBeConsumed = ammoItemQuantity && ammoItemQuantity - (itemData.consume.amount ?? 0) >= 0;\r\n            const ammoItemAttackBonus = ammoitemData.attackBonus;\r\n            const ammoIsTypeConsumable = ammoItemData.type === \"consumable\" && ammoitemData.consumableType === \"ammo\";\r\n            if (ammoCanBeConsumed && ammoItemAttackBonus && ammoIsTypeConsumable) {\r\n              parts.push(\"@ammo\");\r\n              rollData.ammo = ammoItemAttackBonus;\r\n            }\r\n          }\r\n        }\r\n        */\r\n        // Condense the resulting attack bonus formula into a simplified label\r\n        //@ts-expect-error\r\n        const roll = new Roll(parts.join(\"+\"), rollData);\r\n        //@ts-expect-error\r\n        const formula = simplifyRollFormula(roll.formula);\r\n        //@ts-expect-error\r\n        this.labels.toHit = !/^[+-]/.test(formula) ? `+ ${formula}` : formula;\r\n        // Update labels and return the prepared roll data\r\n        return { rollData, parts };\r\n    }\r\n}\r\n","<script>\r\n  import { getContext } from \"svelte\";\r\n  export let max;\r\n  export let min;\r\n  export let type;\r\n  export let subtype;\r\n  let doc = getContext(\"data\");\r\n  let disabled;\r\n  $: disabled = $doc[`${type}`][`${subtype}`].value === max || $doc[`${type}`][`${subtype}`].value === min;\r\n  function increase(type, subtype) {\r\n    doc.update((store) => {\r\n      store[`${type}`][`${subtype}`].value += 1;\r\n      return store;\r\n    });\r\n  }\r\n  function decrease(type, subtype) {\r\n    doc.update((store) => {\r\n      store[`${type}`][`${subtype}`].value -= 1;\r\n      return store;\r\n    });\r\n  }\r\n</script>\r\n\r\n{#if max}\r\n  <button {disabled} on:click={() => increase(type, subtype)}>+ </button>\r\n{/if}\r\n{#if min}\r\n  <button {disabled} on:click={() => decrease(type, subtype)}>+ </button>\r\n{/if}\r\n\r\n<style>\r\n  button:active {\r\n    transform: translateY(0.1em);\r\n  }\r\n</style>\r\n","<script>\r\n  import ChangeButton from \"./ChangeButton.svelte\";\r\n  export let min;\r\n  export let max;\r\n  export let val;\r\n  export let key;\r\n  export let type;\r\n  export let description;\r\n  export let typeStr;\r\n  function changeDesc(val) {\r\n    if (!val[1].description) return \"\";\r\n    description = val[1].description;\r\n  }\r\n</script>\r\n\r\n<tr>\r\n  <!-- svelte-ignore a11y-mouse-events-have-key-events -->\r\n  <td class={val[1].description} on:mouseover={() => changeDesc(val)}>{val[0]}</td>\r\n  <!-- svelte-ignore a11y-mouse-events-have-key-events -->\r\n  <td class={val[1].description} on:mouseover={() => changeDesc(val)}\r\n    ><ChangeButton type={typeStr} subtype={val[0]} {max} />\r\n  </td>\r\n  {#if val[1].rankName}\r\n  <!-- svelte-ignore a11y-mouse-events-have-key-events -->\r\n    <td class={val[1].description} on:mouseover={() => changeDesc(val)}>{val[1].rankName}</td>\r\n  {:else}\r\n  <!-- svelte-ignore a11y-mouse-events-have-key-events -->\r\n    <td class={val[1].description} on:mouseover={() => changeDesc(val)}>{val[1].value}</td>\r\n  {/if}\r\n  <!-- svelte-ignore a11y-mouse-events-have-key-events -->\r\n  <td class={val[1].description} on:mouseover={() => changeDesc(val)}\r\n    ><ChangeButton type={typeStr} subtype={val[0]} {min} /></td\r\n  >\r\n  {#if val[1].mod}\r\n  <!-- svelte-ignore a11y-mouse-events-have-key-events -->\r\n    <td\r\n      class={val[1].description}\r\n      on:mouseover={() => {\r\n        description = val[1].description;\r\n      }}>{val[1].mod}</td\r\n    >\r\n  {/if}\r\n  {#if key === 0}\r\n    <td class=\"description\" rowspan={Object.values(type).length}>{description}</td>\r\n  {/if}\r\n</tr>\r\n\r\n<style>\r\n  .description {\r\n    max-width: 1em;\r\n  }\r\n  td {\r\n    text-align: center;\r\n    border-right: 1px solid black;\r\n  }\r\n  tr {\r\n    border: 1px solid black;\r\n  }\r\n</style>\r\n","<script>\r\n  import {getContext} from 'svelte'\r\n  import TDvariants from \"./TDvariants.svelte\";\r\n  let data = getContext('data')\r\n  let typeStr = 'attributes'\r\n  $: {\r\n    for (let [key, attr] of Object.entries($data.attributes)) {\r\n      attr.mod = Math.floor((attr.value - 10) / 2);\r\n    }\r\n  }\r\n  let description = \"\";\r\n</script>\r\n\r\n<table>\r\n  <tr>\r\n    <th>Name</th>\r\n    <th>Increase</th>\r\n    <th>Value</th>\r\n    <th>Decrease</th>\r\n    <th>Mod</th>\r\n    <th>Description</th>\r\n  </tr>\r\n  {#each Object.entries($data.attributes) as attr, key}\r\n    <TDvariants type={$data.attributes} {typeStr} val={attr} min={1} max={30} {key} bind:description />\r\n  {/each}\r\n</table>\r\n\r\n<style global>\r\n  table {\r\n    border-collapse: collapse;\r\n  }\r\n  tr {\r\n    border: 1px solid black;\r\n  }\r\n  th {\r\n    text-align: center;\r\n    border-right: 1px solid black;\r\n    padding: 0.2em;\r\n  }\r\n</style>\r\n","<script>\r\n\timport {getContext} from 'svelte'\r\n\timport TDvariants from './TDvariants.svelte'\r\n\tlet doc = getContext('data')\r\n\tconst typeStr='skills'\r\n\tconst rankName = ['untrained','trained','expert','master','legend']\r\n\t$: for( let[key,skill] of Object.entries($doc.skills)){\r\n\t\tskill.rankName=rankName[skill.value]\r\n\t}\r\n</script>\r\n<table>\r\n\t<tr>\r\n\t\t<th>Name</th>\r\n\t\t<th>Increase</th>\r\n\t\t<th>Rank</th>\r\n\t\t<th>Decrease</th>\r\n\t\t<th>Description</th>\r\n\t</tr>\r\n\t{#each Object.entries($doc.skills) as skill,key}\r\n\t\t<TDvariants type={$doc.skills} {typeStr} val={skill} min={0} max={4} {key} description={''}  />\r\n\t{/each}\r\n</table>\r\n<style>\r\n\ttable{\r\n\t\tborder-collapse:collapse\r\n\t}\r\n\ttr{\r\n\t\tborder:1px solid black\r\n\t}\r\n\tth{\r\n\t\ttext-align:center;\r\n\t\tborder-right:1px solid black\r\n\t}\r\n\tth{\r\n\t\tpadding:0.2em\r\n\t}\r\n</style>","<script>\r\n  export let tabs = [];\r\n  export let activeTab;\r\n</script>\r\n<ul>\r\n  {#each tabs as tab}\r\n    <li class={activeTab === tab.id ? \"active\" : \"\"}>\r\n      <span\r\n        on:click={() => {\r\n          activeTab = tab.id;\r\n        }}>{tab.label}</span\r\n      >\r\n    </li>\r\n  {/each}\r\n</ul>\r\n<div class=\"box\">\r\n  {#each tabs as tab}\r\n    {#if tab.id === activeTab}\r\n      <svelte:component this={tab.component} data={tab.data} />\r\n    {/if}\r\n  {/each}\r\n</div>\r\n\r\n<style>\r\n  .box {\r\n    margin-bottom: 10px;\r\n    border: 1px solid #dee2e6;\r\n    border-radius: 0 0 0.5rem 0.5rem;\r\n    border-top: 0;\r\n  }\r\n  ul {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    padding-left: 0;\r\n    margin-bottom: 0;\r\n    list-style: none;\r\n    border-bottom: 1px solid #dee2e6;\r\n  }\r\n  li {\r\n    margin-bottom: -0.1em;\r\n  }\r\n  li:active {\r\n    transform: translateY(0.1em);\r\n  }\r\n\r\n  span {\r\n    border: 1px solid transparent;\r\n    border-top-left-radius: 0.25rem;\r\n    border-top-right-radius: 0.25rem;\r\n    display: block;\r\n    padding: 0.5rem 1rem;\r\n    cursor: pointer;\r\n  }\r\n\r\n  span:hover {\r\n    border-color: #e9ecef #e9ecef #dee2e6;\r\n  }\r\n\r\n  li.active > span {\r\n    color: #495057;\r\n    background-color: #fff;\r\n    border-color: #dee2e6 #dee2e6 #fff;\r\n  }\r\n</style>\r\n","<svelte:options accessors={true} />\r\n\r\n<script>\r\n  import {setContext} from 'svelte'\r\n  import {writable} from 'svelte/store'\r\n  import AttributeComp from \"./Attributes.svelte\";\r\n  import SkillComp from \"./Skills.svelte\";\r\n  import FeatureComp from \"./FeatureComp.svelte\";\r\n  import Tabs from \"./Tabs.svelte\";\r\n  export let document\r\n  let data = writable(document.system)\r\n  setContext('data',data)\r\n  let tabs = [\r\n    { label: \"attributes\", id: \"attributes\", component: AttributeComp},\r\n    { label: \"skills\", id: \"skills\", component: SkillComp},\r\n  ];\r\n  let activeTab = \"attributes\";\r\n  \r\n</script>\r\n\r\n<Tabs {tabs} {activeTab} />","/**\r\n * Manage Active Effect instances through the Actor Sheet via effect control buttons.\r\n * @param {MouseEvent} event      The left-click event on the effect control\r\n * @param {Actor|Item} owner      The owning entity which manages this effect\r\n */\r\nexport function onManageActiveEffect(event, owner) {\r\n    event.preventDefault();\r\n    const a = event.currentTarget;\r\n    //@ts-expect-error\r\n    const li = a.closest(\"li\");\r\n    const effect = li.dataset.effectId ? owner.effects.get(li.dataset.effectId) : null;\r\n    //@ts-expect-error\r\n    switch (a.dataset.action) {\r\n        case \"create\":\r\n            return owner.createEmbeddedDocuments(\"ActiveEffect\", [{\r\n                    label: \"New Effect\",\r\n                    icon: \"icons/svg/aura.svg\",\r\n                    origin: owner.uuid,\r\n                    \"duration.rounds\": li.dataset.effectType === \"temporary\" ? 1 : undefined,\r\n                    disabled: li.dataset.effectType === \"inactive\"\r\n                }]);\r\n        case \"edit\":\r\n            return effect.sheet.render(true);\r\n        case \"delete\":\r\n            return effect.delete();\r\n        case \"toggle\":\r\n            return effect.update({ disabled: !effect.data.disabled });\r\n    }\r\n}\r\n/**\r\n * Prepare the data structure for Active Effects which are currently applied to an Actor or Item.\r\n * @param {ActiveEffect[]} effects    The array of Active Effect instances to prepare sheet data for\r\n * @return {object}                   Data for rendering\r\n */\r\nexport function prepareActiveEffectCategories(effects) {\r\n    // Define effect header categories\r\n    const categories = {\r\n        temporary: {\r\n            type: \"temporary\",\r\n            label: \"Temporary Effects\",\r\n            effects: []\r\n        },\r\n        passive: {\r\n            type: \"passive\",\r\n            label: \"Passive Effects\",\r\n            effects: []\r\n        },\r\n        inactive: {\r\n            type: \"inactive\",\r\n            label: \"Inactive Effects\",\r\n            effects: []\r\n        }\r\n    };\r\n    // Iterate over active effects, classifying them into categories\r\n    for (let e of effects) {\r\n        //@ts-expect-error\r\n        e._getSourceName(); // Trigger a lookup for the source name\r\n        //@ts-expect-error\r\n        if (e.data.disabled)\r\n            categories.inactive.effects.push(e);\r\n        //@ts-expect-error\r\n        else if (e.isTemporary)\r\n            categories.temporary.effects.push(e);\r\n        //@ts-expect-error\r\n        else\r\n            categories.passive.effects.push(e);\r\n    }\r\n    return categories;\r\n}\r\n","import { obj_entries } from \"../../ard20.js\";\r\nimport { ARd20Item } from \"../../documents/item.js\";\r\n//@ts-expect-error\r\nexport class CharacterAdvancement extends FormApplication {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      classes: [\"ard20\"],\r\n      title: \"Character Advancement\",\r\n      template: \"systems/ard20/templates/actor/parts/actor-adv.html\",\r\n      id: \"actor-adv\",\r\n      width: 1000,\r\n      height: \"auto\",\r\n      tabs: [\r\n        {\r\n          navSelector: \".sheet-tabs\",\r\n          contentSelector: \".sheet-body\",\r\n          initial: \"stats\",\r\n        },\r\n      ],\r\n      closeOnSubmit: false,\r\n    });\r\n  }\r\n  async InitilizeData() {\r\n    if (this.form) return;\r\n    const pack = await this.getPacks();\r\n    const folder = this.getFolders();\r\n    const rList = await this.getRacesList(pack, folder);\r\n    const fList = await this.getFeaturesList(pack, folder);\r\n    const actorData = this.object.system;\r\n    const startingData = {\r\n      isReady: duplicate(actorData.isReady),\r\n      attributes: duplicate(actorData.attributes),\r\n      skills: duplicate(actorData.skills),\r\n      xp: duplicate(actorData.advancement.xp),\r\n      profs: duplicate(actorData.proficiencies),\r\n      health: duplicate(actorData.health),\r\n      races: { list: rList, chosen: \"\" },\r\n      count: {\r\n        // counter for skills and feats\r\n        skills: {\r\n          // count skills by their level\r\n          0: 0,\r\n          1: 0,\r\n          2: 0,\r\n          3: 0,\r\n          4: 0,\r\n        },\r\n        feats: {\r\n          // count feats by their source\r\n          mar: 0,\r\n          mag: 0,\r\n          div: 0,\r\n          pri: 0,\r\n          psy: 0,\r\n        },\r\n      },\r\n      content: {\r\n        // descriptions for skills and feats\r\n        skills: {},\r\n        feats: {},\r\n      },\r\n      feats: {\r\n        learned: fList.learnedFeatures,\r\n        awail: fList.temp_feat_list, // array of feats that are available to learn\r\n      },\r\n      allow: {\r\n        attribute: actorData.isReady,\r\n        race: actorData.isReady,\r\n        final: actorData.isReady,\r\n      },\r\n      hover: {\r\n        attribute: \"\",\r\n        skill: \"\",\r\n        race: \"\",\r\n        feat: \"\",\r\n      },\r\n    };\r\n    startingData.xp.get = startingData.isReady || startingData.xp.used !== 0 ? startingData.xp.get : 10000;\r\n    let awailFeats = startingData.feats.awail;\r\n    let name_array = [];\r\n    for (let i of startingData.feats.learned) {\r\n      name_array.push(i.name);\r\n    }\r\n    awailFeats.forEach((v, k) => {\r\n      if (name_array.includes(v.name)) {\r\n        console.log(\"this item is already learned\", awailFeats[k]);\r\n        awailFeats[k] = foundry.utils.deepClone(startingData.feats.learned.filter((item) => item.name === v.name)[0]);\r\n      }\r\n    });\r\n    awailFeats = awailFeats.filter((item) => {\r\n      if (item.type === \"feature\")\r\n        return !name_array.includes(item.name) || item.data.level.current !== item.data.level.max;\r\n    });\r\n    startingData.feats.awail = awailFeats;\r\n    // count skills by rank\r\n    for (let [k, v] of obj_entries(CONFIG.ARd20.Skills)) {\r\n      if (startingData.skills[k].level === 0) {\r\n        startingData.count.skills[0] += 1;\r\n      } else if (startingData.skills[k].level === 1) {\r\n        startingData.count.skills[1] += 1;\r\n      } else if (startingData.skills[k].level === 2) {\r\n        startingData.count.skills[2] += 1;\r\n      }\r\n    }\r\n    // count feats by source\r\n    for (let v of startingData.feats.learned) {\r\n      console.log(v);\r\n      if (v.type === \"feature\")\r\n        v.data.source.value.forEach((val) => {\r\n          console.log(val);\r\n          startingData.count.feats[val] += 1;\r\n        });\r\n    }\r\n    startingData.hover.feat = TextEditor.enrichHTML(startingData.feats.awail[0]?.data.description);\r\n    return startingData;\r\n  }\r\n  async getPacks() {\r\n    let pack_list = []; // array of feats from Compendium\r\n    let pack_name = [];\r\n    for (const key of game.settings.get(\"ard20\", \"feat\").packs) {\r\n      if (game.packs.filter((pack) => pack.metadata.label === key).length !== 0) {\r\n        let feat_list = [];\r\n        feat_list.push(\r\n          Array.from(game.packs.filter((pack) => pack.metadata.label === key && pack.documentName === \"Item\")[0].index)\r\n        );\r\n        feat_list = feat_list.flat();\r\n        for (const feat of feat_list) {\r\n          if (feat instanceof ARd20Item) {\r\n            const new_key = game.packs.filter((pack) => pack.metadata.label === key)[0].metadata.package + \".\" + key;\r\n            const doc = await game.packs.get(new_key).getDocument(feat.id);\r\n            if (doc instanceof ARd20Item) {\r\n              const item = doc.toObject();\r\n              item.data = foundry.utils.deepClone(doc.system);\r\n              pack_list.push(item);\r\n              pack_name.push(item.name);\r\n            }\r\n          }\r\n        }\r\n        pack_list = pack_list.flat();\r\n      }\r\n    }\r\n    return {\r\n      pack_list,\r\n      pack_name,\r\n    };\r\n  }\r\n  getFolders() {\r\n    let folder_list = []; // array of feats from game folders\r\n    let folder_name = [];\r\n    for (let key of game.settings.get(\"ard20\", \"feat\").folders) {\r\n      if (game.folders.filter((folder) => folder.data.name === key).length !== 0) {\r\n        let feat_list = [];\r\n        feat_list.push(\r\n          game.folders.filter((folder) => folder.data.name === key && folder.data.type === \"Item\")[0].contents\r\n        );\r\n        feat_list = feat_list.flat();\r\n        for (let feat of feat_list) {\r\n          if (feat instanceof ARd20Item) {\r\n            console.log(\"item added from folder \", feat);\r\n            const item = feat.toObject();\r\n            item.data = foundry.utils.deepClone(feat.system);\r\n            folder_list.push(item);\r\n            folder_name.push(item.name);\r\n          }\r\n        }\r\n        folder_list = folder_list.flat();\r\n      }\r\n    }\r\n    return {\r\n      folder_list,\r\n      folder_name,\r\n    };\r\n  }\r\n  async getRacesList(pack, folder) {\r\n    const pack_list = pack.pack_list;\r\n    const pack_name = pack.pack_name;\r\n    const folder_list = folder.folder_list;\r\n    let race_pack_list = [];\r\n    let race_folder_list = [];\r\n    pack_list.forEach((item) => {\r\n      if (item.type === \"race\") {\r\n        let raceItem = { ...item, chosen: false };\r\n        race_pack_list.push(raceItem);\r\n      }\r\n    });\r\n    folder_list.forEach((item) => {\r\n      if (item.type === \"race\") {\r\n        let raceItem = { ...item, chosen: false };\r\n        race_folder_list.push(raceItem);\r\n      }\r\n    });\r\n    return race_pack_list.concat(race_folder_list.filter((item) => !pack_name.includes(item.name)));\r\n  }\r\n  async getFeaturesList(pack, folder) {\r\n    const pack_list = pack.pack_list;\r\n    const pack_name = pack.pack_name;\r\n    const folder_list = folder.folder_list;\r\n    let feat_pack_list = [];\r\n    pack_list.forEach((item) => {\r\n      if (item.type === \"feature\") {\r\n        let FeatureItem = { ...item, currentXP: 0, isEq: false, isXP: false };\r\n        feat_pack_list.push(FeatureItem);\r\n      }\r\n    });\r\n    let feat_folder_list = [];\r\n    folder_list.forEach((item) => {\r\n      if (item.type === \"feature\") {\r\n        let FeatureItem = { ...item, currentXP: 0, isEq: false, isXP: false };\r\n        feat_folder_list.push(FeatureItem);\r\n      }\r\n    });\r\n    let temp_feat_list = feat_pack_list.concat(feat_folder_list.filter((item) => !pack_name.includes(item.name)));\r\n    let learnedFeatures = [];\r\n    this.object.itemTypes.feature.forEach((item) => {\r\n      if (item.data.type === \"feature\") {\r\n        let FeatureItem = { ...item.data, currentXP: 0, isEq: false };\r\n        learnedFeatures.push(FeatureItem);\r\n      }\r\n    });\r\n    return { temp_feat_list, learnedFeatures };\r\n  }\r\n  async getData() {\r\n    this.options.data = !this.form ? await this.InitilizeData() : this.options.data;\r\n    const templateData = this.options.data;\r\n    const count = templateData.count;\r\n    const attributes = templateData.attributes;\r\n    const xp = templateData.xp;\r\n    const raceList = templateData.races.list;\r\n    const raceChosen = templateData.races.chosen;\r\n    const isReady = templateData.isReady;\r\n    const skills = templateData.skills;\r\n    const featsAwail = templateData.feats.awail;\r\n    const featsLearned = templateData.feats.learned;\r\n    const health = templateData.health;\r\n    count.feats.all = 0;\r\n    count.feats.all = Object.values(count.feats).reduce(function (a, b) {\r\n      return a + b;\r\n    }, 0);\r\n    /*\r\n     * Calculate attributes' modifiers and xp cost\r\n     */\r\n    for (let [k, v] of obj_entries(CONFIG.ARd20.Attributes)) {\r\n      const race_abil = raceList.filter((race) => race.chosen === true)?.[0]?.data.bonus.attributes[k].value ?? 0;\r\n      attributes[k].mod = Math.floor((attributes[k].value - 10) / 2);\r\n      attributes[k].xp = CONFIG.ARd20.AbilXP[attributes[k].value - 5];\r\n      attributes[k].isEq = attributes[k].value === this.object.system.attributes[k].value;\r\n      attributes[k].isXP = xp.get < attributes[k].xp;\r\n      attributes[k].total = isReady ? attributes[k].value : attributes[k].value + race_abil;\r\n      attributes[k].mod = Math.floor((attributes[k].total - 10) / 2);\r\n    }\r\n    /*\r\n     * Calculate skills' xp cost\r\n     */\r\n    for (let [k, v] of obj_entries(CONFIG.ARd20.Skills)) {\r\n      templateData.skills[k].rankName =\r\n        game.i18n.localize(CONFIG.ARd20.Rank[templateData.skills[k].level]) ??\r\n        CONFIG.ARd20.Rank[templateData.skills[k].level];\r\n      templateData.skills[k].xp =\r\n        templateData.skills[k].level < 2\r\n          ? CONFIG.ARd20.SkillXP[templateData.skills[k].level][\r\n              templateData.count.skills[templateData.skills[k].level + 1]\r\n            ]\r\n          : false;\r\n      templateData.skills[k].isEq = templateData.skills[k].level === this.object.system.skills[k].level;\r\n      templateData.skills[k].isXP = templateData.xp.get < templateData.skills[k].xp || templateData.skills[k].level > 1;\r\n    }\r\n    for (let v of templateData.profs.weapon) {\r\n      //@ts-expect-error\r\n      v.value_hover = game.i18n.localize(CONFIG.ARd20.Rank[v.value]) ?? CONFIG.ARd20.Rank[v.value];\r\n    }\r\n    /*\r\n     * Calculate features cost and their availattribute\r\n     */\r\n    featsAwail.forEach((object) => {\r\n      if (object.type === \"feature\") {\r\n        let pass = [];\r\n        object.pass = [];\r\n        let allCount = templateData.count.feats.all;\r\n        let featCount = 0;\r\n        object.data.source.value.forEach((val) => (featCount += templateData.count.feats[val]));\r\n        for (let i = object.data.level.initial; i < object.data.level.max; i++) {\r\n          object.data.xp.AdvancedCost[i] = object.data.xp.basicCost[i]\r\n            ? Math.ceil((object.data.xp.basicCost[i] * (1 + 0.01 * (allCount - featCount))) / 5) * 5\r\n            : 0;\r\n        }\r\n        object.currentXP = object.data.xp.AdvancedCost[object.data.level.initial];\r\n        object.isEq = object.data.level.initial === object.data.level.current || object.data.level.initial === 0;\r\n        object.isXP =\r\n          object.data.level.initial === object.data.level.max ||\r\n          object.data.xp.AdvancedCost[object.data.level.initial] > templateData.xp.get;\r\n        object.data.req.values.forEach((r) => {\r\n          switch (r.type) {\r\n            case \"attribute\": //check if character's attribute is equal or higher than value entered in feature requirements\r\n              //@ts-expect-error\r\n              r.pass.forEach((_item, index) => (r.pass[index] = r.input[index] <= attributes[r.value].total));\r\n              break;\r\n            case \"skill\": //check if character's skill rank is equal or higher than value entered in feature requirements\r\n              //@ts-expect-error\r\n              r.pass.forEach((_item, index) => (r.pass[index] = r.input[index] <= skills[r.value].level));\r\n              break;\r\n            case \"feat\": //check if character has features (and their level is equal or higher) that listed in feature requirements\r\n              if (featsAwail.filter((item) => item.name === r.name)?.[0] !== undefined) {\r\n                const featLevel = featsAwail.filter((item) => item.name === r.name)[0].data.level.initial;\r\n                r.pass.forEach((_item, index) => (r.pass[index] = r.input[index] <= featLevel));\r\n              } else if (featsLearned.filter((item) => item.name === r.name)?.[0] !== undefined) {\r\n                const featLevel = featsLearned.filter((item) => item.name === r.name)[0].data.level.initial;\r\n                r.pass.forEach((_item, index) => (r.pass[index] = r.input[index] <= featLevel));\r\n              }\r\n              break;\r\n          }\r\n          pass.push(r.pass);\r\n        });\r\n        object.pass = [];\r\n        /*\r\n         * Check the custom logic in feature requirements. For example \"Strength 15 OR Arcana Basic\"\r\n         */\r\n        for (let i = 0; i <= object.data.level.initial; i++) {\r\n          if (i === object.data.level.max || pass.length === 0) break;\r\n          let exp = object.data.req.logic[i];\r\n          let lev_array = exp.match(/\\d*/g).filter((item) => item !== \"\");\r\n          console.log(lev_array);\r\n          let f = {};\r\n          lev_array.forEach((item) => {\r\n            exp = exp.replace(item, `c${item}`);\r\n            f[\"c\" + item] = pass[parseInt(item) - 1][i];\r\n          });\r\n          //@ts-expect-error\r\n          let filter = filtrex.compileExpression(exp);\r\n          object.pass[i] = Boolean(filter(f));\r\n        }\r\n        object.isXP = object.pass[object.data.level.initial] || object.pass.length === 0 ? object.isXP : true;\r\n      }\r\n    });\r\n    /*\r\n     * Calculate starting HP based on character's CON and race\r\n     */\r\n    raceList.forEach((race) => {\r\n      race.chosen = raceChosen === race._id ? true : false;\r\n    });\r\n    let raceHP = 0;\r\n    raceList.forEach((race) => {\r\n      if (race._id === raceChosen) {\r\n        raceHP = race.data.health;\r\n      }\r\n    });\r\n    health.max = attributes.con.value + raceHP;\r\n    // At character creation, check all conditions\r\n    if (!this.object.system.isReady) {\r\n      let abil_sum = 0;\r\n      for (let [key, abil] of obj_entries(templateData.attributes)) {\r\n        abil_sum += abil.value;\r\n      }\r\n      templateData.allow.attribute = abil_sum >= 60 && abil_sum <= 80 ? true : false;\r\n      templateData.allow.race = Boolean(templateData.races.chosen) ? true : false;\r\n      let allow_list = [];\r\n      for (let [key, item] of obj_entries(templateData.allow)) {\r\n        if (key === \"final\") {\r\n          continue;\r\n        }\r\n        allow_list.push(item);\r\n      }\r\n      templateData.allow.final = !allow_list.includes(false) || templateData.isReady ? true : false;\r\n    }\r\n    /*\r\n     * Final Template Data\r\n     */\r\n    console.log(this.form);\r\n    console.log(templateData);\r\n    return templateData;\r\n  }\r\n  activateListeners(html) {\r\n    super.activateListeners(html);\r\n    html.find(\".change\").on(\"click\", this._onChange.bind(this));\r\n    html.find(\"td:not(.description)\").on(\"mouseover\", this._onHover.bind(this));\r\n  }\r\n  //@ts-expect-error\r\n  _onChange(event) {\r\n    const button = event.currentTarget;\r\n    const data = this.options.data;\r\n    switch (button.dataset.type) {\r\n      case \"attribute\":\r\n        switch (button.dataset.action) {\r\n          case \"plus\":\r\n            //@ts-expect-error\r\n            data.attributes[button.dataset.key].value += 1;\r\n            //@ts-expect-error\r\n            data.xp.get -= data.attributes[button.dataset.key].xp;\r\n            //@ts-expect-error\r\n            data.xp.used += data.attributes[button.dataset.key].xp;\r\n            break;\r\n          case \"minus\":\r\n            //@ts-expect-error\r\n            data.attributes[button.dataset.key].value -= 1;\r\n            data.xp.get +=\r\n              //@ts-expect-error\r\n              CONFIG.ARd20.AbilXP[data.attributes[button.dataset.key].value - 5] ??\r\n              //@ts-expect-error\r\n              CONFIG.ARd20.AbilXP[data.attributes[button.dataset.key].value - 5];\r\n            data.xp.used -=\r\n              //@ts-expect-error\r\n              CONFIG.ARd20.AbilXP[data.attributes[button.dataset.key].value - 5] ??\r\n              //@ts-expect-error\r\n              CONFIG.ARd20.AbilXP[data.attributes[button.dataset.key].value - 5];\r\n            break;\r\n        }\r\n        break;\r\n      case \"skill\":\r\n        switch (button.dataset.action) {\r\n          case \"plus\":\r\n            //@ts-expect-error\r\n            data.skills[button.dataset.key].level += 1;\r\n            //@ts-expect-error\r\n            data.xp.get -= data.skills[button.dataset.key].xp;\r\n            //@ts-expect-error\r\n            data.xp.used += data.skills[button.dataset.key].xp;\r\n            //@ts-expect-error\r\n            data.count.skills[data.skills[button.dataset.key].level] += 1;\r\n            break;\r\n          case \"minus\":\r\n            //@ts-expect-error\r\n            data.skills[button.dataset.key].level -= 1;\r\n            //@ts-expect-error\r\n            data.count.skills[data.skills[button.dataset.key].level + 1] -= 1;\r\n            data.xp.get +=\r\n              //@ts-expect-error\r\n              CONFIG.ARd20.SkillXP[data.skills[button.dataset.key].level][\r\n                //@ts-expect-error\r\n                data.count.skills[data.skills[button.dataset.key].level + 1]\r\n              ];\r\n            data.xp.used -=\r\n              //@ts-expect-error\r\n              CONFIG.ARd20.SkillXP[data.skills[button.dataset.key].level][\r\n                //@ts-expect-error\r\n                data.count.skills[data.skills[button.dataset.key].level + 1]\r\n              ];\r\n            break;\r\n        }\r\n        break;\r\n      case \"prof\":\r\n        switch (button.dataset.action) {\r\n          case \"plus\":\r\n            data.profs.weapon[button.dataset.key].value += 1;\r\n            data.count.feats.mar += 1;\r\n            break;\r\n          case \"minus\":\r\n            data.profs.weapon[button.dataset.key].value -= 1;\r\n            data.count.feats.mar -= 1;\r\n            break;\r\n        }\r\n        break;\r\n      case \"feat\":\r\n        switch (button.dataset.action) {\r\n          case \"plus\":\r\n            data.feats.awail[button.dataset.key].data.source.value.forEach(\r\n              (val) => (data.count.feats[val] += data.feats.awail[button.dataset.key].data.level.initial === 0 ? 1 : 0)\r\n            );\r\n            data.xp.get -=\r\n              data.feats.awail[button.dataset.key].data.xp.AdvancedCost[\r\n                data.feats.awail[button.dataset.key].data.level.initial\r\n              ];\r\n            data.xp.used +=\r\n              data.feats.awail[button.dataset.key].data.xp.AdvancedCost[\r\n                data.feats.awail[button.dataset.key].data.level.initial\r\n              ];\r\n            data.feats.awail[button.dataset.key].data.level.initial += 1;\r\n            break;\r\n          case \"minus\":\r\n            data.feats.awail[button.dataset.key].data.level.initial -= 1;\r\n            data.feats.awail[button.dataset.key].data.source.value.forEach(\r\n              (val) => (data.count.feats[val] -= data.feats.awail[button.dataset.key].data.level.initial === 0 ? 1 : 0)\r\n            );\r\n            data.xp.get +=\r\n              data.feats.awail[button.dataset.key].data.xp.AdvancedCost[\r\n                data.feats.awail[button.dataset.key].data.level.initial\r\n              ];\r\n            data.xp.used -=\r\n              data.feats.awail[button.dataset.key].data.xp.AdvancedCost[\r\n                data.feats.awail[button.dataset.key].data.level.initial\r\n              ];\r\n            break;\r\n        }\r\n        break;\r\n    }\r\n    this.render();\r\n  }\r\n  //@ts-expect-error\r\n  _onChangeInput(event) {\r\n    super._onChangeInput(event);\r\n    const data = this.options.data;\r\n    const k = parseInt(event.currentTarget.dataset.key);\r\n    data.races.list.forEach((race, key) => {\r\n      data.races.list[key].chosen = key === k ? true : false;\r\n      data.races.chosen = data.races.list[key].chosen ? race._id : data.races.chosen;\r\n    });\r\n    this.render();\r\n  }\r\n  //@ts-expect-error\r\n  _onHover(event) {\r\n    event.preventDefault();\r\n    const data = this.options.data;\r\n    const element = event.currentTarget;\r\n    const table = element.closest(\"div.tab\");\r\n    const tr = element.closest(\"tr\");\r\n    const trDOM = tr.querySelectorAll(\"td:not(.description)\");\r\n    const tdDesc = table.querySelector(\"td.description\");\r\n    const bColor = window.getComputedStyle(element).getPropertyValue(\"background-color\");\r\n    tdDesc.style[\"background-color\"] = bColor;\r\n    //@ts-expect-error\r\n    trDOM?.forEach((td) => {\r\n      td.classList.toggle(\"chosen\", event.type == \"mouseenter\");\r\n      if (td.nextElementSibling === null || td.nextElementSibling.classList[0] === \"description\") {\r\n        td.classList.toggle(\"last\", event.type == \"mouseenter\");\r\n      }\r\n    });\r\n    tr.nextElementSibling\r\n      ?.querySelectorAll(\"td:not(.description)\")\r\n      //@ts-expect-error\r\n      .forEach((td) => td.classList.toggle(\"under-chosen\", event.type == \"mouseenter\"));\r\n    tr.previousElementSibling\r\n      ?.querySelectorAll(\"th:not(.description)\")\r\n      //@ts-expect-error\r\n      .forEach((th) => th.classList.toggle(\"over-chosen\", event.type == \"mouseenter\"));\r\n    tr.previousElementSibling\r\n      ?.querySelectorAll(\"td:not(.description)\")\r\n      //@ts-expect-error\r\n      .forEach((td) => td.classList.toggle(\"over-chosen\", event.type == \"mouseenter\"));\r\n    const type = table.dataset.tab;\r\n    if (type !== \"feats\") return;\r\n    const key = tr.dataset.key;\r\n    const hover_desc = TextEditor.enrichHTML(data.feats.awail[key].data.description);\r\n    if (hover_desc === data.hover.feat) return;\r\n    data.hover.feat = hover_desc;\r\n    this.render();\r\n  }\r\n  async _updateObject(_event, formData) {\r\n    let updateData = expandObject(formData);\r\n    const actor = this.object;\r\n    const data = this.options.data;\r\n    this.render();\r\n    const obj = {};\r\n    for (let [key, abil] of obj_entries(data.attributes)) {\r\n      obj[`data.attributes.${key}.value`] = data.attributes[key].total;\r\n    }\r\n    obj[\"data.health.max\"] = data.health.max;\r\n    if (data.isReady) {\r\n      obj[\"data.advancement.xp\"] = updateData.xp;\r\n    }\r\n    obj[\"data.skills\"] = updateData.skills;\r\n    obj[\"data.profs\"] = updateData.profs;\r\n    obj[\"data.isReady\"] = data.allow.final;\r\n    console.log(obj);\r\n    const feats_data = {\r\n      new: [],\r\n      exist: [],\r\n    };\r\n    const feats = data.feats.awail.filter((item) => item.data.level.initial > item.data.level.current);\r\n    feats.forEach((awItem, _index) => {\r\n      if (data.feats.learned.length > 0) {\r\n        data.feats.learned.forEach((learnedItem, _index) => {\r\n          if (awItem._id === learnedItem._id) {\r\n            feats_data.exist.push(awItem);\r\n          } else {\r\n            feats_data.new.push(awItem);\r\n          }\r\n        });\r\n      } else {\r\n        feats_data.new.push(awItem);\r\n      }\r\n    });\r\n    let pass = [];\r\n    feats_data.exist.forEach((item) => {\r\n      //@ts-expect-error\r\n      pass.push(item.pass.slice(0, item.pass.length - 1));\r\n    });\r\n    feats_data.new.forEach((item) => {\r\n      //@ts-expect-error\r\n      pass.push(item.pass.slice(0, item.pass.length - 1));\r\n    });\r\n    pass = pass.flat();\r\n    console.log(pass);\r\n    if (!data.isReady && !data.allow.final) {\r\n      ui.notifications.error(`Something not ready for your character to be created. Check the list`);\r\n    } else if (pass.includes(false)) {\r\n      ui.notifications.error(`Some changes in your features do not comply with the requirements`);\r\n    } else {\r\n      await actor.update(obj);\r\n      if (actor.itemTypes.race.length === 0) {\r\n        let race_list = this.options.data.races.list.filter((race) => race.chosen === true);\r\n        //@ts-expect-error\r\n        await actor.createEmbeddedDocuments(\"Item\", race_list);\r\n      }\r\n      if (feats_data.exist.length > 0) {\r\n        await actor.updateEmbeddedDocuments(\r\n          \"Item\",\r\n          feats_data.exist.map((item) => ({\r\n            _id: item._id,\r\n            \"data.level.initial\": item.data.level.initial,\r\n          }))\r\n        );\r\n      }\r\n      if (feats_data.new.length > 0) {\r\n        //@ts-expect-error\r\n        await actor.createEmbeddedDocuments(\"Item\", feats_data.new);\r\n      }\r\n      this.close();\r\n    }\r\n  }\r\n}\r\n","import { TJSDialog } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\nimport CharacterAdvancementShell from \"../helpers/Character Advancement/cha-adv-shell.svelte\";\r\nimport { onManageActiveEffect, prepareActiveEffectCategories } from \"../helpers/effects.js\";\r\nimport { CharacterAdvancement } from \"../helpers/Character Advancement/cha-adv\";\r\nimport { getValues, obj_entries } from \"../ard20.js\";\r\n/**\r\n * Extend the basic ActorSheet with some very simple modifications\r\n * @extends {ActorSheet}\r\n */\r\nexport class ARd20ActorSheet extends ActorSheet {\r\n  /** @override */\r\n  static get defaultOptions() {\r\n    return mergeObject(super.defaultOptions, {\r\n      classes: [\"ard20\", \"sheet\", \"actor\"],\r\n      template: \"systems/ard20/templates/actor/actor-sheet.html\",\r\n      width: 600,\r\n      height: 600,\r\n      tabs: [{ navSelector: \".sheet-tabs\", contentSelector: \".sheet-body\", initial: \"main\" }],\r\n    });\r\n  }\r\n  /** @override */\r\n  get template() {\r\n    return `systems/ard20/templates/actor/actor-${this.actor.type}-sheet.html`;\r\n  }\r\n  /* -------------------------------------------- */\r\n  /** @override */\r\n  getData() {\r\n    // Retrieve the data structure from the base sheet. You can inspect or log\r\n    // the context variable to see the structure, but some key properties for\r\n    // sheets are the actor object, the data object, whether or not it's\r\n    // editable, the items array, and the effects array.\r\n    const context = super.getData();\r\n    // Use a safe clone of the actor data for further operations.\r\n    const actorData = this.actor;\r\n    // Add the actor's data to context.data for easier access, as well as flags.\r\n    //@ts-expect-error\r\n    context.data = actorData.system;\r\n    //@ts-expect-error\r\n    context.flags = actorData.flags;\r\n    //@ts-expect-error\r\n    context.config = CONFIG.ARd20;\r\n    //@ts-expect-error\r\n    context.isGM = game.user.isGM;\r\n    console.log(context)\r\n    // Prepare character data and items.\r\n    if (actorData.type === \"character\") {\r\n      //@ts-expect-error\r\n      this._prepareItems(context);\r\n      this._prepareCharacterData(context.data);\r\n    }\r\n    // Prepare NPC data and items.\r\n    //@ts-expect-error\r\n    if (actorData.type === \"npc\") {\r\n      //@ts-expect-error\r\n      this._prepareItems(context);\r\n    }\r\n    // Add roll data for TinyMCE editors.\r\n    //@ts-expect-error\r\n    context.rollData = context.actor.getRollData();\r\n    // Prepare active effects\r\n    //@ts-expect-error\r\n    context.effects = prepareActiveEffectCategories(this.actor.effects);\r\n    return context;\r\n  }\r\n  /**\r\n   * Organize and classify Items for Character sheets.\r\n   *\r\n   * @param {Object} actorData The actor to prepare.\r\n   *\r\n   * @return {undefined}\r\n   */\r\n  //@ts-expect-error\r\n  _prepareCharacterData(context) {\r\n    // Handle ability scores.\r\n    for (let [k, v] of Object.entries(context.attributes)) {\r\n      //@ts-expect-error\r\n      v.label = game.i18n.localize(getValues(CONFIG.ARd20.Attributes, k)) ?? k;\r\n    }\r\n    for (let [k, v] of Object.entries(context.skills)) {\r\n      //@ts-expect-error\r\n      v.name = game.i18n.localize(getValues(CONFIG.ARd20.Skills, k)) ?? k;\r\n      v.rank_name = game.i18n.localize(getValues(CONFIG.ARd20.Rank, v.rank)) ?? v.rank;\r\n    }\r\n  }\r\n  /**\r\n   * Organize and classify Items for Character sheets.\r\n   *\r\n   * @param {Object} actorData The actor to prepare.\r\n   *\r\n   * @return {undefined}\r\n   */\r\n  _prepareItems(context) {\r\n    // Initialize containers.\r\n    const gear = [];\r\n    const features = [];\r\n    const weapons = [];\r\n    const armor = [];\r\n    const spells = {\r\n      0: [],\r\n      1: [],\r\n      2: [],\r\n      3: [],\r\n      4: [],\r\n      5: [],\r\n      6: [],\r\n      7: [],\r\n      8: [],\r\n      9: [],\r\n    };\r\n    // Iterate through items, allocating to containers\r\n    for (let i of context.items) {\r\n      //@ts-expect-error\r\n      i.img = i.img || DEFAULT_TOKEN;\r\n      // Append to gear.\r\n      if (i.type === \"item\") {\r\n        gear.push(i);\r\n      }\r\n      // Append to features.\r\n      else if (i.type === \"feature\") {\r\n        features.push(i);\r\n      }\r\n      // Append to spells.\r\n      else if (i.type === \"spell\") {\r\n        //@ts-expect-error\r\n        if (i.spellLevel != undefined) {\r\n          //@ts-expect-error\r\n          spells[i.spellLevel].push(i);\r\n        }\r\n      } else if (i.type === \"armor\" || i.type === \"weapon\") {\r\n        const isActive = getProperty(i.data, \"equipped\");\r\n        //@ts-expect-error\r\n        i.toggleClass = isActive ? \"active\" : \"\";\r\n        //@ts-expect-error\r\n        i.toggleTitle = game.i18n.localize(isActive ? \"ARd20.Equipped\" : \"ARd20.Unequipped\");\r\n        //@ts-expect-error\r\n        i.equipped = !isActive;\r\n        if (i.type === \"armor\") armor.push(i);\r\n        else weapons.push(i);\r\n      }\r\n    }\r\n    // Assign and return\r\n    //@ts-expect-error\r\n    context.gear = gear;\r\n    //@ts-expect-error\r\n    context.features = features;\r\n    //@ts-expect-error\r\n    context.spells = spells;\r\n    //@ts-expect-error\r\n    context.weapons = weapons;\r\n    //@ts-expect-error\r\n    context.armor = armor;\r\n  }\r\n  /* -------------------------------------------- */\r\n  /** @override */\r\n  activateListeners(html) {\r\n    super.activateListeners(html);\r\n    //@ts-expect-error\r\n    $(\".select2\", html).select2();\r\n    // Render the item sheet for viewing/editing prior to the editable check.\r\n    html.find(\".item-toggle\").click(this._onToggleItem.bind(this));\r\n    html.find(\".item-edit\").click((ev) => {\r\n      const li = $(ev.currentTarget).parents(\".item\");\r\n      const item = this.actor.items.get(li.data(\"itemId\"));\r\n      item.sheet.render(true);\r\n    });\r\n    // -------------------------------------------------------------\r\n    // Everything below here is only needed if the sheet is editable\r\n    if (!this.isEditable) return;\r\n    // Add Inventory Item\r\n    html.find(\".item-create\").click(this._onItemCreate.bind(this));\r\n    // Delete Inventory Item\r\n    html.find(\".item-delete\").click((ev) => {\r\n      const li = $(ev.currentTarget).parents(\".item\");\r\n      const item = this.actor.items.get(li.data(\"itemId\"));\r\n      item.delete();\r\n      li.slideUp(200, () => this.render(false));\r\n    });\r\n    // Active Effect management\r\n    html.find(\".effect-control\").click((ev) => onManageActiveEffect(ev, this.actor));\r\n    //roll abilities and skills\r\n    html.find(\".ability-name\").click(this._onRollAbilityTest.bind(this));\r\n    html.find(\".skill-name\").click(this._onRollSkillCheck.bind(this));\r\n    //open \"character advancement\" window\r\n    html.find(\".config-button\").click(this._OnAdvanceMenu.bind(this));\r\n    //item's roll\r\n    html.find(\".item-roll\").click(this._onItemRoll.bind(this));\r\n    // Drag events for macros.\r\n    if (this.actor.isOwner) {\r\n      let handler = (ev) => this._onDragStart(ev);\r\n      html.find(\"li.item\").each((i, li) => {\r\n        if (li.classList.contains(\"inventory-header\")) return;\r\n        li.setAttribute(\"draggable\", \"true\");\r\n        li.addEventListener(\"dragstart\", handler, false);\r\n      });\r\n    }\r\n  }\r\n  /**\r\n   * Open @class CharacterAdvancement\r\n   */\r\n  _OnAdvanceMenu(event) {\r\n    event.preventDefault();\r\n    const button = event.currentTarget;\r\n    let app;\r\n    console.log(this.object)\r\n    //@ts-ignore\r\n    switch (button.dataset?.action) {\r\n      case \"adv\":\r\n        const dialogOptions = {\r\n          title: \"Character Advancement\",\r\n          modal: true,\r\n          draggable: false,\r\n          zIndex:101,\r\n          id:\"cha-adv\",\r\n          content: {\r\n            class: CharacterAdvancementShell,\r\n            props: {\r\n              document: this.object,\r\n            },\r\n          },\r\n        };\r\n        new TJSDialog(dialogOptions).render(true, { focus: true });\r\n        //app = new CharacterAdvancement(this.object);\r\n        break;\r\n    }\r\n    //app?.render(true);\r\n  }\r\n  /**\r\n   * Change eqquiped item or not by toggling it on sheet\r\n   */\r\n  _onToggleItem(event) {\r\n    event.preventDefault();\r\n    //@ts-ignore\r\n    const itemid = event.currentTarget.closest(\".item\").dataset.itemId;\r\n    const item = this.actor.items.get(itemid);\r\n    //const attr = item.data.type === \"spell\" ? \"data.preparation.prepared\" : \"data.equipped\";\r\n    const attr = \"data.equipped\";\r\n    return item.update({ [attr]: !getProperty(item.system, attr) });\r\n  }\r\n  _onRollAbilityTest(event) {\r\n    event.preventDefault();\r\n    //@ts-ignore\r\n    let ability = event.currentTarget.parentElement.dataset.ability;\r\n    return this.actor.rollAbilityTest(ability, { event: event });\r\n  }\r\n  _onRollSkillCheck(event) {\r\n    event.preventDefault();\r\n    //@ts-ignore\r\n    let skill = event.currentTarget.parentElement.dataset.skill;\r\n    return this.actor.rollSkill(skill, { event: event });\r\n  }\r\n  _onItemRoll(event) {\r\n    event.preventDefault();\r\n    console.log(\"БРОСОК\");\r\n    //@ts-ignore\r\n    const id = event.currentTarget.closest(\".item\").dataset.itemId;\r\n    const item = this.actor.items.get(id);\r\n    const hasAttack = item.system.hasAttack;\r\n    const hasDamage = item.system.hasDamage;\r\n    //@ts-expect-error\r\n    if (item) return item.roll({ hasAttack, hasDamage });\r\n  }\r\n  /**\r\n   * Handle creating a new Owned Item for the actor using initial data defined in the HTML dataset\r\n   * @param {Event} event   The originating click event\r\n   * @private\r\n   */\r\n  async _onItemCreate(event) {\r\n    event.preventDefault();\r\n    const header = event.currentTarget;\r\n    // Get the type of item to create.\r\n    //@ts-ignore\r\n    const type = header.dataset.type;\r\n    // Grab any data associated with this control.\r\n    //@ts-ignore\r\n    const data = duplicate(header.dataset);\r\n    // Initialize a default name.\r\n    const name = `New ${type.capitalize()}`;\r\n    // Prepare the item object.\r\n    const itemData = {\r\n      name: name,\r\n      type: type,\r\n      data: data,\r\n    };\r\n    // Remove the type from the dataset since it's in the itemData.type prop.\r\n    delete itemData[\"type\"];\r\n    // Finally, create the item!\r\n    return await Item.create(itemData, { parent: this.actor });\r\n  }\r\n  /**\r\n   * Handle clickable rolls.\r\n   * @param {Event} event   The originating click event\r\n   * @private\r\n   */\r\n  _onRoll(event) {\r\n    event.preventDefault();\r\n    const element = event.currentTarget;\r\n    //@ts-expect-error\r\n    const dataset = element.dataset;\r\n    // Handle item rolls.\r\n    if (dataset.rollType) {\r\n      if (dataset.rollType == \"item\") {\r\n        //@ts-ignore\r\n        const itemid = element.closest(\".item\").dataset.itemId;\r\n        const item = this.actor.items.get(itemid);\r\n        //@ts-expect-error\r\n        if (item) return item.roll();\r\n      }\r\n      /*else if (dataset.rollType==='weapon'){\r\n              const itemid = element.closest(\".item\").dataset.itemId\r\n              const item = this.actor.items.get(itemid)\r\n              if (item) return item.DamageRoll()\r\n            }*/\r\n    }\r\n  }\r\n  /**\r\n   * _onDrop method with\r\n   */\r\n  async _onDrop(event) {\r\n    if (!game.user.isGM) {\r\n      ui.notifications.error(\"you don't have permissions to add documents to this actor manually\");\r\n      return;\r\n    }\r\n    // Try to extract the data\r\n    let data;\r\n    try {\r\n      data = JSON.parse(event.dataTransfer.getData(\"text/plain\"));\r\n    } catch (err) {\r\n      return false;\r\n    }\r\n    const actor = this.actor;\r\n    /**\r\n     * A hook event that fires when some useful data is dropped onto an ActorSheet.\r\n     * @function dropActorSheetData\r\n     * @memberof hookEvents\r\n     * @param {Actor} actor      The Actor\r\n     * @param {ActorSheet} sheet The ActorSheet application\r\n     * @param {object} data      The data that has been dropped onto the sheet\r\n     */\r\n    const allowed = Hooks.call(\"dropActorSheetData\", actor, this, data);\r\n    if (allowed === false) return;\r\n    // Handle different data types\r\n    switch (data.type) {\r\n      case \"ActiveEffect\":\r\n        return this._onDropActiveEffect(event, data);\r\n      case \"Actor\":\r\n        return this._onDropActor(event, data);\r\n      case \"Item\":\r\n        return this._onDropItem(event, data);\r\n      case \"Folder\":\r\n        return this._onDropFolder(event, data);\r\n    }\r\n  }\r\n}\r\n","import { getValues, obj_entries } from \"../ard20.js\";\r\nimport { ARd20Item } from \"../documents/item.js\";\r\n//@ts-expect-error\r\nexport class FeatRequirements extends FormApplication {\r\n    static get defaultOptions() {\r\n        return foundry.utils.mergeObject(super.defaultOptions, {\r\n            classes: [\"ard20\"],\r\n            title: \"Feature Requirements\",\r\n            template: \"systems/ard20/templates/app/feat_req.hbs\",\r\n            id: \"feat_req\",\r\n            width: 800,\r\n            height: \"auto\",\r\n        });\r\n    }\r\n    async getData() {\r\n        this.options.data = !this.form ? (await this.InitializeData()) : this.options.data;\r\n        //create easier acces to templateData\r\n        const templateData = this.options.data;\r\n        const req = templateData.req;\r\n        const reqValues = req.values;\r\n        const reqLogic = req.logic;\r\n        const data = templateData.data;\r\n        let formApp = templateData.formApp;\r\n        console.log(\"data created\");\r\n        //creating array with all possible requirements' names\r\n        let name_array = [];\r\n        for (let i of data) {\r\n            name_array.push(i.name);\r\n        }\r\n        //iterate through created requirements\r\n        reqValues.forEach((value, index) => {\r\n            //setting correct type of reqirement\r\n            reqValues[index].type = formApp?.values?.[index]?.type ?? (reqValues[index].type || \"attribute\");\r\n            //creating array with from data array with elements that are same type\r\n            let subtype_list = data.filter((item) => item.type === reqValues[index].type);\r\n            //setting correct requirement name\r\n            reqValues[index].name =\r\n                subtype_list.filter((item) => {\r\n                    item.name === formApp.values?.[index]?.name;\r\n                }).length > 0\r\n                    ? formApp.values?.[index].name || reqValues[index].name\r\n                    : reqValues[index].name || subtype_list[0].name;\r\n            reqValues[index].subtype_list = subtype_list.map((item) => item.name);\r\n            reqValues[index].input = formApp.values[index]?.input ?? (reqValues[index].input || []);\r\n            reqValues[index].value = data.filter((item) => item.name === reqValues[index].name)[0].value;\r\n            for (let i = 0; i < this.object.system.level.max; i++) {\r\n                let inputElement = reqValues[index].input[i];\r\n                let previousElement = reqValues[index].input[i - 1] ?? 0;\r\n                switch (reqValues[index].type) {\r\n                    case \"skill\":\r\n                        inputElement = inputElement > 4 ? 1 : inputElement || 1;\r\n                        break;\r\n                    case \"attribute\":\r\n                        inputElement = inputElement || 10;\r\n                        break;\r\n                    case \"feature\":\r\n                        const maxLevel = reqValues[index].value;\r\n                        inputElement = Math.min(inputElement, maxLevel);\r\n                }\r\n                inputElement = Math.max(inputElement, previousElement);\r\n                reqValues[index].input[i] = inputElement;\r\n            }\r\n        });\r\n        reqLogic.forEach((value, index) => {\r\n            reqLogic[index] = formApp.logic?.[index] ?? reqLogic[index];\r\n        });\r\n        templateData.formApp = req;\r\n        console.log(templateData);\r\n        return templateData;\r\n    }\r\n    /**\r\n     * Initialize Data for FormApplication\r\n     * Data structure looks like this:\r\n     * @param {Array} req - already existing requirements\r\n     * @param {Array} type_list - list of types for requirements, can be attribute, skill or feat\r\n     * @param feat.awail - array of Items with type feat from Folders and Compendium Packs\r\n     * @param feat.current - array of Items that was already used\r\n     * @returns {object} templateData\r\n     */\r\n    async InitializeData() {\r\n        if (this.form)\r\n            return;\r\n        console.log(\"First launch\");\r\n        const featList = await this.getFeats();\r\n        const pack_list = featList.pack_list;\r\n        const folder_list = featList.folder_list;\r\n        const folder_name = featList.folder_name;\r\n        const data = []; //list of attributes, skills and feats that user can use as requirement\r\n        for (let [k, v] of Object.entries(CONFIG.ARd20.Attributes)) {\r\n            data.push({\r\n                name: game.i18n.localize(getValues(CONFIG.ARd20.Attributes, k)) ?? k,\r\n                value: k,\r\n                type: \"attribute\",\r\n            });\r\n        }\r\n        for (let [k, v] of obj_entries(CONFIG.ARd20.Skills)) {\r\n            data.push({\r\n                name: game.i18n.localize(getValues(CONFIG.ARd20.Skills, k)) ?? k,\r\n                value: k,\r\n                type: \"skill\",\r\n            });\r\n        }\r\n        const arr = Object.values(CONFIG.ARd20.Rank).filter((value, index) => {\r\n            if (index !== 0)\r\n                return CONFIG.ARd20.Rank[index];\r\n        });\r\n        const rank = Object.assign({}, arr);\r\n        const templateData = {\r\n            formApp: {\r\n                values: [],\r\n                logic: [],\r\n            },\r\n            req: foundry.utils.deepClone(this.object.system.req),\r\n            type_list: [\"attribute\", \"skill\", \"feature\"],\r\n            feat: {\r\n                awail: pack_list.concat(folder_list.filter((item) => pack_list.indexOf(item) < 0)),\r\n                current: this.object.system.req.values.filter((item) => item.type === \"feature\"),\r\n            },\r\n            data: data,\r\n            rank: rank,\r\n        };\r\n        const formApp = templateData.formApp;\r\n        const req = templateData.req;\r\n        const type_list = templateData.type_list;\r\n        const featAwail = templateData.feat.awail;\r\n        const featCurrent = templateData.feat.current;\r\n        let name_array = [];\r\n        for (let i of featCurrent) {\r\n            name_array.push(i.name);\r\n        }\r\n        featAwail.forEach((item, index) => {\r\n            if (item.name === this.object.name) {\r\n                console.log(item.name, \" matches name of the feat\");\r\n                featAwail.splice(index, 1);\r\n            }\r\n            else if (name_array.includes(item.name)) {\r\n                console.log(item.name, \"this feat is already included\", index);\r\n                item.input = featCurrent[featCurrent.indexOf(featCurrent.filter((feat) => feat.name === item.name)[0])].input;\r\n                featAwail.splice(index, 1);\r\n            }\r\n            if (featAwail.filter((feat) => feat.name === item.name).length !== 0) {\r\n                data.push({ name: item.name, type: \"feature\", value: item.value });\r\n            }\r\n        });\r\n        return templateData;\r\n    }\r\n    /**\r\n     * Get features from folders and packs that were configured in settings\r\n     * @returns {} {pack_list, folder_list, folder_name}\r\n     */\r\n    async getFeats() {\r\n        let pack_list = [];\r\n        let folder_list = [];\r\n        let folder_name = [];\r\n        const packs = game.settings.get(\"ard20\", \"feat\").packs;\r\n        const folders = game.settings.get(\"ard20\", \"feat\").folders;\r\n        for (let key of packs) {\r\n            if (game.packs.filter((pack) => pack.metadata.label === key).length !== 0) {\r\n                let feat_list = [];\r\n                feat_list.push(Array.from(game.packs.filter((pack) => pack.metadata.label === key && pack.metadata.entity === \"Item\")[0].index));\r\n                feat_list = feat_list.flat();\r\n                for (let feat of feat_list) {\r\n                    if (feat instanceof ARd20Item) {\r\n                        const new_key = game.packs.filter((pack) => pack.metadata.label === key)[0].metadata.package + \".\" + key;\r\n                        const doc = await game.packs.get(new_key).getDocument(feat.id);\r\n                        if (doc instanceof ARd20Item) {\r\n                            if (doc.data.type === \"feature\") {\r\n                                let item = doc.toObject();\r\n                                item.data = doc.system;\r\n                                const feature = {\r\n                                    name: item.name,\r\n                                    type: \"feature\",\r\n                                    input: [],\r\n                                    pass: [],\r\n                                    subtype_list: [],\r\n                                    value: item.data.level.max,\r\n                                };\r\n                                pack_list.push(feature);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (let key of folders) {\r\n            if (game.folders.filter((folder) => folder.data.name === key).length !== 0) {\r\n                let feat_list = [];\r\n                feat_list.push(game.folders.filter((folder) => folder.data.name === key && folder.data.type === \"Item\")[0].contents);\r\n                feat_list = feat_list.flat();\r\n                for (let feat of feat_list) {\r\n                    if (feat instanceof ARd20Item && feat.data.type === \"feature\") {\r\n                        console.log(\"item added from folder \", feat);\r\n                        const item = feat.toObject();\r\n                        item.data = foundry.utils.deepClone(feat.system);\r\n                        const feature = {\r\n                            name: item.name,\r\n                            type: \"feature\",\r\n                            input: [],\r\n                            pass: [],\r\n                            subtype_list: [],\r\n                            value: item.data.level.max,\r\n                        };\r\n                        folder_list.push(feature);\r\n                        folder_name.push(item.name);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return { pack_list, folder_list, folder_name };\r\n    }\r\n    activateListeners(html) {\r\n        super.activateListeners(html);\r\n        html.find(\".item-create\").on(\"click\", this._onAdd.bind(this));\r\n        html.find(\".item-delete\").on(\"click\", this._Delete.bind(this));\r\n    }\r\n    /**\r\n     * Add new requirement. By default it \"Strength>=10\" for every feat's level.\r\n     * @param event\r\n     */\r\n    async _onAdd(event) {\r\n        event.preventDefault();\r\n        const req = this.options.data.req;\r\n        let sub_list = []; //temporary list with attributes\r\n        for (let [k, i] of obj_entries(CONFIG.ARd20.Attributes)) {\r\n            sub_list.push(k);\r\n        }\r\n        //create varible for easier access to maximum level of feature\r\n        const maxLevel = this.object.system.level.max;\r\n        //create default value object\r\n        const defaultValue = {\r\n            name: \"Strength\",\r\n            type: \"attribute\",\r\n            pass: new Array(maxLevel).fill(false),\r\n            subtype_list: sub_list,\r\n            value: \"str\",\r\n            input: new Array(maxLevel).fill(10),\r\n        };\r\n        req.values.push(defaultValue);\r\n        this.render();\r\n    }\r\n    /**\r\n     * Delete existing requirement\r\n     * @param event\r\n     */\r\n    async _Delete(event) {\r\n        event.preventDefault();\r\n        const req = this.options.data.req;\r\n        req.values.splice(event.currentTarget.dataset.key, 1);\r\n        this.render();\r\n    }\r\n    /**\r\n     * Save typed-in values\r\n     * @param event\r\n     */\r\n    _onChangeInput(event) {\r\n        super._onChangeInput(event);\r\n        const data = this.options.data;\r\n        const formApp = data.formApp;\r\n        const k = event.currentTarget.dataset.key;\r\n        const i = event.currentTarget.dataset.order;\r\n        console.log(foundry.utils.expandObject(this._getSubmitData()));\r\n        const req = foundry.utils.expandObject(this._getSubmitData()).req;\r\n        switch (event.currentTarget.dataset.type) {\r\n            case \"value\":\r\n                formApp.values[k].type = req.values[k].type;\r\n                formApp.values[k].name = req.values[k].name;\r\n                formApp.values[k].input[i] = req.values[k].input[i];\r\n                break;\r\n            case \"logic\":\r\n                formApp.logic[k] = req.logic[k];\r\n                break;\r\n        }\r\n        this.getData();\r\n        this.render();\r\n    }\r\n    async _updateObject(event, formData) {\r\n        const item = this.object;\r\n        this.render();\r\n        const req = this.options.data.req;\r\n        const obj = {};\r\n        obj[\"data.req.values\"] = req.values;\r\n        obj[\"data.req.logic\"] = req.logic;\r\n        console.log(obj);\r\n        await item.update(obj);\r\n    }\r\n}\r\n","import { obj_entries } from \"../ard20.js\";\r\nimport { onManageActiveEffect, prepareActiveEffectCategories } from \"../helpers/effects.js\";\r\nimport { FeatRequirements } from \"../helpers/feat_req.js\";\r\n/**\r\n * Extend the basic ItemSheet with some very simple modifications\r\n * @extends {ItemSheet}\r\n */\r\nexport class ARd20ItemSheet extends ItemSheet {\r\n    /** @override */\r\n    static get defaultOptions() {\r\n        return mergeObject(super.defaultOptions, {\r\n            classes: [\"ard20\", \"sheet\", \"item\"],\r\n            width: 520,\r\n            height: 480,\r\n            tabs: [{ navSelector: \".sheet-tabs\", contentSelector: \".sheet-body\", initial: \"description\" }],\r\n        });\r\n    }\r\n    /** @override */\r\n    get template() {\r\n        const path = \"systems/ard20/templates/item\";\r\n        return `${path}/item-${this.item.system.type}-sheet.html`;\r\n    }\r\n    /* -------------------------------------------- */\r\n    /** @override */\r\n    getData() {\r\n        // Retrieve base data structure.\r\n        const context = super.getData();\r\n        // Use a safe clone of the item data for further operations.\r\n        //@ts-expect-error\r\n        const itemData = context.item;\r\n        //@ts-expect-error\r\n        context.config = CONFIG.ARd20;\r\n        // Retrieve the roll data for TinyMCE editors.\r\n        //@ts-expect-error\r\n        context.rollData = {};\r\n        let actor = this.object?.parent ?? null;\r\n        if (actor) {\r\n            //@ts-expect-error\r\n            context.rollData = actor.getRollData();\r\n        }\r\n        // Add the actor's data to context.data for easier access, as well as flags.\r\n        //@ts-expect-error\r\n        context.data = itemData;\r\n        //@ts-expect-error\r\n        context.flags = itemData.flags;\r\n        //@ts-expect-error\r\n        context.isGM = game.user.isGM;\r\n        //@ts-expect-error\r\n        context.type = context.item.type;\r\n        //@ts-expect-error\r\n        context.effects = prepareActiveEffectCategories(this.item.effects);\r\n        return context;\r\n    }\r\n    _getSubmitData(updateData = {}) {\r\n        // Create the expanded update data object\r\n        if (this.form === null)\r\n            return;\r\n        //@ts-expect-error\r\n        const fd = new FormDataExtended(this.form, { editors: this.editors });\r\n        let data = fd.toObject();\r\n        if (updateData)\r\n            data = mergeObject(data, updateData);\r\n        else\r\n            data = expandObject(data);\r\n        // Handle Damage array\r\n        //@ts-expect-error\r\n        const damage = system?.damage;\r\n        if (damage) {\r\n            if (damage.parts) {\r\n                damage.damType = Object.values(damage?.damType || {});\r\n                damage.parts = Object.values(damage?.parts || {}).map(function (d, ind) {\r\n                    let a = [];\r\n                    if (damage.damType[ind].length !== 0) {\r\n                        damage.damType[ind].forEach((sub, i) => a.push(JSON.parse(damage.damType[ind][i])));\r\n                    }\r\n                    //@ts-expect-error\r\n                    return [d[0] || \"\", a];\r\n                });\r\n            }\r\n            else {\r\n                for (let [key, type] of obj_entries(damage)) {\r\n                    for (let [k, prof] of obj_entries(type)) {\r\n                        prof.damType = Object.values(prof?.damType || {});\r\n                        prof.parts = Object.values(prof?.parts || {}).map(function (d, ind) {\r\n                            let a = [];\r\n                            if (prof.damType[ind].length !== 0 && prof.damType[ind][0] !== \"\") {\r\n                                prof.damType[ind].forEach((sub, i) => a.push(JSON.parse(prof.damType[ind][i])));\r\n                            }\r\n                            //@ts-expect-error\r\n                            return [d[0] || \"\", a];\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return flattenObject(data);\r\n    }\r\n    /* -------------------------------------------- */\r\n    /** @override */\r\n    activateListeners(html) {\r\n        super.activateListeners(html);\r\n        const edit = !this.isEditable;\r\n        const context = this.getData();\r\n        //@ts-expect-error\r\n        function formatSelection(state) {\r\n            const parent = $(state.element).parent().prop(\"tagName\");\r\n            if (!state.id || parent !== \"OPTGROUP\")\r\n                return state.text;\r\n            const optgroup = $(state.element).parent().attr(\"label\");\r\n            const subtype = state.element.value.match(/(\\w+)/g)[1];\r\n            const url = `systems/ard20/css/${subtype}.svg`;\r\n            return `<div><img style=\"width:15px; background-color:black; margin-left:2px\" src=${url} />${optgroup} ${state.text}</div>`;\r\n        }\r\n        //@ts-expect-error\r\n        function formatResult(state) {\r\n            const parent = $(state.element).parent().prop(\"tagName\");\r\n            if (!state.id || parent !== \"OPTGROUP\")\r\n                return state.text;\r\n            const subtype = state.element.value.match(/(\\w+)/g)[1];\r\n            const url = `systems/ard20/css/${subtype}.svg`;\r\n            return `<div><img style=\"width:15px; background-color:black; margin-left:2px\" src=${url} /> ${state.text}</div>`;\r\n        }\r\n        $(`select.select2`, html)\r\n            //@ts-expect-error\r\n            .select2({\r\n            theme: \"filled\",\r\n            width: \"auto\",\r\n            dropdownAutoWidth: true,\r\n            disabled: edit,\r\n            templateSelection: formatSelection,\r\n            templateResult: formatResult,\r\n            //@ts-expect-error\r\n            escapeMarkup: function (m) {\r\n                return m;\r\n            },\r\n        })\r\n            //@ts-expect-error\r\n            .val(function (index, value) {\r\n            //@ts-expect-error\r\n            const name = $(\"select.select2\", html)[index].name;\r\n            const val = getProperty(context, name);\r\n            return val;\r\n        })\r\n            .trigger(\"change\");\r\n        $(\"select\").on(\"select2:unselect\", function (evt) {\r\n            //@ts-expect-error\r\n            if (!evt.params.originalEvent) {\r\n                return;\r\n            }\r\n            //@ts-expect-error\r\n            evt.params.originalEvent.stopPropagation();\r\n        });\r\n        // Everything below here is only needed if the sheet is editable\r\n        if (!this.isEditable)\r\n            return;\r\n        //@ts-expect-error\r\n        html.find(\".effect-control\").click((ev) => onManageActiveEffect(ev, this.item));\r\n        // Roll handlers, click handlers, etc. would go here.\r\n        html.find(\".config-button\").click(this._FeatReq.bind(this));\r\n        html.find(\".damage-control\").click(this._onDamageControl.bind(this));\r\n    }\r\n    //@ts-expect-error\r\n    _FeatReq(event) {\r\n        event.preventDefault();\r\n        const button = event.currentTarget;\r\n        let app;\r\n        switch (button.dataset.action) {\r\n            case \"feat-req\":\r\n                //@ts-expect-error\r\n                app = new FeatRequirements(this.object);\r\n                break;\r\n        }\r\n        app?.render(true);\r\n    }\r\n    //@ts-expect-error\r\n    async _onDamageControl(event) {\r\n        event.preventDefault();\r\n        const a = event.currentTarget;\r\n        if (a.classList.contains(\"add-damage\")) {\r\n            //await this._onSubmit(event);\r\n            let path = a.dataset.type ? \"damage\" + a.dataset.type : \"damage\";\r\n            const damage = getProperty(this.item.system, path);\r\n            damage.damType = damage.damType || [];\r\n            const partsPath = path + \".parts\";\r\n            const damTypePath = path + \".damType\";\r\n            const update = {};\r\n            update[partsPath] = damage.parts.concat([[\"\", [\"\", \"\"]]]);\r\n            update[damTypePath] = damage.damType?.concat([[\"\"]]);\r\n            await this.item.update(update);\r\n        }\r\n        if (a.classList.contains(\"delete-damage\")) {\r\n            //await this._onSubmit(event);\r\n            const li = a.closest(\".damage-part\");\r\n            let path = a.dataset.type ? \"damage\" + a.dataset.type : \"damage\";\r\n            const damage = getProperty(this.item.system, path);\r\n            console.log(damage);\r\n            damage.parts.splice(Number(li.dataset.damagePart), 1);\r\n            damage.damType.splice(Number(li.dataset.damagePart), 1);\r\n            const partsPath = path + \".parts\";\r\n            const damTypePath = path + \".damType\";\r\n            const update = {};\r\n            update[partsPath] = damage.parts;\r\n            update[damTypePath] = damage.damType;\r\n            await this.item.update(update);\r\n        }\r\n    }\r\n    //@ts-expect-error\r\n    async _onSubmit(...args) {\r\n        if (this._tabs[0].active === \"data\")\r\n            this.position.height = \"auto\";\r\n        //@ts-expect-error\r\n        await super._onSubmit(...args);\r\n    }\r\n}\r\n","/**\r\n * Define a set of template paths to pre-load\r\n * Pre-loaded templates are compiled and cached for fast access when rendering\r\n * @return {Promise}\r\n */\r\nexport const preloadHandlebarsTemplates = async function () {\r\n    return loadTemplates([\r\n        // Actor partials.\r\n        \"systems/ard20/templates/actor/parts/actor-features.html\",\r\n        \"systems/ard20/templates/actor/parts/actor-items.html\",\r\n        \"systems/ard20/templates/actor/parts/actor-spells.html\",\r\n        \"systems/ard20/templates/actor/parts/actor-effects.html\",\r\n        \"systems/ard20/templates/actor/parts/actor-equip.html\",\r\n        // Character Advancement\r\n        \"systems/ard20/templates/actor/parts/actor-adv.html\",\r\n        // Settings\r\n        \"systems/ard20/templates/app/prof-settings.html\",\r\n        \"systems/ard20/templates/app/feat-settings.html\",\r\n        // Requirements for features\r\n        \"systems/ard20/templates/app/feat_req.hbs\",\r\n    ]);\r\n};\r\n","//@ts-expect-error\r\nexport const ARd20 = {};\r\nARd20.Attributes = {\r\n    str: \"ARd20.AttributeStr\",\r\n    dex: \"ARd20.AttributeDex\",\r\n    con: \"ARd20.AttributeCon\",\r\n    int: \"ARd20.AttributeInt\",\r\n    wis: \"ARd20.AttributeWis\",\r\n    cha: \"ARd20.AttributeCha\",\r\n};\r\nARd20.AttributeAbbreviations = {\r\n    str: \"ARd20.AttributeStrAbbr\",\r\n    dex: \"ARd20.AttributeDexAbbr\",\r\n    con: \"ARd20.AttributeConAbbr\",\r\n    int: \"ARd20.AttributeIntAbbr\",\r\n    wis: \"ARd20.AttributeWisAbbr\",\r\n    cha: \"ARd20.AttributeChaAbbr\",\r\n};\r\nARd20.CHARACTER_EXP_LEVELS = [0, 300, 900, 2700, 6500, 14000, 23000, 34000, 48000, 64000, 85000, 100000, 120000, 140000, 165000, 195000, 225000, 265000, 305000, 355000];\r\nARd20.SpellSchool = {\r\n    abj: \"ARd20.SchoolAbj\",\r\n    con: \"ARd20.SchoolCon\",\r\n    div: \"ARd20.SchoolDiv\",\r\n    enc: \"ARd20.SchoolEnc\",\r\n    evo: \"ARd20.SchoolEvo\",\r\n    ill: \"ARd20.SchoolIll\",\r\n    nec: \"ARd20.SchoolNec\",\r\n    trs: \"ARd20.SchoolTrs\",\r\n};\r\nARd20.Skills = {\r\n    acr: \"ARd20.SkillAcr\",\r\n    ani: \"ARd20.SkillAni\",\r\n    arc: \"ARd20.SkillArc\",\r\n    ath: \"ARd20.SkillAth\",\r\n    dec: \"ARd20.SkillDec\",\r\n    his: \"ARd20.SkillHis\",\r\n    ins: \"ARd20.SkillIns\",\r\n    itm: \"ARd20.SkillItm\",\r\n    inv: \"ARd20.SkillInv\",\r\n    med: \"ARd20.SkillMed\",\r\n    nat: \"ARd20.SkillNat\",\r\n    prc: \"ARd20.SkillPrc\",\r\n    prf: \"ARd20.SkillPrf\",\r\n    per: \"ARd20.SkillPer\",\r\n    rel: \"ARd20.SkillRel\",\r\n    slt: \"ARd20.SkillSlt\",\r\n    ste: \"ARd20.SkillSte\",\r\n    sur: \"ARd20.SkillSur\",\r\n};\r\nARd20.Rank = {\r\n    0: \"ARd20.Untrained\",\r\n    1: \"ARd20.Basic\",\r\n    2: \"ARd20.Expert\",\r\n    3: \"ARd20.Master\",\r\n    4: \"ARd20.Legend\",\r\n};\r\nARd20.Source = {\r\n    mar: \"ARd20.Martial\",\r\n    mag: \"ARd20.Magical\",\r\n    div: \"ARd20.Divine\",\r\n    pri: \"ARd20.Primal\",\r\n    psy: \"ARd20.Psyhic\",\r\n};\r\nARd20.WeaponProp = {\r\n    aff: \"ARd20.Affixed\",\r\n    awk: \"ARd20.Awkward\",\r\n    con: \"ARd20.Conceal\",\r\n    bra: \"ARd20.Brace\",\r\n    def: \"ARd20.Deflect\",\r\n    dis: \"ARd20.Disarm\",\r\n    dou: \"ARd20.Double Ended\",\r\n    ent: \"ARd20.Entangle\",\r\n    fin: \"ARd20.Finesse\",\r\n    fir: \"ARd20.Firearm\",\r\n    hea: \"ARd20.Heavy\",\r\n    lau: \"ARd20.Launch\",\r\n    lig: \"ARd20.Light\",\r\n    lun: \"ARd20.Lunge\",\r\n    mel: \"ARd20.Melee\",\r\n    one: \"ARd20.One-Handed\",\r\n    pen: \"ARd20.Penetrate\",\r\n    ran: \"ARd20.Ranged\",\r\n    rea: \"ARd20.Reach\",\r\n    rel: \"ARd20.Reload\",\r\n    sta: \"Ard20.Stagger\",\r\n    thr: \"ARd20.Thrown\",\r\n    tri: \"ARd20.Trip\",\r\n    two: \"ARd20.Two-Handed\",\r\n    ver: \"ARd20.Versatile\",\r\n};\r\nARd20.WeaponType = {\r\n    amb: \"ARd20.Ambush\",\r\n    axe: \"ARd20.Axe\",\r\n    blu: \"ARd20.Bludgeon\",\r\n    bow: \"ARd20.Bow\",\r\n    sli: \"ARd20.Sling\",\r\n    cbl: \"ARd20.Combat Blade\",\r\n    cro: \"ARd20.Crossbow\",\r\n    dbl: \"ARd20.Dueling Blade\",\r\n    fir: \"ARd20.Firearm\",\r\n    fla: \"ARd20.Flail\",\r\n    whi: \"ARd20.Whip\",\r\n    ham: \"ARd20.Hammer\",\r\n    pic: \"ARd20.Pick\",\r\n    pol: \"ARd20.Polearm\",\r\n    spe: \"ARd20.Spear\",\r\n    thr: \"ARd20.Throwing\",\r\n};\r\nARd20.AbilXP = [50, 50, 50, 50, 70, 90, 120, 150, 190, 290, 440, 660, 990, 1500, 2700, 4800, 8400, 14700, 25700, 51500, 103000, 206000, 412000, 824000, 2060000];\r\nARd20.SkillXP = {\r\n    0: [50, 80, 125, 185, 260, 350, 455, 575, 710, 860, 1025, 1205, 1400, 1610, 1835, 2075, 2330, 2600],\r\n    1: [115, 190, 295, 430, 595, 790, 1015, 1270, 1555, 1870, 2215, 2590, 2995, 3430, 3895, 4390, 4915, 5470],\r\n};\r\nARd20.DamageTypes = {\r\n    mag: \"ARd20.Magical\",\r\n    phys: \"ARd20.Physical\",\r\n};\r\nARd20.DamageSubTypes = {\r\n    acid: \"ARd20.DamageAcid\",\r\n    bludgeoning: \"ARd20.DamageBludgeoning\",\r\n    cold: \"ARd20.DamageCold\",\r\n    fire: \"ARd20.DamageFire\",\r\n    force: \"ARd20.DamageForce\",\r\n    lightning: \"ARd20.DamageLightning\",\r\n    necr: \"ARd20.DamageNecrotic\",\r\n    piercing: \"ARd20.DamagePiercing\",\r\n    poison: \"ARd20.DamagePoison\",\r\n    slashing: \"ARd20.DamageSlashing\",\r\n    radiant: \"ARd20.DamageRadiant\",\r\n    psychic: \"ARd20.DamagePsychic\",\r\n};\r\nARd20.ResistTypes = {\r\n    res: \"ARd20.Resistance\",\r\n    vul: \"Ard20.Vulnerability\",\r\n    imm: \"ARd20.Immunity\",\r\n};\r\nARd20.HPDice = [\"1d6\", \"1d8\", \"1d10\", \"1d12\", \"1d12+2\", \"1d12+4\", \"1d20\", \"1d20+2\", \"1d20+4\", \"1d20+6\", \"1d20+8\", \"1d20+10\", \"1d20+12\"];\r\nARd20.HeavyPoints = {\r\n    light: { chest: 3, gloves: 1, boots: 1, pants: 2, head: 1 },\r\n    medium: { chest: 5, gloves: 2, boots: 2, pants: 3, head: 2 },\r\n    heavy: { chest: 8, gloves: 3, boots: 3, pants: 5, head: 3 },\r\n};\r\nARd20.RollResult = {\r\n    0: \"ARd20.Fumble\",\r\n    1: \"ARd20.Fail\",\r\n    2: \"ARd20.Success\",\r\n    3: \"ARd20.Crit\",\r\n};\r\n","export default class ARd20SocketHandler {\r\n    //@ts-expect-error\r\n    static async updateActorData(data) {\r\n        if (game.user.isGM) {\r\n            const actor = game.actors.get(data.actor._id);\r\n            //@ts-expect-error\r\n            if (actor)\r\n                await actor.update(data.update, { \"data.health.value\": data.value });\r\n        }\r\n    }\r\n}\r\n","<svelte:options accessors={true} />\r\n\r\n<script>\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  export let form;\r\n  let advancementSetting = game.settings.get(\"ard20\", \"advancement-rate\");\r\n  export let elementRoot;\r\n  let attributeFormula;\r\n  $: {\r\n    attributeFormula = advancementSetting.formulas.attributes;\r\n    for (let variable of Object.values(advancementSetting.variables)) {\r\n      if (variable.value) {\r\n        console.log(attributeFormula);\r\n        attributeFormula = attributeFormula.replaceAll(variable.shortName, variable.value);\r\n      }\r\n    }\r\n  }\r\n  async function changeSetting() {\r\n    await game.settings.set(\"ard20\", \"advancement-rate\", advancementSetting);\r\n    console.log(\"change\");\r\n  }\r\n</script>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n  <form bind:this={form} autocomplete=\"off\">\r\n    <section class=\"grid grid-2col\">\r\n      <div>\r\n        <label for=\"Custom Values\"> CustomValues </label>\r\n        <div class=\"grid grid-3col\">\r\n          {#each Object.values(advancementSetting.variables) as variable}\r\n            <label for={variable.longName}>{variable.longName}</label>\r\n            <input bind:value={variable.shortName} on:change={changeSetting} placeholder=\"shortName\" />\r\n            <input\r\n              min=\"-999\"\r\n              max=\"999\"\r\n              type=\"number\"\r\n              bind:value={variable.value}\r\n              on:change={changeSetting}\r\n              placeholder=\"custom value\"\r\n            />\r\n          {/each}\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <label for=\"Non-custom Values\">Non-custom Values</label>\r\n        <div>AS - Attribute Score</div>\r\n        <div>SS - Skill Score</div>\r\n        <div>SL - Skill level</div>\r\n      </div>\r\n    </section>\r\n    <section>\r\n      <div>\r\n        <label for=\"Attribute Formula\">Attribute Advancement Formula</label>\r\n        <input type=\"text\" on:change={changeSetting} bind:value={advancementSetting.formulas.attributes} />\r\n      </div>\r\n      <br />\r\n      <div>{attributeFormula}</div>\r\n      <br />\r\n    </section>\r\n  </form>\r\n</ApplicationShell>\r\n","import { SvelteApplication } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\nimport AdvancementRateShell from \"./advancement-rate-shell.svelte\";\r\nexport class AdvRateSettingsShim extends FormApplication {\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  constructor(options = {}) {\r\n    super({}, options);\r\n\r\n    new AdvancementRateFormApp().render(true, { focus: true });\r\n  }\r\n\r\n  async _updateObject(event, formData) {}\r\n  render() {\r\n    this.close();\r\n  }\r\n}\r\nclass AdvancementRateFormApp extends SvelteApplication {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      classes: [\"ard20\"],\r\n      title: \"Advancement Rate\",\r\n      minimizable:true,\r\n      resizable:true,\r\n      width: 600,\r\n      height: 600,\r\n      svelte: {\r\n        class: AdvancementRateShell,\r\n        target: document.body,\r\n      },\r\n    });\r\n  }\r\n}\r\n","<svelte:options accessors={true} />\r\n\r\n\r\n<script>\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { uuidv4 } from \"@typhonjs-fvtt/runtime/svelte/util\";\r\n  export let elementRoot;\r\n  export let featSetting = game.settings.get(\"ard20\", \"feat\");\r\n  console.log(featSetting);\r\n\r\n  async function addEntry(type) {\r\n    const name = `New ${type}`.slice(0, -1);\r\n    const id = uuidv4();\r\n    featSetting[type] = [...featSetting[type], { name: name, id: id }];\r\n    console.log(featSetting);\r\n    await game.settings.set(\"ard20\", \"feat\", featSetting);\r\n    featSetting = featSetting;\r\n  }\r\n  async function deleteEntry(type, id) {\r\n    console.log(type);\r\n    const index = featSetting[type].findIndex((entry) => entry.id === id);\r\n    if (index >= 0) {\r\n      console.log(featSetting[type]);\r\n      featSetting[type].splice(index, 1);\r\n      await game.settings.set(\"ard20\", \"feat\", featSetting);\r\n      featSetting = featSetting;\r\n    }\r\n  }\r\n  async function changeSetting() {\r\n    await game.settings.set(\"ard20\", \"feat\", featSetting);\r\n    console.log(featSetting);\r\n  }\r\n</script>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n  <section class=\"sheet-body\">\r\n    <div class=\"flexcol\">\r\n      packs\r\n      {#each featSetting.packs as pack (pack.id)}\r\n        <div class=\"grid grid-2col\">\r\n          <input type=\"text\" bind:value={pack.name} on:change={changeSetting} />\r\n          <button on:click={() => deleteEntry(\"packs\", pack.id)} class=\"minus far fa-minus-square\" />\r\n        </div>\r\n      {/each}\r\n      <button on:click={() => addEntry(\"packs\")} class=\"add far fa-plus-square\" />\r\n      <hr />\r\n      folders\r\n      {#each featSetting.folders as folder (folder.id)}\r\n        <div class=\"grid grid-2col\">\r\n          <input type=\"text\" bind:value={folder.name} on:change={changeSetting} />\r\n          <button on:click={() => deleteEntry(\"folders\", folder.id)} class=\"minus far fa-minus-square\" />\r\n        </div>\r\n      {/each}\r\n      <button on:click={() => addEntry(\"folders\")} class=\"add far fa-plus-square\" />\r\n    </div>\r\n  </section>\r\n</ApplicationShell>\r\n","import { SvelteApplication } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\nimport FeatSettingShell from './featSetting-shell.svelte'\r\nexport class FeatSettingsShim extends FormApplication {\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    constructor(options = {}) {\r\n      super({}, options);\r\n  \r\n      new FeatSetting().render(true, { focus: true });\r\n    }\r\n  \r\n    async _updateObject(event, formData) {}\r\n    render() {\r\n      this.close();\r\n    }\r\n  }\r\n  class FeatSetting extends SvelteApplication {\r\n    static get defaultOptions() {\r\n      return foundry.utils.mergeObject(super.defaultOptions, {\r\n        classes: [\"ard20\"],\r\n        title: \"Folders and Packs with Features\",\r\n        minimizable:true,\r\n        resizable:true,\r\n        width: 400,\r\n        height: 600,\r\n        svelte: {\r\n          class: FeatSettingShell,\r\n          target: document.body,\r\n        },\r\n      });\r\n    }\r\n  }\r\n  ","<svelte:options accessors={true} />\r\n\r\n<script>\r\n  import { uuidv4 } from \"@typhonjs-fvtt/runtime/svelte/util\";\r\n  import { ApplicationShell } from \"@typhonjs-fvtt/runtime/svelte/component/core\";\r\n  import { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n  import { ARd20 } from \"../../helpers/config.js\";\r\n  let setting = game.settings.get(\"ard20\", \"proficiencies\");\r\n  console.log(setting);\r\n  async function removeAllAll() {\r\n    for (const item of Object.values(setting)) {\r\n      item.value = [];\r\n    }\r\n    console.log(setting);\r\n    setting = setting;\r\n    await game.settings.set(\"ard20\", \"proficiencies\", setting);\r\n  }\r\n  async function removeAll(type) {\r\n    setting[type].value = [];\r\n    setting = setting;\r\n    await game.settings.set(\"ard20\", \"proficiencies\", setting);\r\n  }\r\n  async function add(type) {\r\n    setting[type].value = [\r\n      ...setting[type].value,\r\n      { id: uuidv4(), name: `New ${type}`, type: Object.keys(selectArr[type])[0] },\r\n    ];\r\n    await game.settings.set(\"ard20\", \"proficiencies\", setting);\r\n  }\r\n  async function setDefaultGroup(type) {\r\n    console.log([...game.settings.settings].filter((set) => set[0] === \"ard20.proficiencies\")[0][1].default);\r\n    setting[type].value = [\r\n      ...[...game.settings.settings].filter((set) => set[0] === \"ard20.proficiencies\")[0][1].default[type].value,\r\n    ];\r\n    setting = setting;\r\n    await game.settings.set(\"ard20\", \"proficiencies\", setting);\r\n  }\r\n  async function setDefaultAll() {\r\n    console.log([...game.settings.settings].filter((set) => set[0] === \"ard20.proficiencies\")[0][1].default);\r\n    setting = duplicate([...game.settings.settings].filter((set) => set[0] === \"ard20.proficiencies\")[0][1].default);\r\n    await game.settings.set(\"ard20\", \"proficiencies\", setting);\r\n  }\r\n  async function remove(key, type) {\r\n    const index = setting[type].value.findIndex((entry) => entry.id === key);\r\n    if (index >= 0) {\r\n      setting[type].value.splice(index, 1);\r\n      setting = setting;\r\n      await game.settings.set(\"ard20\", \"proficiencies\", setting);\r\n    }\r\n  }\r\n  export let elementRoot;\r\n  let activeTabValue = \"weapon\";\r\n  const handleClick = (tabValue) => () => (activeTabValue = tabValue);\r\n  let selectArr = {\r\n    weapon: ARd20.WeaponType,\r\n    armor: { light: \"light\", medium: \"medium\", heavy: \"heavy\" },\r\n    tool: {},\r\n  };\r\n</script>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n  <div class=\"flexrow\">\r\n    <button on:click={() => removeAllAll()}>Remove All</button>\r\n    <button on:click={() => setDefaultAll()}>Reset All</button>\r\n  </div>\r\n  <ul>\r\n    {#each Object.values(setting) as item}\r\n      <li class={activeTabValue === item.id ? \"active\" : \"\"}>\r\n        <span on:click={handleClick(item.id)}>{item.label}</span>\r\n      </li>\r\n    {/each}\r\n  </ul>\r\n\r\n  <div class=\"box\">\r\n    {#each Object.values(setting) as item (item)}\r\n      {#if activeTabValue === item.id}\r\n        <div class=\"flexrow\">\r\n          <button on:click={() => add(item.id)}>Add {item.label}</button>\r\n          <button on:click={() => setDefaultGroup(item.id)}>Reset to default</button>\r\n          <button on:click={() => removeAll(item.id)}>Remove All {item.label}</button>\r\n        </div>\r\n        <hr />\r\n        <div>\r\n          {#each item.value as entry (entry.id)}\r\n            <div class=\"flexrow\">\r\n              <input bind:value={entry.name} />\r\n              <select bind:value={entry.type}>\r\n                {#each Object.entries(selectArr[item.id]) as opt}\r\n                  <option value={opt[0]}>{localize(opt[1])}</option>\r\n                {/each}\r\n              </select>\r\n              <button on:click={() => remove(entry.id, item.id)} class=\"minus far fa-minus-square\" />\r\n            </div>\r\n          {/each}\r\n        </div>\r\n      {/if}\r\n    {/each}\r\n  </div>\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n  button {\r\n    max-height: 2em;\r\n  }\r\n  .box {\r\n    background-color: #c9c7b8;\r\n    margin-bottom: 10px;\r\n    padding: 10px;\r\n    border: 2px solid #dee2e6;\r\n    border-radius: 0 0 0.5rem 0.5rem;\r\n    border-top: 0;\r\n  }\r\n  ul {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    padding-left: 0;\r\n    margin-bottom: 0;\r\n    list-style: none;\r\n    border-bottom: 1px solid #dee2e6;\r\n    justify-content: space-evenly;\r\n    align-content: space-around;\r\n    max-height: 3em;\r\n  }\r\n  li {\r\n    margin-bottom: -0.5em;\r\n  }\r\n\r\n  span {\r\n    border: 1px solid transparent;\r\n    border-top-left-radius: 0.25rem;\r\n    border-top-right-radius: 0.25rem;\r\n    display: block;\r\n    padding: 0.5rem 1rem;\r\n    cursor: pointer;\r\n  }\r\n\r\n  span:hover {\r\n    border-color: #b5b3a4 #b5b3a4 #dee2e6;\r\n    background-color: #c9c7b8;\r\n  }\r\n\r\n  li.active > span {\r\n    color: rgb(0, 0, 0);\r\n    background-color: #c9c7b8;\r\n    border-left: 2px solid;\r\n    border-top: 2px solid;\r\n    border-right: 2px solid;\r\n    border-color: #dee2e6 #dee2e6 #c9c7b8;\r\n  }\r\n</style>\r\n","import { SvelteApplication } from \"@typhonjs-fvtt/runtime/svelte/application\";\r\nimport ProfSettingShell from './profSetting-shell.svelte'\r\nexport class ProfSettingsShim extends FormApplication {\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    constructor(options = {}) {\r\n      super({}, options);\r\n  \r\n      new ProfSetting().render(true, { focus: true });\r\n    }\r\n  \r\n    async _updateObject(event, formData) {}\r\n    render() {\r\n      this.close();\r\n    }\r\n  }\r\n  class ProfSetting extends SvelteApplication {\r\n    static get defaultOptions() {\r\n      return foundry.utils.mergeObject(super.defaultOptions, {\r\n        classes: [\"ard20\"],\r\n        title: \"Sub-types for Proficiencies\",\r\n        minimizable:true,\r\n        resizable:true,\r\n        width: 600,\r\n        height: 800,\r\n        svelte: {\r\n          class: ProfSettingShell,\r\n          target: document.body,\r\n        },\r\n      });\r\n    }\r\n  }\r\n  ","import { AdvRateSettingsShim } from \"../settings/advancement-rate/advancement-rate.js\";\r\nimport { FeatSettingsShim } from \"../settings/FeatSetting/featSetting.js\";\r\nimport { ProfSettingsShim } from \"../settings/ProfSetting/profSetting.js\";\r\nexport const registerSystemSettings = function () {\r\n  game.settings.register(\"ard20\", \"proficiencies\", {\r\n    scope: \"world\",\r\n    config: false,\r\n    default: {\r\n      weapon: {\r\n        label: \"weapon\",\r\n        id: \"weapon\",\r\n        value: [\r\n          { name: \"Punch Dagger\", type: \"amb\",id:\"Punch Dagger\" },\r\n          { name: \"Whip Dagger\", type: \"amb\",id:\"Whip Dagger\" },\r\n          { name: \"Gauntlet\", type: \"amb\",id:\"Gauntlet\" },\r\n          { name: \"Hidden Blade\", type: \"amb\",id: \"Hidden Blade\" },\r\n          { name: \"Knucke Axe\", type: \"amb\", id: \"Knucke Axe\" },\r\n          { name: \"Side Baton\", type: \"amb\",id: \"Side Baton\" },\r\n          { name: \"Unarmed strike\", type: \"amb\",id: \"Unarmed strike\" },\r\n          { name: \"Battle Axe\", type: \"axe\",id: \"Battle Axe\" },\r\n          { name: \"Great Axe\", type: \"axe\",id: \"Great Axe\" },\r\n          { name: \"Handaxe\", type: \"axe\",id: \"Handaxe\" },\r\n          { name: \"Hook Sword\", type: \"axe\",id: \"Hook Sword\" },\r\n          { name: \"Khopesh\", type: \"axe\",id: \"Khopesh\" },\r\n          { name: \"Poleaxe\", type: \"axe\",id: \"Poleaxe\" },\r\n          { name: \"Tomahawk\", type: \"axe\",id: \"Tomahawk\" },\r\n          { name: \"Great club\", type: \"blu\",id: \"Great club\" },\r\n          { name: \"Heavy club\", type: \"blu\", id: \"Heavy club\" },\r\n          { name: \"Light Club\", type: \"blu\",id: \"Light Club\" },\r\n        ],\r\n      },\r\n      armor: {label:'armor',id:'armor',value:[]},\r\n      tool: {label:'tool',id:'tool',value:[]},\r\n    },\r\n    onChange: (value) => {\r\n      console.log(\"Настройка изменилась \", value);\r\n    },\r\n  });\r\n  game.settings.registerMenu(\"ard20\", \"gearProfManage\", {\r\n    name: \"SETTINGS.ProfManage\",\r\n    label: \"SETTINGS.ProfManage\",\r\n    type: ProfSettingsShim,\r\n    restricted: false,\r\n    icon: \"fab fa-buffer\",\r\n  });\r\n  game.settings.register(\"ard20\", \"feat\", {\r\n    scope: \"world\",\r\n    config: false,\r\n    default: {\r\n      packs: [],\r\n      folders: [],\r\n    },\r\n    onChange: (value) => {\r\n      console.log(\"Настройка изменилась\", value);\r\n    },\r\n  });\r\n  game.settings.registerMenu(\"ard20\", \"featManage\", {\r\n    name: \"SETTINGS.FeatureManage\",\r\n    label: \"SETTINGS.FeatureManage\",\r\n    type: FeatSettingsShim,\r\n    restricted: false,\r\n  });\r\n  game.settings.register(\"ard20\", \"advancement-rate\", {\r\n    scope: \"world\",\r\n    config: false,\r\n    default: {\r\n      variables: {\r\n        skillCount: {\r\n          value: 5,\r\n          shortName: \"SC\",\r\n          longName: \"Skill Count\",\r\n        },\r\n        featureCount: {\r\n          value: 5,\r\n          shortName: \"FC\",\r\n          longName: \"featureCount\",\r\n        },\r\n        skillValue: {\r\n          value: 5,\r\n          shortName: \"SV\",\r\n          longName: \"skillValue\",\r\n        },\r\n        featureLevel: {\r\n          value: 5,\r\n          shortName: \"FL\",\r\n          longName: \"Feature Level\",\r\n        },\r\n        attributeValue: {\r\n          value: 5,\r\n          shortName: \"AV\",\r\n          longName: \"Attribute Value\",\r\n        },\r\n      },\r\n      formulas: {\r\n        skills: \"\",\r\n        features: \"n\",\r\n        attributes: \"max(floor((AS-10)/2)+2,1)\",\r\n      },\r\n    },\r\n    onChange: (value) => {\r\n      console.log(\"Настройка изменилась\", value);\r\n    },\r\n  });\r\n  game.settings.registerMenu(\"ard20\", \"advancementRateManage\", {\r\n    name: \"SETTINGS.AdvancementRateManage\",\r\n    label: \"SETTINGS.AdvancementRateManage\",\r\n    type: AdvRateSettingsShim,\r\n    restricted: false,\r\n  });\r\n};\r\nclass ProfFormApp extends FormApplication {\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      classes: [\"ard20\"],\r\n      title: \"Armor/Weapon Proficiencies\",\r\n      template: \"systems/ard20/templates/app/prof-settings.html\",\r\n      id: \"prof-settings\",\r\n      width: 600,\r\n      height: \"auto\",\r\n      submitOnChange: true,\r\n      closeOnSubmit: false,\r\n      tabs: [{ navSelector: \".sheet-tabs\", contentSelector: \".sheet-body\", initial: \"weapons\" }],\r\n    });\r\n  }\r\n  //@ts-expect-error\r\n  getData() {\r\n    const sheetData = {\r\n      proficiencies: game.settings.get(\"ard20\", \"proficiencies\"),\r\n      config: CONFIG.ARd20,\r\n    };\r\n    return sheetData;\r\n  }\r\n  //@ts-expect-error\r\n  activateListeners(html) {\r\n    super.activateListeners(html);\r\n    html.find(\".add\").click(this._onAdd.bind(this));\r\n    html.find(\".minus\").click(this._Delete.bind(this));\r\n  }\r\n  //@ts-expect-error\r\n  async _onAdd(event) {\r\n    event.preventDefault();\r\n    const proficiencies = game.settings.get(\"ard20\", \"proficiencies\");\r\n    proficiencies.weapon.push({ name: \"name\", type: \"amb\" });\r\n    await game.settings.set(\"ard20\", \"proficiencies\", proficiencies);\r\n    this.render();\r\n  }\r\n  //@ts-expect-error\r\n  async _Delete(event) {\r\n    event.preventDefault();\r\n    const proficiencies = game.settings.get(\"ard20\", \"proficiencies\");\r\n    proficiencies.weapon.splice(event.currentTarget.dataset.key, 1);\r\n    await game.settings.set(\"ard20\", \"proficiencies\", proficiencies);\r\n    this.render();\r\n  }\r\n  //@ts-expect-error\r\n  async _updateObject(event, formData) {\r\n    const proficiencies = game.settings.get(\"ard20\", \"proficiencies\");\r\n    console.log(formData);\r\n    let dirty = false;\r\n    for (let [fieldName, value] of Object.entries(foundry.utils.flattenObject(formData))) {\r\n      const [type, index, propertyName] = fieldName.split(\".\");\r\n      //@ts-expect-error\r\n      if (proficiencies[type][index][propertyName] !== value) {\r\n        //log({index, propertyName, value});\r\n        //@ts-expect-error\r\n        proficiencies[type][index][propertyName] = value;\r\n        dirty = dirty || true;\r\n      }\r\n      if (dirty) {\r\n        await game.settings.set(\"ard20\", \"proficiencies\", proficiencies);\r\n      }\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Highlight critical success or failure on d20 rolls\r\n */\r\n//@ts-expect-error\r\nexport const highlightCriticalSuccessFailure = function (message, html, data) {\r\n    if (!message.isRoll || !message.isContentVisible)\r\n        return;\r\n    // Highlight rolls where the first part is a d20 roll\r\n    const roll = message.roll;\r\n    if (!roll.dice.length)\r\n        return;\r\n    const d = roll.dice[0];\r\n    // Ensure it is an un-modified d20 roll\r\n    const isD20 = (d.faces === 20) && (d.values.length === 1);\r\n    if (!isD20)\r\n        return;\r\n    const isModifiedRoll = (\"success\" in d.results[0]) || d.options.marginSuccess || d.options.marginFailure;\r\n    if (isModifiedRoll)\r\n        return;\r\n    // Highlight successes and failures\r\n    const critical = d.options.critical || 20;\r\n    const fumble = d.options.fumble || 1;\r\n    if (d.total >= critical)\r\n        html.find(\".dice-total\").addClass(\"critical\");\r\n    else if (d.total <= fumble)\r\n        html.find(\".dice-total\").addClass(\"fumble\");\r\n    else if (d.options.target) {\r\n        if (roll.total >= d.options.target)\r\n            html.find(\".dice-total\").addClass(\"success\");\r\n        else\r\n            html.find(\".dice-total\").addClass(\"failure\");\r\n    }\r\n};\r\n/* -------------------------------------------- */\r\n/**\r\n * Optionally hide the display of chat card action buttons which cannot be performed by the user\r\n */\r\n//@ts-expect-error\r\nexport const displayChatActionButtons = function (message, html, data) {\r\n    const chatCard = html.find(\".ard20.chat-card\");\r\n    if (chatCard.length > 0) {\r\n        const flavor = html.find(\".flavor-text\");\r\n        if (flavor.text() === html.find(\".item-name\").text())\r\n            flavor.remove();\r\n        // If the user is the message author or the actor owner, proceed\r\n        let actor = game.actors.get(data.message.speaker.actor);\r\n        if (actor && actor.isOwner)\r\n            return;\r\n        else if (game.user.isGM || (data.author.id === game.user.id))\r\n            return;\r\n        // Otherwise conceal action buttons except for saving throw\r\n        const buttons = chatCard.find(\"button[data-action]\");\r\n        //@ts-expect-error\r\n        buttons.each((i, btn) => {\r\n            if (btn.dataset.action === \"save\")\r\n                return;\r\n            btn.style.display = \"none\";\r\n        });\r\n    }\r\n};\r\n/* -------------------------------------------- */\r\n/**\r\n * This function is used to hook into the Chat Log context menu to add additional options to each message\r\n * These options make it easy to conveniently apply damage to controlled tokens based on the value of a Roll\r\n *\r\n * @param {HTMLElement} html    The Chat Message being rendered\r\n * @param {Array} options       The Array of Context Menu options\r\n *\r\n * @return {Array}              The extended options Array including new context choices\r\n */\r\nexport const addChatMessageContextOptions = function (html, options) {\r\n    let canApply = (li) => {\r\n        //@ts-expect-error\r\n        const message = game.messages.get(li.data(\"messageId\"));\r\n        return message?.isRoll && message?.isContentVisible && canvas.tokens?.controlled.length;\r\n    };\r\n    options.push({\r\n        //@ts-expect-error\r\n        name: game.i18n.localize(\"ARd20.ChatContextDamage\"),\r\n        //@ts-expect-error\r\n        icon: '<i class=\"fas fa-user-minus\"></i>',\r\n        //@ts-expect-error\r\n        condition: canApply,\r\n        //@ts-expect-error\r\n        callback: li => applyChatCardDamage(li, 1)\r\n    }, {\r\n        name: game.i18n.localize(\"ARd20.ChatContextHealing\"),\r\n        icon: '<i class=\"fas fa-user-plus\"></i>',\r\n        condition: canApply,\r\n        //@ts-expect-error\r\n        callback: li => applyChatCardDamage(li, -1)\r\n    }, {\r\n        name: game.i18n.localize(\"ARd20.ChatContextDoubleDamage\"),\r\n        icon: '<i class=\"fas fa-user-injured\"></i>',\r\n        condition: canApply,\r\n        //@ts-expect-error\r\n        callback: li => applyChatCardDamage(li, 2)\r\n    }, {\r\n        name: game.i18n.localize(\"ARd20.ChatContextHalfDamage\"),\r\n        icon: '<i class=\"fas fa-user-shield\"></i>',\r\n        condition: canApply,\r\n        //@ts-expect-error\r\n        callback: li => applyChatCardDamage(li, 0.5)\r\n    });\r\n    return options;\r\n};\r\n/* -------------------------------------------- */\r\n/**\r\n * Apply rolled dice damage to the token or tokens which are currently controlled.\r\n * This allows for damage to be scaled by a multiplier to account for healing, critical hits, or resistance\r\n *\r\n * @param {HTMLElement} li      The chat entry which contains the roll data\r\n * @param {Number} multiplier   A damage multiplier to apply to the rolled damage.\r\n * @return {Promise}\r\n */\r\nfunction applyChatCardDamage(li, multiplier) {\r\n    //@ts-expect-error\r\n    const message = game.messages.get(li.data(\"messageId\"));\r\n    const roll = message.roll;\r\n    return Promise.all(canvas.tokens.controlled.map(t => {\r\n        const a = t.actor;\r\n        //@ts-expect-error\r\n        return a.applyDamage(roll.total, multiplier);\r\n    }));\r\n}\r\n/* -------------------------------------------- */\r\n","// Import document classes.\r\nimport { ARd20Actor } from \"./documents/actor.js\";\r\nimport { ARd20Item } from \"./documents/item.js\";\r\n// Import sheet classes.\r\nimport { ARd20ActorSheet } from \"./sheets/actor-sheet.js\";\r\nimport { ARd20ItemSheet } from \"./sheets/item-sheet.js\";\r\n// Import helper/utility classes and constants.\r\nimport { preloadHandlebarsTemplates } from \"./helpers/templates.js\";\r\nimport { ARd20 } from \"./helpers/config.js\";\r\nimport ARd20SocketHandler from \"./helpers/socket.js\";\r\nimport { registerSystemSettings } from \"./helpers/settings.js\";\r\nimport * as dice from \"./dice/dice.js\";\r\nimport * as chat from \"./helpers/chat.js\";\r\n/* -------------------------------------------- */\r\n/*  Init Hook                                   */\r\n/* -------------------------------------------- */\r\nexport function obj_entries(obj) {\r\n  return Object.entries(obj);\r\n}\r\nexport function arr_entries(arr) {\r\n  return Object.entries(arr);\r\n}\r\nexport function getValues(SourceObject, key) {\r\n  return SourceObject[key];\r\n}\r\nexport function obj_keys(obj) {\r\n  return Object.keys(obj);\r\n}\r\nexport function array_keys(obj) {\r\n  return Object.keys(obj);\r\n}\r\nHooks.once(\"init\", async function () {\r\n  // Add utility classes to the global game object so that they're more easily\r\n  // accessible in global contexts.\r\n  if (game instanceof Game) {\r\n    game.ard20 = {\r\n      documents: {\r\n        ARd20Actor,\r\n        ARd20Item,\r\n      },\r\n      rollItemMacro,\r\n      config: ARd20,\r\n      dice: dice,\r\n    };\r\n    // Add custom constants for configuration.\r\n    CONFIG.ARd20 = ARd20;\r\n    //@ts-expect-error\r\n    CONFIG.Dice.DamageRoll = dice.DamageRoll;\r\n    //@ts-expect-error\r\n    CONFIG.Dice.D20Roll = dice.D20Roll;\r\n    CONFIG.Dice.rolls.push(dice.D20Roll);\r\n    CONFIG.Dice.rolls.push(dice.DamageRoll);\r\n    if (game.socket instanceof io.Socket) {\r\n      game.socket.on(\"system.ard20\", (data) => {\r\n        if (data.operation === \"updateActorData\") ARd20SocketHandler.updateActorData(data);\r\n      });\r\n    }\r\n    /**\r\n     * Set an initiative formula for the system\r\n     * @type {String}\r\n     */\r\n    CONFIG.Combat.initiative = {\r\n      formula: \"1d20 + @abilities.dex.mod\",\r\n      decimals: 2,\r\n    };\r\n    // Define custom Document classes\r\n    CONFIG.Actor.documentClass = ARd20Actor;\r\n    CONFIG.Item.documentClass = ARd20Item;\r\n    // Register sheet application classes\r\n    Actors.unregisterSheet(\"core\", ActorSheet);\r\n    Actors.registerSheet(\"ard20\", ARd20ActorSheet, { makeDefault: true });\r\n    Items.unregisterSheet(\"core\", ItemSheet);\r\n    //@ts-expect-error\r\n    Items.registerSheet(\"ard20\", ARd20ItemSheet, { makeDefault: true });\r\n    registerSystemSettings();\r\n    // Preload Handlebars templates.\r\n    return preloadHandlebarsTemplates();\r\n  } else {\r\n    throw new Error(\"game not initialized yet!\");\r\n  }\r\n});\r\n/* -------------------------------------------- */\r\n/*  Handlebars Helpers                          */\r\n/* -------------------------------------------- */\r\n// If you need to add Handlebars helpers, here are a few useful examples:\r\nHandlebars.registerHelper(\"concat\", function () {\r\n  var outStr = \"\";\r\n  for (var arg in arguments) {\r\n    if (typeof arguments[arg] != \"object\") {\r\n      outStr += arguments[arg];\r\n    }\r\n  }\r\n  return outStr;\r\n});\r\nHandlebars.registerHelper(\"toLowerCase\", function (str) {\r\n  return str.toLowerCase();\r\n});\r\nHandlebars.registerHelper(\"add\", function (value1, value2) {\r\n  return Number(value1) + Number(value2);\r\n});\r\n/* -------------------------------------------- */\r\n/*  Ready Hook                                  */\r\n/* -------------------------------------------- */\r\nHooks.once(\"ready\", async function () {\r\n  // Wait to register hotbar drop hook on ready so that modules could register earlier if they want to\r\n  Hooks.on(\"hotbarDrop\", (bar, data, slot) => createItemMacro(data, slot));\r\n});\r\n/* -------------------------------------------- */\r\n/*  Hotbar Macros                               */\r\n/* -------------------------------------------- */\r\n/**\r\n * Create a Macro from an Item drop.\r\n * Get an existing item macro if one exists, otherwise create a new one.\r\n * @param {Object} data     The dropped data\r\n * @param {number} slot     The hotbar slot to use\r\n * @returns {Promise}\r\n */\r\nasync function createItemMacro(data, slot) {\r\n  if (game instanceof Game) {\r\n    //@ts-expect-error\r\n    if (data.type !== \"Item\") return;\r\n    if (!(\"data\" in data) && ui.notifications instanceof Notifications)\r\n      return ui.notifications.warn(\"You can only create macro buttons for owned Items\");\r\n    //@ts-expect-error\r\n    const item = data.data;\r\n    // Create the macro command\r\n    const command = `game.ard20.rollItemMacro(\"${item.name}\");`;\r\n    let macroList = game.macros.contents.filter((m) => m.name === item.name && m?.command === command);\r\n    let macroCheck = macroList.length !== 0 ? macroList[0] : null;\r\n    if (macroCheck !== null) {\r\n      let macro = await Macro.create({\r\n        name: item.name,\r\n        type: \"script\",\r\n        img: item.img,\r\n        command: command,\r\n        flags: { \"ard20.itemMacro\": true },\r\n      });\r\n      if (macro instanceof Macro) {\r\n        game.user?.assignHotbarMacro(macro, slot);\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n}\r\n/**\r\n * Create a Macro from an Item drop.\r\n * Get an existing item macro if one exists, otherwise create a new one.\r\n * @param {string} itemName\r\n * @return {Promise}\r\n */\r\nexport function rollItemMacro(itemName) {\r\n  if (game instanceof Game) {\r\n    const speaker = ChatMessage.getSpeaker();\r\n    let actor;\r\n    if (speaker.token) actor = game.actors.tokens[speaker.token];\r\n    if (!actor && typeof speaker.actor === \"string\") actor = game.actors.get(speaker.actor);\r\n    const item = actor ? actor.items.find((i) => i.name === itemName) : null;\r\n    if (!item) return ui.notifications.warn(`Your controlled Actor does not have an item named ${itemName}`);\r\n    // Trigger the item roll\r\n    //@ts-expect-error\r\n    return item.roll();\r\n  }\r\n}\r\nHooks.on(\"renderChatMessage\", (app, html, data) => {\r\n  // Display action buttons\r\n  chat.displayChatActionButtons(app, html, data);\r\n  // Highlight critical success or failure die\r\n  chat.highlightCriticalSuccessFailure(app, html, data);\r\n  // Optionally collapse the content\r\n});\r\nHooks.on(\"getChatLogEntryContext\", chat.addChatMessageContextOptions);\r\n//@ts-expect-error\r\nHooks.on(\"renderChatLog\", (app, html, data) => ARd20Item.chatListeners(html));\r\n//@ts-expect-error\r\nHooks.on(\"renderChatPopout\", (app, html, data) => ARd20Item.chatListeners(html));\r\n","import { d20Roll } from \"../dice/dice.js\";\r\nimport { obj_entries, obj_keys, getValues } from \"../ard20.js\";\r\n/**\r\n * Extend the base Actor document by defining a custom roll data structure which is ideal for the Simple system.\r\n * @extends {Actor}\r\n */\r\nexport class ARd20Actor extends Actor {\r\n    //@ts-check\r\n    /** @override */\r\n    prepareData() {\r\n        // Prepare data for the actor. Calling the super version of this executes\r\n        // the following, in order: data reset (to clear active effects),\r\n        // prepareBaseData(), prepareEmbeddedDocuments() (including active effects),\r\n        // prepareDerivedData().\r\n        super.prepareData();\r\n        this.items.forEach((item) => item.prepareFinalAttributes());\r\n    }\r\n    /**\r\n     * @override\r\n     * Augment the basic actor data with additional dynamic data. Typically,\r\n     * you'll want to handle most of your calculated/derived data in this step.\r\n     * Data calculated in this step should generally not exist in template.json\r\n     * (such as ability modifiers rather than ability scores) and should be\r\n     * available both inside and outside of character sheets (such as if an actor\r\n     * is queried and has a roll executed directly from it).\r\n     */\r\n    prepareDerivedData() {\r\n        const actorData = this.system;\r\n        // Make separate methods for each Actor type (character, npc, etc.) to keep\r\n        // things organized.\r\n        this._prepareCharacterData(actorData);\r\n        this._prepareNpcData(actorData);\r\n    }\r\n    /**\r\n     * Prepare Character type specific data\r\n     */\r\n    _prepareCharacterData(actorData) {\r\n        if (actorData.type !== \"character\")\r\n            return;\r\n        // Make modifications to data here. For example:\r\n        const data = actorData;\r\n        const attributes = data.attributes;\r\n        const advancement = data.advancement;\r\n        const def_stats = data.defences.stats;\r\n        const def_dam = data.defences.damage;\r\n        const proficiencies = data.proficiencies;\r\n        data.mobility.value = 0;\r\n        this.itemTypes.armor.forEach((item) => {\r\n            if (item.data.type === \"armor\") {\r\n                if (item.system.equipped) {\r\n                    for (let key of obj_keys(def_dam.phys)) {\r\n                        let ph = item.system.res.phys[key];\r\n                        def_dam.phys[key].bonus += ph.type !== \"imm\" ? ph.value : 0;\r\n                        def_dam.phys[key].type = ph.type === \"imm\" ? \"imm\" : def_dam.phys[key].type;\r\n                    }\r\n                    for (let key of obj_keys(def_dam.mag)) {\r\n                        let mg = item.system.res.mag[key];\r\n                        def_dam.mag[key].bonus += mg.type !== \"imm\" ? mg.value : 0;\r\n                        def_dam.mag[key].type = mg.type === \"imm\" ? \"imm\" : def_dam.mag[key].type;\r\n                    }\r\n                    data.mobility.value += item.system.mobility.value;\r\n                }\r\n            }\r\n        });\r\n        data.mobility.value += data.mobility.bonus;\r\n        // Loop through ability scores, and add their modifiers to our sheet output.\r\n        for (let ability of Object.values(attributes)) {\r\n            // Calculate the modifier using d20 rules.\r\n            ability.total = ability.value + ability.bonus;\r\n            ability.mod = Math.floor((ability.value - 10) / 2);\r\n        }\r\n        let dexMod = data.mobility.value < 10\r\n            ? attributes.dex.mod\r\n            : data.mobility.value < 16\r\n                ? Math.min(2, attributes.dex.mod)\r\n                : Math.min(0, attributes.dex.mod);\r\n        //calculate level and expierence\r\n        const levels = CONFIG.ARd20.CHARACTER_EXP_LEVELS;\r\n        if (advancement.xp.used) {\r\n            advancement.xp.used = advancement.xp.used ?? 0;\r\n        }\r\n        for (let i = 1; i < 21; i++) {\r\n            if (advancement.xp.used >= levels[i - 1] && advancement.xp.used < levels[i]) {\r\n                advancement.level = i;\r\n                advancement.xp.level = levels[i];\r\n                advancement.xp.level_min = levels[i - 1];\r\n            }\r\n        }\r\n        advancement.xp.bar_max = advancement.xp.level - advancement.xp.level_min;\r\n        advancement.xp.bar_min = advancement.xp.used - advancement.xp.level_min;\r\n        def_stats.reflex.value = 10 + 4 * def_stats.reflex.level + dexMod + attributes.int.mod + def_stats.reflex.bonus;\r\n        def_stats.reflex.label = \"Reflex\";\r\n        def_stats.fortitude.value =\r\n            10 + 4 * def_stats.fortitude.level + attributes.str.mod + attributes.con.mod + def_stats.fortitude.bonus;\r\n        def_stats.fortitude.label = \"Fortitude\";\r\n        def_stats.will.value =\r\n            10 + 4 * def_stats.will.level + attributes.wis.mod + attributes.cha.mod + def_stats.will.bonus;\r\n        def_stats.will.label = \"Will\";\r\n        for (let [key, dr] of obj_entries(CONFIG.ARd20.DamageSubTypes)) {\r\n            if (!(key === \"force\" || key === \"radiant\" || key === \"psychic\")) {\r\n                def_dam.phys[key].value =\r\n                    def_dam.phys[key]?.value || def_dam.phys[key]?.type !== \"imm\"\r\n                        ? Math.max(isNaN(def_dam.phys[key]?.value) ? 0 : def_dam.phys[key].value) + def_dam.phys[key]?.bonus\r\n                        : 0;\r\n                def_dam.phys[key].name =\r\n                    game.i18n.localize(CONFIG.ARd20.DamageSubTypes[key]) ?? CONFIG.ARd20.DamageSubTypes[key];\r\n            }\r\n            def_dam.mag[key].value =\r\n                def_dam.mag[key]?.value || def_dam.mag[key]?.type !== \"imm\"\r\n                    ? Math.max(isNaN(def_dam.mag[key]?.value) ? 0 : def_dam.mag[key].value) + def_dam.mag[key]?.bonus\r\n                    : 0;\r\n            def_dam.mag[key].name = game.i18n.localize(CONFIG.ARd20.DamageSubTypes[key]) ?? CONFIG.ARd20.DamageSubTypes[key];\r\n        }\r\n        //calculate rolls for character's skills\r\n        for (let [key, skill] of obj_entries(data.skills)) {\r\n            skill.level = skill.level < 4 ? skill.level : 4;\r\n            skill.value = skill.level * 4 + skill.bonus;\r\n            skill.name = game.i18n.localize(CONFIG.ARd20.Skills[key]) ?? CONFIG.ARd20.Skills[key];\r\n            skill.rankName =\r\n                game.i18n.localize(getValues(CONFIG.ARd20.Rank, skill.level)) ?? getValues(CONFIG.ARd20.Rank, skill.level);\r\n        }\r\n        proficiencies.weapon = game.settings.get(\"ard20\", \"proficiencies\").weapon.map((setting, key) => {\r\n            return { ...setting, value: proficiencies.weapon[key]?.value ?? 0 };\r\n        });\r\n        data.speed.value = this.itemTypes.race[0]?.data.type === \"race\" ? this.itemTypes.race[0].system.speed : 0;\r\n        data.speed.value += attributes.dex.mod + data.speed.bonus;\r\n    }\r\n    /**\r\n     * Prepare NPC type specific data.\r\n     */\r\n    _prepareNpcData(actorData) {\r\n        //@ts-expect-error\r\n        if (actorData.type !== \"npc\")\r\n            return;\r\n        // Make modifications to data here. For example:\r\n        const data = actorData.data;\r\n        //@ts-expect-error\r\n        data.xp = data.cr * data.cr * 100;\r\n    }\r\n    /**\r\n     * Override getRollData() that's supplied to rolls.\r\n     */\r\n    getRollData() {\r\n        const data = super.getRollData();\r\n        // Prepare character roll data.\r\n        return data;\r\n    }\r\n    /**\r\n     * Roll an Ability Test\r\n     * Prompt the user for input regarding Advantage/Disadvantage and any Situational Bonus\r\n     * @param {Number} attributeId    The ability ID (e.g. \"str\")\r\n     * @param {Object} options      Options which configure how ability tests are rolled\r\n     * @return {Promise<Roll>}      A Promise which resolves to the created Roll instance\r\n     */\r\n    rollAbilityTest(attributeId, options) {\r\n        const label = game.i18n.localize(getValues(CONFIG.ARd20.Attributes, attributeId));\r\n        const actorData = this.system;\r\n        const attributes = actorData.attributes;\r\n        const attr = getValues(attributes, attributeId);\r\n        // Construct parts\r\n        const parts = [\"@mod\"];\r\n        const data = { mod: attr };\r\n        // Add provided extra roll parts now because they will get clobbered by mergeObject below\r\n        if (options.parts.length > 0) {\r\n            parts.push(...options.parts);\r\n        }\r\n        // Roll and return\r\n        const rollData = foundry.utils.mergeObject(options, {\r\n            parts: parts,\r\n            data: data,\r\n            title: game.i18n.format(\"ARd20.AttributePromptTitle\", { attribute: label }),\r\n            messageData: {\r\n                speaker: options.speaker || ChatMessage.getSpeaker({ actor: this }),\r\n                \"flags.ard20.roll\": { type: \"attribute\", attributeId },\r\n            },\r\n        });\r\n        //@ts-expect-error\r\n        return d20Roll(rollData);\r\n    }\r\n    /**\r\n     * Roll a Skill Check\r\n     * Prompt the user for input regarding Advantage/Disadvantage and any Situational Bonus\r\n     * @param {string} skillId      The skill id (e.g. \"ins\")\r\n     * @param {Object} options      Options which configure how the skill check is rolled\r\n     * @return {Promise<Roll>}      A Promise which resolves to the created Roll instance\r\n     */\r\n    rollSkill(skillId, options) {\r\n        const skl = getValues(this.system.skills, skillId);\r\n        // Compose roll parts and data\r\n        const parts = [\"@proficiency\", \"@mod\"];\r\n        const data = { attributes: this.getRollData().attributes, proficiency: skl.value };\r\n        // Add provided extra roll parts now because they will get clobbered by mergeObject below\r\n        if (options.parts.length > 0) {\r\n            parts.push(...options.parts);\r\n        }\r\n        // Roll and return\r\n        const rollData = foundry.utils.mergeObject(options, {\r\n            parts: parts,\r\n            data: data,\r\n            title: game.i18n.format(\"ARd20.SkillPromptTitle\", {\r\n                skill: game.i18n.localize(getValues(CONFIG.ARd20.Skills, skillId)),\r\n            }),\r\n            messageData: {\r\n                speaker: options.speaker || ChatMessage.getSpeaker({ actor: this }),\r\n                \"flags.ard20.roll\": { type: \"skill\", skillId },\r\n            },\r\n            chooseModifier: true,\r\n        });\r\n        //@ts-expect-error\r\n        return d20Roll(rollData);\r\n    }\r\n}\r\n","// Import document classes.\r\nimport { ARd20Actor } from \"../built/documents/actor.js\";\r\nimport { ARd20Item } from \"../built/documents/item.js\";\r\n// Import sheet classes.\r\nimport { ARd20ActorSheet } from \"../built/sheets/actor-sheet.js\";\r\nimport { ARd20ItemSheet } from \"../built/sheets/item-sheet.js\";\r\n// Import helper/utility classes and constants.\r\nimport { preloadHandlebarsTemplates } from \"../built/helpers/templates.js\";\r\nimport { ARd20 } from \"../built/helpers/config.js\";\r\nimport ARd20SocketHandler from \"../built/helpers/socket.js\";\r\nimport { registerSystemSettings } from \"../built/helpers/settings.js\";\r\nimport * as dice from \"../built/dice/dice.js\";\r\nimport * as chat from \"../built/helpers/chat.js\";\r\n/* -------------------------------------------- */\r\n/*  Init Hook                                   */\r\n/* -------------------------------------------- */\r\nexport function obj_entries(obj) {\r\n    return Object.entries(obj);\r\n}\r\nexport function arr_entries(arr) {\r\n    return Object.entries(arr);\r\n}\r\nexport function getValues(SourceObject, key) {\r\n    return SourceObject[key];\r\n}\r\nexport function obj_keys(obj) {\r\n    return Object.keys(obj);\r\n}\r\nexport function array_keys(obj) {\r\n    return Object.keys(obj);\r\n}\r\nHooks.once(\"init\", async function () {\r\n    // Add utility classes to the global game object so that they're more easily\r\n    // accessible in global contexts.\r\n    if (game instanceof Game) {\r\n        game.ard20 = {\r\n            documents: {\r\n                ARd20Actor,\r\n                ARd20Item,\r\n            },\r\n            rollItemMacro,\r\n            config: ARd20,\r\n            dice: dice,\r\n        };\r\n        // Add custom constants for configuration.\r\n        CONFIG.ARd20 = ARd20;\r\n        //@ts-expect-error\r\n        CONFIG.Dice.DamageRoll = dice.DamageRoll;\r\n        //@ts-expect-error\r\n        CONFIG.Dice.D20Roll = dice.D20Roll;\r\n        CONFIG.Dice.rolls.push(dice.D20Roll);\r\n        CONFIG.Dice.rolls.push(dice.DamageRoll);\r\n        if (game.socket instanceof io.Socket) {\r\n            game.socket.on(\"system.ard20\", (data) => {\r\n                if (data.operation === \"updateActorData\")\r\n                    ARd20SocketHandler.updateActorData(data);\r\n            });\r\n        }\r\n        /**\r\n         * Set an initiative formula for the system\r\n         * @type {String}\r\n         */\r\n        CONFIG.Combat.initiative = {\r\n            formula: \"1d20 + @abilities.dex.mod\",\r\n            decimals: 2,\r\n        };\r\n        // Define custom Document classes\r\n        CONFIG.Actor.documentClass = ARd20Actor;\r\n        CONFIG.Item.documentClass = ARd20Item;\r\n        // Register sheet application classes\r\n        Actors.unregisterSheet(\"core\", ActorSheet);\r\n        Actors.registerSheet(\"ard20\", ARd20ActorSheet, { makeDefault: true });\r\n        Items.unregisterSheet(\"core\", ItemSheet);\r\n        //@ts-expect-error\r\n        Items.registerSheet(\"ard20\", ARd20ItemSheet, { makeDefault: true });\r\n        registerSystemSettings();\r\n        // Preload Handlebars templates.\r\n        return preloadHandlebarsTemplates();\r\n    }\r\n    else {\r\n        throw new Error(\"game not initialized yet!\");\r\n    }\r\n});\r\n/* -------------------------------------------- */\r\n/*  Handlebars Helpers                          */\r\n/* -------------------------------------------- */\r\n// If you need to add Handlebars helpers, here are a few useful examples:\r\nHandlebars.registerHelper(\"concat\", function () {\r\n    var outStr = \"\";\r\n    for (var arg in arguments) {\r\n        if (typeof arguments[arg] != \"object\") {\r\n            outStr += arguments[arg];\r\n        }\r\n    }\r\n    return outStr;\r\n});\r\nHandlebars.registerHelper(\"toLowerCase\", function (str) {\r\n    return str.toLowerCase();\r\n});\r\nHandlebars.registerHelper(\"add\", function (value1, value2) {\r\n    return Number(value1) + Number(value2);\r\n});\r\n/* -------------------------------------------- */\r\n/*  Ready Hook                                  */\r\n/* -------------------------------------------- */\r\nHooks.once(\"ready\", async function () {\r\n    // Wait to register hotbar drop hook on ready so that modules could register earlier if they want to\r\n    Hooks.on(\"hotbarDrop\", (bar, data, slot) => createItemMacro(data, slot));\r\n});\r\n/* -------------------------------------------- */\r\n/*  Hotbar Macros                               */\r\n/* -------------------------------------------- */\r\n/**\r\n * Create a Macro from an Item drop.\r\n * Get an existing item macro if one exists, otherwise create a new one.\r\n * @param {Object} data     The dropped data\r\n * @param {number} slot     The hotbar slot to use\r\n * @returns {Promise}\r\n */\r\nasync function createItemMacro(data, slot) {\r\n    if (game instanceof Game) {\r\n        //@ts-expect-error\r\n        if (data.type !== \"Item\")\r\n            return;\r\n        if (!(\"data\" in data) && ui.notifications instanceof Notifications)\r\n            return ui.notifications.warn(\"You can only create macro buttons for owned Items\");\r\n        //@ts-expect-error\r\n        const item = system;\r\n        // Create the macro command\r\n        const command = `game.ard20.rollItemMacro(\"${item.name}\");`;\r\n        let macroList = game.macros.contents.filter((m) => m.name === item.name && m?.command === command);\r\n        let macroCheck = macroList.length !== 0 ? macroList[0] : null;\r\n        if (macroCheck !== null) {\r\n            let macro = await Macro.create({\r\n                name: item.name,\r\n                type: \"script\",\r\n                img: item.img,\r\n                command: command,\r\n                flags: { \"ard20.itemMacro\": true },\r\n            });\r\n            if (macro instanceof Macro) {\r\n                game.user?.assignHotbarMacro(macro, slot);\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\n/**\r\n * Create a Macro from an Item drop.\r\n * Get an existing item macro if one exists, otherwise create a new one.\r\n * @param {string} itemName\r\n * @return {Promise}\r\n */\r\nexport function rollItemMacro(itemName) {\r\n    if (game instanceof Game) {\r\n        const speaker = ChatMessage.getSpeaker();\r\n        let actor;\r\n        if (speaker.token)\r\n            actor = game.actors.tokens[speaker.token];\r\n        if (!actor && typeof speaker.actor === \"string\")\r\n            actor = game.actors.get(speaker.actor);\r\n        const item = actor ? actor.items.find((i) => i.name === itemName) : null;\r\n        if (!item)\r\n            return ui.notifications.warn(`Your controlled Actor does not have an item named ${itemName}`);\r\n        // Trigger the item roll\r\n        //@ts-expect-error\r\n        return item.roll();\r\n    }\r\n}\r\nHooks.on(\"renderChatMessage\", (app, html, data) => {\r\n    // Display action buttons\r\n    chat.displayChatActionButtons(app, html, data);\r\n    // Highlight critical success or failure die\r\n    chat.highlightCriticalSuccessFailure(app, html, data);\r\n    // Optionally collapse the content\r\n});\r\nHooks.on(\"getChatLogEntryContext\", chat.addChatMessageContextOptions);\r\n//@ts-expect-error\r\nHooks.on(\"renderChatLog\", (app, html, data) => ARd20Item.chatListeners(html));\r\n//@ts-expect-error\r\nHooks.on(\"renderChatPopout\", (app, html, data) => ARd20Item.chatListeners(html));\r\n"],"names":["D20Roll","Roll","constructor","formula","data","options","terms","Die","faces","Error","_formula","configureModifiers","hasAdvantage","advantageMode","ADV_MODE","ADVANTAGE","hasDisadvantage","DISADVANTAGE","d20","modifiers","number","push","advantage","disadvantage","critical","fumble","targetValue","target","getFormula","toMessage","messageData","_evaluated","evaluate","async","flavor","game","i18n","localize","rollMode","configureDialog","title","string","defaultRollMode","canMult","boolean","defaultAction","NORMAL","mRoll","chooseModifier","defaultAttribute","template","content","renderTemplate","EVALUATION_TEMPLATE","rollModes","CONFIG","Dice","attributes","ARd20","Attributes","defaultButton","Promise","resolve","Dialog","buttons","label","callback","html","_onDialogSubmit","normal","default","close","render","form","querySelector","console","log","bonus","value","OperatorTerm","operator","concat","ability","abl","findSplice","t","term","NumericTerm","mod","checked","DamageRoll","undefined","configureDamage","isCritical","critBonus","i","entries","damageType","DiceTerm","baseNumber","oper","num","splice","cb","criticalBonusDice","alter","multiplyNumeric","criticalMultiplier","damType","defaultCritical","allowCritical","condition","forEach","part","ind","fromData","roll","simplifyRollFormula","constantFirst","some","_isUnsupportedTerm","rollableTerms","constantTerms","operators","constantFormula","rollableFormula","constantPart","safeEval","err","warn","parts","filterJoin","diceTerm","includes","d20Roll","fastForward","event","dialogOptions","chatMessage","speaker","join","isFF","_determineAdvantageMode","settings","get","configured","defaultAbility","item","shiftKey","altKey","ctrlKey","metaKey","damageRoll","_determineCriticalMode","ARd20Item","Item","prepareData","prepareDerivedData","itemData","system","_prepareSpellData","_prepareWeaponData","_prepareFeatureData","_prepareRaceData","_prepareArmorData","hasAttack","_prepareAttack","hasDamage","_prepareDamage","isOwned","prepareFinalAttributes","type","flags","_setTypeAndSubtype","key","obj_entries","damage","prof","Array","isArray","sub","length","sub_type_array","weapon","filter","core","sourceId","id","exec","items","sub_type","name","proficiency","getValues","Rank","level","source","Source","has","max","initial","Math","min","current","n","k","round","Number","abs","toPrecision","sign","xp","basicCost","AdvancedCost","req","Object","values","pass","from","v","Skills","logic","dr","DamageSubTypes","res","phys","mag","mobility","HeavyPoints","slot","abil","getProperty","actor","prof_bonus","proficiencies","pr","levelName","dex","atkMod","attack","str","prop","baseDamage","getRollData","rollData","foundry","utils","deepClone","damageDie","createMessage","iData","ChatMessage","getSpeaker","targets","user","displayCard","chatListeners","on","_onChatCardAction","bind","_onChatCardToggleContent","_rollDamage","preventDefault","element","closest","classList","toggle","button","currentTarget","card","messageId","dataset","message","messages","action","targetUuid","targetId","isTargetted","isGM","isAuthor","_getChatCardActor","storedData","getFlag","parent","itemId","ui","notifications","error","format","spellLevel","parseInt","dam","rollDamage","versatile","$","find","replaceWith","update","outerHTML","rollFormula","_getChatCardTargets","token","scene","canvas","rollAbilitySave","rollToolCheck","ard20","AbilityTemplate","fromItem","drawPreview","disabled","header","style","display","_applyDamage","tData","tHealth","tActor","total","defences","obj","socket","emit","operation","fromUuid","health","damHTML","append","remove","tokenId","actorId","actors","tokens","controlled","character","getActiveTokens","Boolean","atk","dc","atkHTML","dmgHTML","result","hit","dmg","dieResultCss","def","atkRoll","rollAttack","dmgRoll","stats","keys","reroll","size","templateData","uuid","getChatData","labels","owner","isOwner","chatData","_id","CONST","CHAT_MESSAGE_TYPES","OTHER","chatFlavor","applyRollMode","create","htmlOptions","getAttackToHit","rollConfig","width","mergeObject","map","d","c","a","DamageTypes","b","altkey","attackBonus","toHit","test","create_if_block_1","create_if_block","typeStr","AttributeComp","SkillComp","onManageActiveEffect","li","effect","effectId","effects","createEmbeddedDocuments","icon","origin","effectType","sheet","delete","prepareActiveEffectCategories","categories","temporary","passive","inactive","e","_getSourceName","isTemporary","CharacterAdvancement","FormApplication","defaultOptions","classes","height","tabs","navSelector","contentSelector","closeOnSubmit","InitilizeData","pack","getPacks","folder","getFolders","rList","getRacesList","fList","getFeaturesList","actorData","object","startingData","isReady","duplicate","skills","advancement","profs","races","list","chosen","count","feats","mar","div","pri","psy","learned","learnedFeatures","awail","temp_feat_list","allow","attribute","race","final","hover","skill","feat","used","awailFeats","name_array","val","TextEditor","enrichHTML","description","pack_list","pack_name","packs","metadata","feat_list","documentName","index","flat","new_key","package","doc","getDocument","toObject","folder_list","folder_name","folders","contents","race_pack_list","race_folder_list","raceItem","feat_pack_list","FeatureItem","currentXP","isEq","isXP","feat_folder_list","itemTypes","feature","_objectSpread","getData","raceList","raceChosen","featsAwail","featsLearned","all","reduce","race_abil","floor","AbilXP","rankName","SkillXP","value_hover","allCount","featCount","ceil","r","_item","input","featLevel","exp","lev_array","match","f","replace","filtrex","compileExpression","raceHP","con","abil_sum","allow_list","activateListeners","_onChange","_onHover","_onChangeInput","table","tr","trDOM","querySelectorAll","tdDesc","bColor","window","getComputedStyle","getPropertyValue","td","nextElementSibling","previousElementSibling","th","tab","hover_desc","_updateObject","_event","formData","updateData","expandObject","feats_data","new","exist","awItem","_index","learnedItem","slice","race_list","updateEmbeddedDocuments","ARd20ActorSheet","ActorSheet","context","config","_prepareItems","_prepareCharacterData","rank_name","rank","gear","features","weapons","armor","spells","img","DEFAULT_TOKEN","isActive","toggleClass","toggleTitle","equipped","select2","click","_onToggleItem","ev","parents","isEditable","_onItemCreate","slideUp","_onRollAbilityTest","_onRollSkillCheck","_OnAdvanceMenu","_onItemRoll","handler","_onDragStart","each","contains","setAttribute","addEventListener","modal","draggable","zIndex","class","CharacterAdvancementShell","props","document","TJSDialog","focus","itemid","attr","parentElement","rollAbilityTest","rollSkill","capitalize","_onRoll","rollType","_onDrop","JSON","parse","dataTransfer","allowed","Hooks","call","_onDropActiveEffect","_onDropActor","_onDropItem","_onDropFolder","FeatRequirements","InitializeData","reqValues","reqLogic","formApp","subtype_list","inputElement","previousElement","maxLevel","featList","getFeats","arr","assign","type_list","indexOf","featAwail","featCurrent","entity","_onAdd","_Delete","sub_list","defaultValue","fill","order","_getSubmitData","ARd20ItemSheet","ItemSheet","path","fd","FormDataExtended","editors","flattenObject","edit","formatSelection","state","text","optgroup","subtype","url","formatResult","theme","dropdownAutoWidth","templateSelection","templateResult","escapeMarkup","m","trigger","evt","params","originalEvent","stopPropagation","_FeatReq","_onDamageControl","app","partsPath","damTypePath","damagePart","_onSubmit","args","_tabs","active","position","preloadHandlebarsTemplates","loadTemplates","int","wis","cha","AttributeAbbreviations","CHARACTER_EXP_LEVELS","SpellSchool","abj","enc","evo","ill","nec","trs","acr","ani","arc","ath","dec","his","ins","itm","inv","med","nat","prc","prf","per","rel","slt","ste","sur","WeaponProp","aff","awk","bra","dis","dou","ent","fin","fir","hea","lau","lig","lun","mel","one","pen","ran","rea","sta","thr","tri","two","ver","WeaponType","amb","axe","blu","bow","sli","cbl","cro","dbl","fla","whi","ham","pic","pol","spe","acid","bludgeoning","cold","fire","force","lightning","necr","piercing","poison","slashing","radiant","psychic","ResistTypes","vul","imm","HPDice","light","chest","gloves","boots","pants","head","medium","heavy","RollResult","ARd20SocketHandler","updateActorData","AdvRateSettingsShim","AdvancementRateFormApp","SvelteApplication","minimizable","resizable","svelte","AdvancementRateShell","body","FeatSettingsShim","FeatSetting","FeatSettingShell","ProfSettingsShim","ProfSetting","ProfSettingShell","registerSystemSettings","register","scope","tool","onChange","registerMenu","restricted","variables","skillCount","shortName","longName","featureCount","skillValue","featureLevel","attributeValue","formulas","ProfFormApp","submitOnChange","sheetData","set","dirty","fieldName","propertyName","split","highlightCriticalSuccessFailure","isRoll","isContentVisible","dice","isD20","isModifiedRoll","results","marginSuccess","marginFailure","addClass","displayChatActionButtons","chatCard","author","btn","addChatMessageContextOptions","canApply","applyChatCardDamage","multiplier","applyDamage","SourceObject","obj_keys","once","Game","documents","ARd20Actor","rollItemMacro","rolls","io","Socket","Combat","initiative","decimals","Actor","documentClass","Actors","unregisterSheet","registerSheet","makeDefault","Items","Handlebars","registerHelper","outStr","arg","arguments","toLowerCase","value1","value2","bar","createItemMacro","Notifications","command","macroList","macros","macroCheck","macro","Macro","assignHotbarMacro","itemName","chat","_prepareNpcData","def_stats","def_dam","ph","mg","dexMod","levels","level_min","bar_max","bar_min","reflex","fortitude","will","isNaN","setting","speed","cr","attributeId","skillId","skl","arr_entries","array_keys"],"mappings":"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"}