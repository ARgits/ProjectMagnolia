<form>
    <header>
        <div {{#unless isReady}} class="grid grid-2col" {{/unless}}>
            <div>
                <div>
                    <label class="" for="xp.get">XP you earn</label>
                    <input type="number" class="" value="{{xp.get}}" name="xp.get" readonly />
                </div>
                <div>
                    <label class="" for="xp.used">XP you spent</label>
                    <input type="number" class="" value="{{xp.used}}" name="xp.used" readonly />
                </div>
            </div>
            {{#unless isReady}}
                <aside>
                    <div>Attributes {{#if allow.ability}}<i class=" check fas fa-check"></i>{{else}}<i class="check fas fa-times"></i>{{/if}}</div>
                    <div>Race {{#if allow.race}}<i class="check fas fa-check"></i>{{else}}<i class="check fas fa-times"></i>{{/if}}</div>
                    <div>Final {{#if allow.final}}<i class="check fas fa-check"></i>{{else}}<i class="check fas fa-times"></i>{{/if}}</div>
                </aside>
            {{/unless}}
        </div>
    </header>
    <hr>
    <nav class="sheet-tabs tabs" data-group="primary-tabs">
        <a data-tab="stats">Stats</a>
        {{#unless isReady}}
            <a data-tab="race">Race</a>
        {{/unless}}
        <a data-tab="skills">Skills</a>
        <a data-tab="profs">proficiencies</a>
        <a data-tab="feats">Features</a>
    </nav>
    <hr>

    <section class="sheet-body">
        <div class="tab" data-tab="stats" data-group="primary-tabs">
            <table>
                <tr>
                    <td>Name</td>
                    <td>Decrease</td>
                    <td>Value</td>
                    <td>Modifier</td>
                    <td>Increase</td>
                    <td>XP cost</td>
                </tr>
                {{#each abilities as |ability key|}}
                    <tr>
                        <td><label for="abilities.{{key}}.value" data-label="{{ability.label}}">{{ability.label}}</label></td>
                        <td><button class="change far fa-arrow-alt-circle-down" data-type="ability" type="button" {{#if ability.isEq}} disabled {{/if}} data-action="minus" data-key="{{key}}"></button></td>
                        <td><input readonly type="number" class="" value={{ability.value}} name="abilities.{{key}}.value" /></td>
                        <td><span name="abilities.{{key}}.mod">{{numberFormat ability.mod decimals=0 sign=true}}</span></td>
                        <td><button class="change far fa-arrow-alt-circle-up" data-type="ability" type="button" data-action="plus" data-key="{{key}}" {{#if ability.isXP}} disabled{{/if}}></button></td>
                        <td><span name="abilities.{{key}}.xp">{{numberFormat ability.xp decimals=0 sign=false}}</span></td>
                    </tr>
                {{/each}}
            </table>
        </div>
        <div class="tab" data-tab="race" data-group="primary-tabs">
            <div class="flexcol">
                <ol class="">
                    <li class="flexrow">
                        <div>Choose</div>
                        <div>Race</div>
                        <div>Staring HP</div>
                        <div class="item-description-3">Race description</div>
                    </li>
                    <div class="grid grid-2col">
                        <div>
                            {{#each races.list as |race key|}}
                                <li class="flexrow ">
                                    <div class=""><input name="race.chosen" type="radio" data-key="{{key}}" data-type="race" value="{{race._id}}" id="{{race._id}}" {{checked race.chosen}} /></div>
                                    <div class="">{{race.name}}</div>
                                    <div class="">{{race.data.startHP}}</div>
                                </li>
                            {{/each}}
                        </div>
                        <aside class="">race description</aside>
                    </div>
                </ol>
            </div>
        </div>
        <div class="tab" data-tab="skills" data-group="primary-tabs">
            <ol class="flexcol ">
                <li class="flexrow">
                    <div>Name</div>
                    <div>Decrease rank</div>
                    <div>Rank</div>
                    <div>Increase rank</div>
                    <div>XP cost</div>
                    <div class="item-description-6">Description</div>
                </li>
                <div class="grid grid-2col">
                    <div>
                        {{#each skills as |skill key|}}
                            <li class="flexrow">
                                <div class=""><label for="skills.{{key}}.prof" class="skill" data-type="skill" data-label="{{skill.label}}">{{skill.label}}</label></div>
                                <div class=""><button class="change far fa-arrow-alt-circle-down" data-type="skill" type="button" {{#if skill.isEq}}disabled{{/if}} data-action="minus" data-key="{{key}}"></button></div>
                                <input hidden name="skills.{{key}}.prof" value={{skill.prof}} type="number" />
                                <div class=""><label for="skills.{{key}}.prof" class="" data-label="{{skill.hover}}">{{skill.hover}}</label></div>
                                <div class=""><button class="change far fa-arrow-alt-circle-up" data-type="skill" type="button" {{#if skill.isXP}}disabled{{/if}} data-action="plus" data-key="{{key}}"></button></div>
                                <div class="">{{#if skill.xp}}<span class="" name="skills.{{key}}.xp">{{numberFormat skill.xp decimals=0 sign=false}}</span>{{/if}}</div>
                        {{/each}}
                    </div>
                    <aside class="">{{{hover.value}}}</aside>
                </div>
            </ol>
        </div>
        <div class="tab" data-tab="profs" data-group="primary-tabs">
            <div>
                <div class="">
                    {{#each profs.weapon as |prof key|}}
                        <div class="flexrow grid grid-7col">
                            <label for="profs.weapon.{{key}}.value" class="prof" data-type="prof" data-label="{{prof.name}}">{{prof.name}}</label>
                            <label for="profs.weapon.{{key}}.value" class="prof" data-type="prof" data-label="{{prof.type}}">{{prof.type_hover}}</label>
                            <button class="change far fa-arrow-alt-circle-down" data-type="prof" type="button" {{#if prof.isEq}}disabled{{/if}} data-action="minus" data-key="{{key}}"></button>
                            <input hidden name="profs.weapon.{{key}}.value" value="{{prof.value}}" type="number" />
                            <label for="profs.weapon.{{key}}.value" class="" data-label="{{prof.hover}}">{{prof.value_hover}}</label>
                            <button class="change far fa-arrow-alt-circle-up" data-type="prof" type="button" {{#if prof.isXP}}disabled{{/if}} data-action="plus" data-key="{{key}}"></button>
                            {{#if prof.xp}}<span class="ability" name="profs.weapon.{{key}}.xp">{{numberFormat prof.xp decimals=0 sign=false}}</span>{{/if}}
                        </div>
                    {{/each}}
                </div>
            </div>
        </div>
        <div class="tab" data-tab="feats" data-group="primary-tabs">
            <ol class="flexcol">
                <li class="flexrow">
                    <div class="">Name</div>
                    <div class="">Source</div>
                    <div class="">Decrease level</div>
                    <div class="">Current Level</div>
                    <div class="">Maximum Level</div>
                    <div class="">Increase level</div>
                    <div class="">XP cost</div>
                    <div class="item-description-8">Description</div>
                </li>
                <div class="grid grid-2col">
                    <div>
                        {{#each feats.awail as |feat key|}}
                            <li class="item flexrow">
                                <div class="">{{feat.name}}</div>
                                <div class="">{{feat.data.source.label}}</div>
                                <div class=""><button class="change fas fa-minus-square" data-type="feat" type="button" {{#if feat.isEq}}disabled{{/if}} data-action="minus" data-key="{{key}}"></button></div>
                                <input hidden name="feats.awail.{{key}}.id" value="{{feat.id}}" type="text" />
                                <div class=""><input readonly type="number" value="{{feat.data.level.initial}}" name="feats.awail.{{key}}.data.level.initial" /></div>
                                <div class=""><input readonly type="number" value="{{feat.data.level.max}}" name="feats.awail.{{key}}.data.level.max" /></div>
                                <div class=""><button class="change fas fa-plus-square" data-type="feat" type="button" {{#if feat.isXP}}disabled{{/if}} data-action="plus" data-key="{{key}}"></button></div>
                                <div class="">{{#if (lt feat.data.level.initial feat.data.level.max)}}<span class="" name="feats.{{key}}.data.level.xp.{{feat.data.level.initial}}">{{numberFormat feat.data.current_xp decimals=0 sign=false}}</span>{{/if}}</div>
                            </li>
                        {{/each}}
                    </div>
                    <div>blank for feature description</div>
                </div>
            </ol>
        </div>
    </section>
    <hr>
    <footer>
        <button type="submit" name="submit" value="1">
            <i class="far fa-save"></i> Submit
        </button>
    </footer>
</form>
