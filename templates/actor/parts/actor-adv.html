<form>
    <header>
        <div {{#unless isReady}} class="grid grid-2col" {{/unless}}>
            <div>
                <div>
                    <label class='resource-label flexlarge align-left' for='xp.get'>XP you earn</label>
                    <input type='number' class='ability' value={{xp.get}} name='xp.get' readonly />
                </div>
                <div>
                    <label class='resource-label flexlarge align-left' for='xp.used'>XP you spent</label>
                    <input type='number' class='ability' value={{xp.used}} name='xp.used' readonly />
                </div>
            </div>
            {{#unless isReady}}
                <aside>
                    <div>Attributes {{#if allow.ability}}<i class=" check fas fa-check"></i>{{else}}<i class="check fas fa-times"></i>{{/if}}</div>
                    <div>Race {{#if allow.race}}<i class="check fas fa-check"></i>{{else}}<i class="check fas fa-times"></i>{{/if}}</div>
                    <div>Final {{#if allow.final}}<i class="check fas fa-check"></i>{{else}}<i class="check fas fa-times"></i>{{/if}}</div>
                </aside>
            {{/unless}}
        </div>
    </header>
    <hr>
    <nav class="sheet-tabs tabs" data-group="primary-tabs">
        <a class="item" data-tab="stats">Stats</a>
        {{#unless isReady}}
            <a class="item" data-tab="race">Race</a>
        {{/unless}}
        <a class="item" data-tab='skills'>Skills</a>
        <a class='item' data-tab="profs">proficiencies</a>
        <a class='item' data-tab='feats'>Features</a>
    </nav>
    <hr>

    <section class="sheet-body">
        <div class="tab" data-tab="stats" data-group="primary-tabs">
            <ol class='items-list'>
                <li class="items-header flexrow">
                    <div>Name</div>
                    <div>Decrease</div>
                    <div>Value</div>
                    <div>Modifier</div>
                    <div>Increase</div>
                    <div>XP cost</div>
                </li>
                {{#each abilities as |ability key|}}
                    <li class="item flexrow align-center">
                        <div class="item-prop"><label for="abilities.{{key}}.value" data-label="{{ability.label}}">{{ability.label}}</label></div>
                        <div class="item-prop"><button class="change far fa-arrow-alt-circle-down" data-type='ability' type='button' {{#if ability.isEq}} disabled {{/if}} data-action='minus' data-key='{{key}}'></button></div>
                        {{#unless @root.isReady}}
                            <div class="item-prop grid grid-2col">
                        {{/unless}}
                        <div class="item-prop"><input readonly type='number' class="ability align-center" value={{ability.value}} name='abilities.{{key}}.value' /></div>
                        {{#unless @root.isReady}}
                            <div><input readonly type='number' class="ability align-center" value={{ability.final}} name='abilities.{{key}}.final' /></div>
        </div>{{/unless}}
        <div class="item-prop"><span name='abilities.{{key}}.mod'>{{numberFormat ability.mod decimals=0 sign=true}}</span></div>
        <div class="item-prop"><button class="change far fa-arrow-alt-circle-up" data-type='ability' type='button' data-action='plus' data-key='{{key}}' {{#if ability.isXP}} disabled{{/if}}></button></div>
        <div class="item-prop"><span name='abilities.{{key}}.xp'>{{numberFormat ability.xp decimals=0 sign=false}}</span></div>
        </li>
        {{/each}}
        </ol>
        </div>
        <div class='tab' data-tab="race" data-group="primary-tabs">
            <div class="flexcol">
                <ol class="items-list ">
                    <li class="items-header flexrow">
                        <div>Choose</div>
                        <div>Race</div>
                        <div>Staring HP</div>
                        <div class="stretch" style="--count:3">Race description</div>
                    </li>
                    <li>
                        <div class="grid grid-2col">
                            <div>
                                {{#each races.list as |race key|}}
                                    <li class="item flexrow align-center">
                                        <div class="item-prop"><input name="race.chosen" type="radio" data-key="{{key}}" data-type="race" value="{{race._id}}" id="{{race._id}}" {{checked race.chosen}} /></div>
                                        <div class="item-prop">{{race.name}}</div>
                                        <div class="item-prop">{{race.data.startHP}}</div>
                                    </li>
                                {{/each}}
                            </div>
                            <aside class="item-prop">race description</aside>
                        </div>
                    </li>
                </ol>
            </div>
        </div>
        <div class='tab' data-tab='skills' data-group='primary-tabs'>
            <ol class="flexcol items-list">
                <li class="items-header flexrow">
                    <div>Name</div>
                    <div>Decrease rank</div>
                    <div>Rank</div>
                    <div>Increase rank</div>
                    <div>XP cost</div>
                    <div class="stretch" style="--count:5">Description</div>
                </li>
                <li>
                    <div class="grid grid-2col">
                        <div>
                            {{#each skills as |skill key|}}
                                <li class="item flexrow align-center">
                                    <div class="item-prop"><label for='skills.{{key}}.prof' class="resource-label skill flexlarge align-left" data-type='skill' data-label="{{skill.label}}">{{skill.label}}</label></div>
                                    <div class="item-prop"><button class='change far fa-arrow-alt-circle-down' data-type="skill" type="button" {{#if skill.isEq}}disabled{{/if}} data-action='minus' data-key="{{key}}"></button></div>
                                    <input hidden name='skills.{{key}}.prof' value={{skill.prof}} type="number" />
                                    <div class="item-prop"><label for='skills.{{key}}.prof' class="resource-label flexlarge align-left" data-label="{{skill.hover}}">{{skill.hover}}</label></div>
                                    <div class="item-prop"><button class='change far fa-arrow-alt-circle-up' data-type="skill" type="button" {{#if skill.isXP}}disabled{{/if}} data-action='plus' data-key="{{key}}"></button></div>
                                    <div class="item-prop">{{#if skill.xp}}<span class='ability' name='skills.{{key}}.xp'>{{numberFormat skill.xp decimals=0 sign=false}}</span>{{/if}}</div>
                            {{/each}}
                        </div>
                        <aside class='item-prop'>{{{hover.value}}}</aside>
                    </div>
                </li>
            </ol>
        </div>
        <div class='tab' data-tab='profs' data-group='primary-tabs'>
            <div>
                <div class="ability flexcoll-group-center align-center">
                    {{#each profs.weapon as |prof key|}}
                        <div class="ability flexrow grid grid-7col">
                            <label for='profs.weapon.{{key}}.value' class="resource-label prof flexlarge align-center" data-type='prof' data-label="{{prof.name}}">{{prof.name}}</label>
                            <label for='profs.weapon.{{key}}.value' class="resource-label prof flexlarge align-center" data-type='prof' data-label="{{prof.type}}">{{prof.type_hover}}</label>
                            <button class='change far fa-arrow-alt-circle-down' data-type="prof" type="button" {{#if prof.isEq}}disabled{{/if}} data-action='minus' data-key="{{key}}"></button>
                            <input hidden name='profs.weapon.{{key}}.value' value={{prof.value}} type="number" />
                            <label for='profs.weapon.{{key}}.value' class="resource-label flexlarge align-center" data-label="{{prof.hover}}">{{prof.value_hover}}</label>
                            <button class='change far fa-arrow-alt-circle-up' data-type="prof" type="button" {{#if prof.isXP}}disabled{{/if}} data-action='plus' data-key="{{key}}"></button>
                            {{#if prof.xp}}<span class='ability' name='profs.weapon.{{key}}.xp'>{{numberFormat prof.xp decimals=0 sign=false}}</span>{{/if}}
                        </div>
                    {{/each}}
                </div>
            </div>
        </div>
        <div class='tab' data-tab='feats' data-group='primary-tabs'>
            <ol class="items-list">
                <li class=" item items-header flexrow">
                    <div class='item-name'>Name</div>
                    <div class="item-prop">Source</div>
                    <div class="item-prop">Decrease level</div>
                    <div class="item-prop">Current Level</div>
                    <div class="item-prop">Maximum Level</div>
                    <div class="item-prop">Increase level</div>
                    <div class="item-prop">XP cost</div>
                    <div class="stretch item-prop" style="--count:7">Description</div>
                </li>
                    <div class='grid grid-2col'>
                        <div>
                          {{#each feats.awail as |feat key|}}
                              <li class="item flexrow">
                                <div class="item-name"><label class="resource-label feat flexlarge align-center" data-type='feat' data-label="{{feat.data.name}}">{{feat.name}}</label></div>
                                <div class="item-prop"><label class="resource-label feat flexlarge align-center" data-type='feat' data-label="{{feat.data.source.label}}">{{feat.data.source.label}}</label></div>
                                <div class="item-prop"><button class='change fas fa-minus-square' data-type="feat" type="button" {{#if feat.isEq}}disabled{{/if}} data-action='minus' data-key="{{key}}"></button></div>
                                <input hidden name='feats.awail.{{key}}.id' value='{{feat.id}}' type="text" />
                                <div class="item-prop"><input readonly type="number" value="{{feat.data.level.initial}}" name='feats.awail.{{key}}.data.level.initial' /></div>
                                <div class="item-prop"><input readonly type="number" value="{{feat.data.level.max}}" name="feats.awail.{{key}}.data.level.max"></div>
                                <div class="item-prop"><button class='change fas fa-plus-square' data-type="feat" type="button" {{#if feat.isXP}}disabled{{/if}} data-action='plus' data-key="{{key}}"></button></div>
                                <div class="item-prop">{{#if (lt feat.data.level.initial feat.data.level.max)}}<span class='ability' name='feats.{{key}}.data.level.xp'>{{numberFormat feat.data.level.xp decimals=0 sign=false}}</span>{{/if}}</div>
                            </li>
                        {{/each}}
                        </div>
                        <div>blank for feature description</div>
                    </div>
            </ol>
        </div>
    </section>
    <hr>
    <footer>
        <button type="submit" name="submit" value="1">
            <i class="far fa-save"></i> Submit
        </button>
    </footer>
</form>
